<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Arch package guidelines (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Arch_package_guidelines_Русский rootpage-Arch_package_guidelines_Русский skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Прототип_PKGBUILD" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D1%82%D0%B8%D0%BF_PKGBUILD">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Прототип PKGBUILD</div>
			</a>
			
			<ul id="toc-Прототип_PKGBUILD-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Этикет_оформления_пакетов" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%AD%D1%82%D0%B8%D0%BA%D0%B5%D1%82_%D0%BE%D1%84%D0%BE%D1%80%D0%BC%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Этикет оформления пакетов</div>
			</a>
			
			<ul id="toc-Этикет_оформления_пакетов-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Именование_пакета" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%98%D0%BC%D0%B5%D0%BD%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Именование пакета</div>
			</a>
			
			<ul id="toc-Именование_пакета-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Версионирование_пакетов" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%92%D0%B5%D1%80%D1%81%D0%B8%D0%BE%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Версионирование пакетов</div>
			</a>
			
			<ul id="toc-Версионирование_пакетов-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Зависимости_пакетов" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%97%D0%B0%D0%B2%D0%B8%D1%81%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D0%B8_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>Зависимости пакетов</div>
			</a>
			
			<ul id="toc-Зависимости_пакетов-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Связи_между_пакетами" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%A1%D0%B2%D1%8F%D0%B7%D0%B8_%D0%BC%D0%B5%D0%B6%D0%B4%D1%83_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%D0%BC%D0%B8">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6</span>Связи между пакетами</div>
			</a>
			
			<ul id="toc-Связи_между_пакетами-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Исходники_пакетов" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%98%D1%81%D1%85%D0%BE%D0%B4%D0%BD%D0%B8%D0%BA%D0%B8_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">7</span>Исходники пакетов</div>
			</a>
			
			<ul id="toc-Исходники_пакетов-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Работа_с_upstream" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0_%D1%81_upstream">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">8</span>Работа с upstream</div>
			</a>
			
			<ul id="toc-Работа_с_upstream-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Каталоги" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%9A%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%D0%B8">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">9</span>Каталоги</div>
			</a>
			
			<ul id="toc-Каталоги-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Функции_makepkg" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8_makepkg">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">10</span>Функции makepkg</div>
			</a>
			
			<ul id="toc-Функции_makepkg-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Архитектуры" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%90%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D1%8B">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">11</span>Архитектуры</div>
			</a>
			
			<ul id="toc-Архитектуры-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Лицензии" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%9B%D0%B8%D1%86%D0%B5%D0%BD%D0%B7%D0%B8%D0%B8">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">12</span>Лицензии</div>
			</a>
			
			<ul id="toc-Лицензии-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Воспроизводимые_сборки" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%92%D0%BE%D1%81%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D0%B8%D0%BC%D1%8B%D0%B5_%D1%81%D0%B1%D0%BE%D1%80%D0%BA%D0%B8">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">13</span>Воспроизводимые сборки</div>
			</a>
			
			<ul id="toc-Воспроизводимые_сборки-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Дополнительные_рекомендации" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%94%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D1%80%D0%B5%D0%BA%D0%BE%D0%BC%D0%B5%D0%BD%D0%B4%D0%B0%D1%86%D0%B8%D0%B8">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">14</span>Дополнительные рекомендации</div>
			</a>
			
			<ul id="toc-Дополнительные_рекомендации-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../ru/Arch_package_guidelines.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Arch_package_guidelines_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">русский</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../ru/Arch_package_guidelines.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Arch_package_guidelines_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Arch_package_guidelines_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../ru/Arch_package_guidelines.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Arch_package_guidelines_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Arch_package_guidelines_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="ru" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/Arch_package_guidelines.html" title="Arch package guidelines">Arch package guidelines</a>. Дата последней синхронизации: 26 августа 2023. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Arch_package_guidelines&amp;diff=0&amp;oldid=785197">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Ссылки по теме</p>
<ul>
<li><a href="../ru/Creating_packages.html" class="mw-redirect" title="Создание пакетов">Создание пакетов</a></li>
<li><a href="../ru/PKGBUILD.html" title="PKGBUILD (Русский)">PKGBUILD (Русский)</a></li>
<li><a href="../ru/Makepkg.html" title="Makepkg (Русский)">makepkg (Русский)</a></li>
<li><a href="../ru/Arch_build_system.html" class="mw-redirect" title="Система сборки Arch">Система сборки Arch</a></li>
<li><a href="../ru/Arch_User_Repository.html" class="mw-redirect" title="Пользовательский репозиторий Arch">Пользовательский репозиторий Arch</a></li>
<li><a href="../en/Arch_package_guidelines/Security.html" title="Arch package guidelines/Security">Arch package guidelines/Security</a></li>
</ul>
</div>
<p>При создании пакетов для Arch Linux <b>придерживайтесь рекомендаций по созданию пакетов</b>, приведённых ниже, особенно если вы собираетесь <b>отправить</b> новый пакет в Arch Linux. Вам также следует ознакомиться с руководствами <span class="plainlinks archwiki-template-man" title="$ man 5 PKGBUILD"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/PKGBUILD.5">PKGBUILD(5)</a></span> и <span class="plainlinks archwiki-template-man" title="$ man 8 makepkg"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/makepkg.8">makepkg(8)</a></span>.
</p>
<mw:tocplace></mw:tocplace>
<h2>
<span id=".D0.9F.D1.80.D0.BE.D1.82.D0.BE.D1.82.D0.B8.D0.BF_PKGBUILD"></span><span class="mw-headline" id="Прототип_PKGBUILD">Прототип PKGBUILD</span>
</h2>
<pre># Maintainer: Ваше Имя &lt;вашапочта@domain.com&gt;
pkgname=НАЗВАНИЕ
pkgver=ВЕРСИЯ
pkgrel=1
pkgdesc=""
arch=()
url=""
license=('GPL')
groups=()
depends=()
makedepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=($pkgname-$pkgver.tar.gz)
noextract=()
md5sums=() #заполняется автоматически через updpkgsums

build() {
  cd "$pkgname-$pkgver"

  ./configure --prefix=/usr
  make
}

package() {
  cd "$pkgname-$pkgver"

  make DESTDIR="$pkgdir/" install
}</pre>
<p>Другие прототипы можно найти в <code>/usr/share/pacman/</code> из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman">pacman</a></span>.
</p>
<h2>
<span id=".D0.AD.D1.82.D0.B8.D0.BA.D0.B5.D1.82_.D0.BE.D1.84.D0.BE.D1.80.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Этикет_оформления_пакетов">Этикет оформления пакетов</span>
</h2>
<ul>
<li>Пакеты <b>никогда</b> не должны устанавливаться в <code>/usr/local/</code>.</li>
<li>
<b>Не вводите новые переменные или функции</b> в скрипты сборки <code>PKGBUILD</code>, если возможно собрать пакет без них, так как они могут <b>конфликтовать</b> с переменными и функциями, используемыми в само́м makepkg.</li>
<li>Если абсолютно необходима новая переменная или новая функция, <b>добавьте перед её именем подчёркивание</b> (<code>_</code>), например, <pre>_customvariable=</pre>
</li>
<li>
<b>Избегайте</b> использования <code>/usr/libexec/</code> для чего-либо. Вместо этого используйте <code>/usr/lib/$pkgname/</code>.</li>
<li>Поле <code>packager</code> из мета-файла пакета может быть <b>настроено</b> создателем пакета путём изменения соответствующей опции в файле <code>/etc/makepkg.conf</code> или переопределено в файле <code>~/.makepkg.conf</code>.</li>
<li>
<b>Не используйте подпрограммы makepkg</b> (например, <code>error</code>, <code>msg</code>, <code>msg2</code>, <code>plain</code>, <code>warning</code>), так как они могут измениться в любой момент. Для печати данных используйте <code>printf</code> или <code>echo</code>.</li>
<li>Все важные сообщения должны выводиться во время установки с помощью <b>файла .install</b>. Например, если пакет требует дополнительной настройки для работы, следует включить указания.</li>
<li>
<b>Зависимости</b> — самая распространённая ошибка при создании пакета. Пожалуйста, уделите время их тщательной проверке, например, запустив <code>ldd</code> на динамических исполняемых файлах, проверив инструменты, требуемые скриптами, или посмотрев документацию к программе. В этом вам может помочь утилита <a href="../en/Namcap.html" title="Namcap">namcap</a>. Она может анализировать как PKGBUILD, так и готовый пакет и предупредит вас о неправильных разрешениях, отсутствующих или лишних зависимостях и других распространённых ошибках.</li>
<li>Любые <b>необязательные зависимости</b>, которые не нужны для запуска пакета или его общего функционирования, не должны включаться в массив <b>depends</b>; вместо этого информация должна быть добавлена в массив <b>optdepends</b>:</li>
</ul>
<dl>
<dd><pre>optdepends=('cups: printing support'
            'sane: scanners support'
            'libgphoto2: digital cameras support'
            'alsa-lib: sound support'
            'giflib: GIF images support'
            'libjpeg: JPEG images support'
            'libpng: PNG images support')
</pre></dd>
<dd>Приведённый выше пример взят из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wine">wine</a></span>. Информация optdepends автоматически выводится при установке/обновлении, поэтому <b>не следует</b> хранить такую информацию в файлах <code>.install</code>.</dd>
</dl>
<ul>
<li>При создании <b>описания пакета</b> не пишите в нём само имя пакета. Например, «Nedit — текстовый редактор для X11» можно упростить до «Текстовый редактор для X11». Также старайтесь, чтобы описания не превышали ~80 символов.</li>
<li>Старайтесь, чтобы <b>длина строки</b> в PKGBUILD не превышала ~100 символов.</li>
<li>По возможности <b>удаляйте пустые строки</b> из <code>PKGBUILD</code> (<code>provides</code>, <code>replaces</code> и т.д.).</li>
<li>Общепринятой практикой является <b>сохранение порядка полей</b> <code>PKGBUILD</code>, как показано выше. Однако это не является обязательным, поскольку единственным требованием в данном контексте является <b>правильный синтаксис bash</b>.</li>
<li>
<b>Оборачивайте в кавычки</b> переменные, которые могут содержать пробелы, такие как <code>"$pkgdir"</code> и <code>"$srcdir"</code>.</li>
<li>Для обеспечения <b>целостности</b> пакетов убедитесь, что <a href="../ru/PKGBUILD.html#%D0%A6%D0%B5%D0%BB%D0%BE%D1%81%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C" title="PKGBUILD (Русский)">переменные целостности</a> содержат правильные значения. Их можно обновить с помощью инструмента <span class="plainlinks archwiki-template-man" title="$ man 8 updpkgsums"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/updpkgsums.8">updpkgsums(8)</a></span>.</li>
</ul>
<h2>
<span id=".D0.98.D0.BC.D0.B5.D0.BD.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0"></span><span class="mw-headline" id="Именование_пакета">Именование пакета</span>
</h2>
<ul>
<li>Имена пакетов могут содержать только буквы, цифры и символы <code>@</code>, <code>.</code>, <code>_</code>, <code>+</code>, <code>-</code>. Имена не должны начинаться с дефисов или точек. Все буквы должны быть строчными.</li>
<li>Имена пакетов <b>не</b> должны иметь суффикс с мажорным номером версии (например, нам не нужен libfoo2, если upstream называет его libfoo v2.3.4) в случае, если ожидается, что библиотека и её зависимости будут использовать последнюю версию библиотеки с каждым соответствующим релизом upstream. Однако для некоторых программ или зависимостей этого ожидать нельзя. В прошлом это было особенно верно для наборов инструментов виджетов, таких как GTK и Qt. Программы, зависящие от них, обычно не могут быть тривиально портированы на новую мажорную версию. В таких случаях имена пакетов должны содержать суффикс основной версии (например, gtk2, gtk3, qt4, qt5). Для случаев, когда большинство зависимостей могут обновиться на новую версию, а некоторые не могут (например, программа без исходного кода, требующая libpng12 или что-то подобное), устаревшая версия пакета может называться libfoo1, в то время как текущая версия — просто libfoo.</li>
</ul>
<h2>
<span id=".D0.92.D0.B5.D1.80.D1.81.D0.B8.D0.BE.D0.BD.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Версионирование_пакетов">Версионирование пакетов</span>
</h2>
<ul>
<li>Версии пакетов (то есть <a href="../ru/PKGBUILD.html#pkgver" title="PKGBUILD (Русский)">PKGBUILD#pkgver</a>) <b>должны совпадать с версией, выпущенной автором</b>. Версии могут включать буквы, если это необходимо (например, версия nmap — <code>2.54BETA32</code>). <b>Теги версий не должны включать дефисы!</b>. Только буквы, цифры и точки.</li>
<li>Номера релизов (то есть <a href="../ru/PKGBUILD.html#pkgrel" title="PKGBUILD (Русский)">PKGBUILD#pkgrel</a>) являются <b>специфичными для пакетов Arch Linux</b>. Они позволяют пользователям различать более новые и более старые сборки пакетов. Когда новая версия пакета выпускается впервые, <b>счётчик релизов начинается с 1</b>. Затем, по мере внесения исправлений и оптимизаций, пакет будет <b>перевыпущен</b> для публики Arch Linux, и <b>номер релиза будет увеличиваться</b>. Когда выходит новая версия программы — счётчик релизов пакета обнуляется до 1. Теги номеров релизов пакетов следуют <b>тем же ограничениям именования, что и теги версий</b>.</li>
</ul>
<h2>
<span id=".D0.97.D0.B0.D0.B2.D0.B8.D1.81.D0.B8.D0.BC.D0.BE.D1.81.D1.82.D0.B8_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Зависимости_пакетов">Зависимости пакетов</span>
</h2>
<ul>
<li>
<b>Не полагайтесь на <a href="https://en.wikipedia.org/wiki/Transitive_dependency" class="extiw" title="wikipedia:Transitive dependency">транзитивные зависимости</a></b>, так как они могут сломаться, если одна из зависимостей будет обновлена.</li>
<li>Перечислите все зависимости от библиотек. Чтобы определить их, можно использовать <span class="plainlinks archwiki-template-man" title="$ man 1 find-libdeps"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/find-libdeps.1">find-libdeps(1)</a></span> (часть <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=devtools">devtools</a></span>).</li>
</ul>
<h2>
<span id=".D0.A1.D0.B2.D1.8F.D0.B7.D0.B8_.D0.BC.D0.B5.D0.B6.D0.B4.D1.83_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0.D0.BC.D0.B8"></span><span class="mw-headline" id="Связи_между_пакетами">Связи между пакетами</span>
</h2>
<ul>
<li>Не добавляйте <code>$pkgname</code> в <a href="../ru/PKGBUILD.html#provides" title="PKGBUILD (Русский)">PKGBUILD#provides</a>, так как он всегда неявно предоставляется пакетом.</li>
<li>Перечислите все библиотеки, содержащиеся в пакете, в <a href="../ru/PKGBUILD.html#provides" title="PKGBUILD (Русский)">PKGBUILD#provides</a> (например, <code>'libsomething.so'</code>). Для их идентификации можно использовать <span class="plainlinks archwiki-template-man" title="$ man 1 find-libprovides"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/find-libprovides.1">find-libprovides(1)</a></span> (часть <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=devtools">devtools</a></span>).</li>
</ul>
<h2>
<span id=".D0.98.D1.81.D1.85.D0.BE.D0.B4.D0.BD.D0.B8.D0.BA.D0.B8_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Исходники_пакетов">Исходники пакетов</span>
</h2>
<ul>
<li>По возможности следует использовать HTTPS источники (<code>https://</code> для архивов, <code>git+https://</code> для git).</li>
<li>Исходники должны быть проверены с помощью PGP-подписей везде, где это возможно (это может повлечь за собой сборку из git-тегов вместо архива, если upstream подписывает коммиты и теги, но не архивы)</li>
<li>При сборке из git-тега вместо имени тега используйте хэш объекта, полученный командой <code>git rev-parse</code>:</li>
</ul>
<dl>
<dd><pre>_tag=1234567890123456789012345678901234567890 # git rev-parse "v$pkgver"
source=(git+https://$url.git?signed#tag=$_tag)

pkgver() {
    cd "$pkgname"
    git describe
}
</pre></dd>
<dd>Пример такого подхода можно найти в пакете <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gitea">gitea</a></span>. Причина такой практики в том, что теги могут быть изменены через force push, после чего они станут указывать на другой коммит, что повлияет на сборку пакета. Использование хэша обеспечивает целостность исходных текстов, так как force push тега изменяет его хэш. Использование функции <code>pkgver()</code> предотвращает случайное обновление <code>pkgver</code> без обновления <code>_tag</code>.</dd>
</dl>
<ul>
<li>
<b>Не снижайте безопасность или проверку целостности пакета</b> (например, удалением проверки контрольной суммы или проверки подписи PGP) из-за поломки апстрима или исчезновения функции (например, пропавшая в новом релизе подпись PGP).</li>
<li>Исходники должны быть уникальными в <code>srcdir</code> (это может потребовать переименования их при загрузке, например, <code>"${pkgname}-${pkgver}.tar.gz::https://${pkgname}.tld/download/${pkgver}.tar.gz"</code>)</li>
<li>Избегайте использования определённых зеркал (например, на sourceforge) для загрузки, так как они могут стать недоступными.</li>
</ul>
<h2>
<span id=".D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_.D1.81_upstream"></span><span class="mw-headline" id="Работа_с_upstream">Работа с upstream</span>
</h2>
<p>Считается лучшей практикой тесно сотрудничать с upstream, когда это возможно. Это подразумевает сообщение о проблемах, связанных со сборкой и тестированием пакета.
</p>
<ul>
<li>Сразу же сообщайте о проблемах в upstream.</li>
<li>По возможности добавляйте исправления.</li>
<li>Добавляйте комментарии со ссылками на соответствующие баг-трекеры апстрима в <a href="../ru/PKGBUILD.html" title="PKGBUILD (Русский)">PKGBUILD</a> (это особенно важно, так как позволяет другим людям, работающим с пакетом, понять смысл внесённых вами изменений).</li>
</ul>
<p>Рекомендуется отслеживать upstream с помощью инструментов вроде <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvchecker">nvchecker</a></span> или <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=urlwatch">urlwatch</a></span>, чтобы узнавать о выходе новых версий.
</p>
<h2>
<span id=".D0.9A.D0.B0.D1.82.D0.B0.D0.BB.D0.BE.D0.B3.D0.B8"></span><span class="mw-headline" id="Каталоги">Каталоги</span>
</h2>
<ul>
<li>
<b>Файлы конфигурации</b> должны размещаться в каталоге <code>/etc</code>. Если существует более одного файла конфигурации, обычно принято <b>использовать подкаталог</b>, чтобы сохранить <code>/etc</code> как можно более чистым. Используйте <code>/etc/<i>pkg</i></code>, где <code><i>pkg</i></code> — имя пакета (или подходящая альтернатива, например, apache использует <code>/etc/httpd/</code>).</li>
<li>Файлы пакетов должны следовать этим <b>общим рекомендациям по каталогам</b>:</li>
</ul>
<dl><dd><table class="wikitable">

<tbody>
<tr>
<td>
<code>/etc</code>
</td>
<td>
<b>Системно-значимые</b> файлы конфигурации
</td>
</tr>
<tr>
<td>
<code>/usr/bin</code>
</td>
<td>Бинарные файлы
</td>
</tr>
<tr>
<td>
<code>/usr/lib</code>
</td>
<td>Библиотеки
</td>
</tr>
<tr>
<td>
<code>/usr/include</code>
</td>
<td>Файлы заголовков
</td>
</tr>
<tr>
<td>
<code>/usr/lib/<i>pkg</i></code>
</td>
<td>Модули, плагины и тд.
</td>
</tr>
<tr>
<td>
<code>/usr/share/doc/<i>pkg</i></code>
</td>
<td>Документация приложений
</td>
</tr>
<tr>
<td>
<code>/usr/share/info</code>
</td>
<td>Системные файлы GNU Info
</td>
</tr>
<tr>
<td>
<code>/usr/share/licenses/<i>pkg</i></code>
</td>
<td>Лицензии приложений
</td>
</tr>
<tr>
<td>
<code>/usr/share/man</code>
</td>
<td>Страницы man
</td>
</tr>
<tr>
<td>
<code>/usr/share/<i>pkg</i></code>
</td>
<td>Данные приложений
</td>
</tr>
<tr>
<td>
<code>/var/lib/<i>pkg</i></code>
</td>
<td>Постоянное хранилище приложений
</td>
</tr>
<tr>
<td>
<code>/etc/<i>pkg</i></code>
</td>
<td>Файлы конфигураций для <i>pkg</i>
</td>
</tr>
<tr>
<td>
<code>/opt/<i>pkg</i></code>
</td>
<td>Крупные автономные пакеты
</td>
</tr>
</tbody>
</table></dd></dl>
<ul><li>Пакеты не должны содержать ни одного из следующих каталогов:
<ul>
<li><code>/bin</code></li>
<li><code>/sbin</code></li>
<li><code>/dev</code></li>
<li><code>/home</code></li>
<li><code>/srv</code></li>
<li><code>/media</code></li>
<li><code>/mnt</code></li>
<li><code>/proc</code></li>
<li><code>/root</code></li>
<li><code>/selinux</code></li>
<li><code>/sys</code></li>
<li><code>/tmp</code></li>
<li><code>/var/tmp</code></li>
<li><code>/run</code></li>
</ul>
</li></ul>
<h2>
<span id=".D0.A4.D1.83.D0.BD.D0.BA.D1.86.D0.B8.D0.B8_makepkg"></span><span class="mw-headline" id="Функции_makepkg">Функции makepkg</span>
</h2>
<p>При использовании <a href="../ru/Makepkg.html" title="Makepkg (Русский)">makepkg</a> для сборки пакета он автоматически делает следующее:
</p>
<ol>
<li>Проверяет, установлены ли пакеты из <b>dependencies</b> и <b>makedepends</b>.</li>
<li>
<b>Загружает исходные файлы</b> с серверов</li>
<li>
<b>Проверяет целостность</b> исходных файлов</li>
<li>
<b>Распаковывает</b> исходные файлы</li>
<li>Применяет все необходимые <b>патчи</b>
</li>
<li>
<b>Собирает</b> программное обеспечение и устанавливает его в fake root</li>
<li>
<b>Удаляет</b> символы из двоичных файлов</li>
<li>
<b>Удаляет</b> отладочные символы из библиотек</li>
<li>
<b>Сжимает</b> руководства и/или страницы info.</li>
<li>Генерирует <b>мета-файл пакета</b>, включаемый в каждый пакет.</li>
<li>
<b>Сжимает</b> fake root в файл пакета</li>
<li>
<b>Сохраняет</b> файл пакета в настроенном каталоге назначения (по умолчанию в текущем рабочем каталоге)</li>
</ol>
<h2>
<span id=".D0.90.D1.80.D1.85.D0.B8.D1.82.D0.B5.D0.BA.D1.82.D1.83.D1.80.D1.8B"></span><span class="mw-headline" id="Архитектуры">Архитектуры</span>
</h2>
<p>Массив <code>arch</code> должен содержать <code>'x86_64'</code>, если скомпилированный пакет зависит от архитектуры. В противном случае используйте <code>'any'</code> для независимых от архитектуры пакетов.
</p>
<h2>
<span id=".D0.9B.D0.B8.D1.86.D0.B5.D0.BD.D0.B7.D0.B8.D0.B8"></span><span class="mw-headline" id="Лицензии">Лицензии</span>
</h2>
<p>Смотри <a href="../ru/PKGBUILD.html#license" title="PKGBUILD (Русский)">PKGBUILD (Русский)#license</a>.
</p>
<h2>
<span id=".D0.92.D0.BE.D1.81.D0.BF.D1.80.D0.BE.D0.B8.D0.B7.D0.B2.D0.BE.D0.B4.D0.B8.D0.BC.D1.8B.D0.B5_.D1.81.D0.B1.D0.BE.D1.80.D0.BA.D0.B8"></span><span class="mw-headline" id="Воспроизводимые_сборки">Воспроизводимые сборки</span>
</h2>
<p>Arch работает над тем, чтобы сделать все пакеты <a href="../en/Reproducible_builds.html" title="Reproducible builds">воспроизводимыми</a>. Создатель пакета может проверить, является ли пакет воспроизводимым, с помощью <code>makerepropkg</code> из <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=devtools">devtools</a></span> или <code>repro</code> из <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=archlinux-repro">archlinux-repro</a></span>.
</p>
<pre>$ makerepropkg $pkgname-1-1-any.pkg.tar.zst
</pre>
<p>или
</p>
<pre>$ repro -f $pkgname-1-1-any.pkg.tar.zst
</pre>
<p>Если во время сборки требуется временная метка, используйте переменную окружения <code>SOURCE_DATE_EPOCH</code>. Формат описан в <a rel="nofollow" class="external text" href="https://reproducible-builds.org/docs/source-date-epoch/">документации</a>.
</p>
<h2>
<span id=".D0.94.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5_.D1.80.D0.B5.D0.BA.D0.BE.D0.BC.D0.B5.D0.BD.D0.B4.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Дополнительные_рекомендации">Дополнительные рекомендации</span>
</h2>
<p>Сперва обязательно прочитайте приведённые выше рекомендации — там перечислены важные моменты, которые не будут повторяться на приведённых ниже страницах с рекомендациями. Эти конкретные рекомендации предназначены в качестве дополнения к стандартам, перечисленным на этой странице.
</p>
<div class="toc" style="display:block; text-align: center; margin-bottom: 1em;">
<b><a href="../ru/Creating_packages.html" title="Creating packages (Русский)">Указания по созданию пакетов</a></b>
<hr>
<p><a href="../en/CLR_package_guidelines.html" title="CLR package guidelines">CLR</a> – <a href="../en/Cross-compiling_tools_package_guidelines.html" title="Cross-compiling tools package guidelines">Cross</a> – <a href="../en/Eclipse_plugin_package_guidelines.html" title="Eclipse plugin package guidelines">Eclipse</a> – <a href="../en/Free_Pascal_package_guidelines.html" title="Free Pascal package guidelines">Free Pascal</a> – <a href="../en/GNOME_package_guidelines.html" title="GNOME package guidelines">GNOME</a> – <a href="../en/Go_package_guidelines.html" title="Go package guidelines">Go</a> – <a href="../en/Haskell_package_guidelines.html" title="Haskell package guidelines">Haskell</a> – <a href="../en/Java_package_guidelines.html" title="Java package guidelines">Java</a> – <a href="../en/KDE_package_guidelines.html" title="KDE package guidelines">KDE</a> – <a href="../en/Kernel_module_package_guidelines.html" title="Kernel module package guidelines">Kernel</a> – <a href="../en/Lisp_package_guidelines.html" title="Lisp package guidelines">Lisp</a> – <a href="../en/MinGW_package_guidelines.html" title="MinGW package guidelines">MinGW</a> – <a href="../en/Nonfree_applications_package_guidelines.html" title="Nonfree applications package guidelines">Nonfree</a> – <a href="../en/OCaml_package_guidelines.html" title="OCaml package guidelines">OCaml</a> – <a href="../en/Perl_package_guidelines.html" title="Perl package guidelines">Perl</a> – <a href="../en/PHP_package_guidelines.html" title="PHP package guidelines">PHP</a> – <a href="../en/Python_package_guidelines.html" title="Python package guidelines">Python</a> – <a href="../en/Ruby_package_guidelines.html" class="mw-redirect" title="Ruby Gem package guidelines">Ruby</a> – <a href="../en/VCS_package_guidelines.html" title="VCS package guidelines">VCS</a> – <a href="../en/Web_application_package_guidelines.html" title="Web application package guidelines">Web</a> – <a href="../en/Wine_package_guidelines.html" class="mw-redirect" title="Wine package guidelines (Русский)">Wine</a>
</p>
</div>
<p>Пакеты, представленные в AUR, должны дополнительно соответствовать <a href="../ru/AUR_submission_guidelines.html" title="AUR submission guidelines (Русский)">правилам публикации пакетов в AUR</a>.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../ru/Category:Arch_package_guidelines.html" title="Category:Arch package guidelines (Русский)">Arch package guidelines (Русский)</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Arch_package_guidelines_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=786247">https://wiki.archlinux.org/index.php?title=Arch_package_guidelines_(Русский)&amp;oldid=786247</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 26 August 2023, at 19:25.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
