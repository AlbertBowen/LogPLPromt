<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>SSHFS (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-SSHFS_Русский rootpage-SSHFS_Русский skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Установка" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Установка</div>
			</a>
			
				<button aria-controls="toc-Установка-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Установка subsection
				</button>
			
			<ul id="toc-Установка-sublist" class="sidebar-toc-list">
				<li id="toc-Монтирование" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%9C%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.1</span>Монтирование</div>
			</a>
			
			<ul id="toc-Монтирование-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Размонтирование" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%A0%D0%B0%D0%B7%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.2</span>Размонтирование</div>
			</a>
			
			<ul id="toc-Размонтирование-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Опции" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%9E%D0%BF%D1%86%D0%B8%D0%B8">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Опции</div>
			</a>
			
			<ul id="toc-Опции-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Изменение_корневого_каталога" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE_%D0%BA%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%D0%B0">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Изменение корневого каталога</div>
			</a>
			
			<ul id="toc-Изменение_корневого_каталога-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Автомонтирование" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Автомонтирование</div>
			</a>
			
				<button aria-controls="toc-Автомонтирование-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Автомонтирование subsection
				</button>
			
			<ul id="toc-Автомонтирование-sublist" class="sidebar-toc-list">
				<li id="toc-По_запросу" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%9F%D0%BE_%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D1%83">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.1</span>По запросу</div>
			</a>
			
			<ul id="toc-По_запросу-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-При_загрузке" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B5">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.2</span>При загрузке</div>
			</a>
			
			<ul id="toc-При_загрузке-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Безопасный_доступ_пользователей" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%91%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D1%8B%D0%B9_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3</span>Безопасный доступ пользователей</div>
			</a>
			
			<ul id="toc-Безопасный_доступ_пользователей-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Решение_проблем" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>Решение проблем</div>
			</a>
			
				<button aria-controls="toc-Решение_проблем-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Решение проблем subsection
				</button>
			
			<ul id="toc-Решение_проблем-sublist" class="sidebar-toc-list">
				<li id="toc-Контрольный_список" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%9A%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%81%D0%BF%D0%B8%D1%81%D0%BE%D0%BA">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.1</span>Контрольный список</div>
			</a>
			
			<ul id="toc-Контрольный_список-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Сброс_соединения_пиром" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%A1%D0%B1%D1%80%D0%BE%D1%81_%D1%81%D0%BE%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BF%D0%B8%D1%80%D0%BE%D0%BC">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.2</span>Сброс соединения пиром</div>
			</a>
			
			<ul id="toc-Сброс_соединения_пиром-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Удаленный_хост_отключен" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D1%85%D0%BE%D1%81%D1%82_%D0%BE%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.3</span>Удаленный хост отключен</div>
			</a>
			
			<ul id="toc-Удаленный_хост_отключен-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Проблемы_с_монтированием_fstab" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D1%81_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC_fstab">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.4</span>Проблемы с монтированием fstab</div>
			</a>
			
			<ul id="toc-Проблемы_с_монтированием_fstab-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Смотрите_также" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6</span>Смотрите также</div>
			</a>
			
			<ul id="toc-Смотрите_также-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../ru/SSHFS.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">русский</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../ru/SSHFS.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../ru/SSHFS.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="ru" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Ссылки по теме</p>
<ul>
<li><a href="../en/SCP_and_SFTP.html" title="SCP and SFTP">SCP and SFTP</a></li>
<li><a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a></li>
<li><a href="../en/Pure-FTPd.html" title="Pure-FTPd">Pure-FTPd</a></li>
<li><a href="../en/Sftpman.html" title="Sftpman">sftpman</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/SSHFS.html" title="SSHFS">SSHFS</a>. Дата последней синхронизации: 6 июня 2021. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=SSHFS&amp;diff=0&amp;oldid=669344">изменения</a>.</div>
<p><a rel="nofollow" class="external text" href="https://github.com/libfuse/sshfs">SSHFS</a> — клиент файловой системы на основе <a href="../en/FUSE.html" title="FUSE">FUSE</a> для монтирования удалённых каталогов через <a href="../ru/OpenSSH.html" title="OpenSSH (Русский)">SSH</a>-соединение.
</p>
<mw:tocplace></mw:tocplace>
<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sshfs">sshfs</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> 
<ul>
<li>Если часто приходится монтировать файловые системы sshfs, то вас могут заинтересовать помощники sshfs, такие как <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/qsshfs/">qsshfs</a></span><sup><small>AUR</small></sup>, <a href="../en/Sftpman.html" title="Sftpman">sftpman</a>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/sshmnt/">sshmnt</a></span><sup><small>AUR</small></sup> или <a rel="nofollow" class="external text" href="https://github.com/lahwaacz/Scripts/blob/master/fmount.py">fmount.py</a>.</li>
<li>Можно использовать <a href="../en/Google_Authenticator.html" title="Google Authenticator">Google Authenticator</a> c sshfs для дополнительной безопасности.</li>
<li>Также можно использовать <a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a> вместо традиционного ввода пароля.</li>
</ul>
</div>
<h3>
<span id=".D0.9C.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Монтирование">Монтирование</span>
</h3>
<p>Для того, чтобы примонтировать каталог, используя SSH, пользователь должен иметь доступ к нему. Монтирование удаленной директории:
</p>
<pre>$ sshfs <i>[user@]host:[dir] mountpoint [options]</i>
</pre>
<p>Например:
</p>
<pre>$ sshfs myuser@mycomputer:/remote/path /local/path -C -p 9876
</pre>
<p>Где <code>-p 9876</code> является номером порта, <code>-C</code> - использование сжатия. Для дополнительных опций смотрите раздел <a href="#%D0%9E%D0%BF%D1%86%D0%B8%D0%B8">#Опции</a>.
</p>
<p>Если не указан путь, то по умолчанию он указывает на удаленную домашнюю директорию пользователя. Имя пользователя по умолчанию и опции могут быть заданы в <code>~/.ssh/config</code>. Смотрите <a href="../ru/OpenSSH.html#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82" title="OpenSSH (Русский)">OpenSSH#Клиент</a>.
</p>
<p>SSH запросит пароль, если необходимо. Если вы не хотите постоянно вводить пароль, прочитайте <a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a>.
</p>
<h3>
<span id=".D0.A0.D0.B0.D0.B7.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Размонтирование">Размонтирование</span>
</h3>
<p>Чтобы размонтировать удаленную систему:
</p>
<pre>$ fusermount3 -u <i>mountpoint</i>
</pre>
<p>Например:
</p>
<pre>$ fusermount3 -u /local/path
</pre>
<h2>
<span id=".D0.9E.D0.BF.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Опции">Опции</span>
</h2>
<p><i>sshfs</i> может автоматически конвертировать ваш и удаленный идентификатор пользователя. Используйте параметр <code>idmap=user</code>, чтобы перевести UID подключаемого пользователя к удаленному пользователю <code>myuser</code> (GID остается нетронутым):
</p>
<pre>$ sshfs myuser@mycomputer:/remote/path /local/path -o idmap=user
</pre>
<p>Если вам требуется более точный контроль над переводом идентификаторов между локальным и удаленным пользователем, то обратите внимание на <code>idmap=file</code>, <code>uidfile</code> и <code>gidfile</code>.
</p>
<p>Полный список опций вы можете найти в <span class="plainlinks archwiki-template-man" title="$ man 1 sshfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshfs.1">sshfs(1)</a></span>.
</p>
<h2>
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D1.80.D0.BD.D0.B5.D0.B2.D0.BE.D0.B3.D0.BE_.D0.BA.D0.B0.D1.82.D0.B0.D0.BB.D0.BE.D0.B3.D0.B0"></span><span class="mw-headline" id="Изменение_корневого_каталога">Изменение корневого каталога</span>
</h2>
<p>Вы можете привязать определенного пользователя к конкретной директории на удаленной системе. Это может быть выполнено путем редактирования <code>/etc/ssh/sshd_config</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
Match User "someuser"
       ChrootDirectory "/chroot/%u"
       ForceCommand internal-sftp
       AllowTcpForwarding no
       X11Forwarding no
...
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Владельцем chroot директории <b>должен</b> быть суперпользователь, иначе вы не сможете подключиться.</div>
<p>Смотрите <a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a>. Также обратите внимание в <span class="plainlinks archwiki-template-man" title="$ man 5 sshd_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd_config.5">sshd_config(5)</a></span> на <code>Match</code>, <code>ChrootDirectory</code> и <code>ForceCommand</code>.
</p>
<h2>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Автомонтирование">Автомонтирование</span>
</h2>
<p>Автоматическое монтирование происходит при загрузке или по запросу (для получения доступа к каталогу). В любом случае настройка будет происходить в <a href="../ru/Fstab.html" title="Fstab (Русский)">fstab</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Запомните, что автоматическое монтирование выполняется с правами суперпользователя, поэтому вы не можете использовать <code>.ssh/config</code> обычного пользователя.
<p>Чтобы разрешить суперпользователю использовать ключ SSH обычного пользователя, нужно указать полный путь в опции <code>IdentityFile</code>.
</p>
<b>Самое главное</b> - используйте хотя бы раз каждую примонтированную файловую систему sshfs <b>в режиме суперпользователя</b>, таким образом подписи хоста будут добавлены в файл <code>/root/.ssh/known_hosts</code>.</div>
<h3>
<span id=".D0.9F.D0.BE_.D0.B7.D0.B0.D0.BF.D1.80.D0.BE.D1.81.D1.83"></span><span class="mw-headline" id="По_запросу">По запросу</span>
</h3>
<p>Посредством systemd можно монтировать по запросу, используя <code>/etc/fstab</code>.
</p>
<p>Например:
</p>
<pre>user@host:/remote/folder /mount/point  fuse.sshfs noauto,x-systemd.automount,_netdev,users,idmap=user,IdentityFile=/home/user/.ssh/id_rsa,allow_other,reconnect 0 0
</pre>
<p>Главные опции - <i>noauto,x-systemd.automount,_netdev</i>.
</p>
<ul>
<li>
<i>noauto</i> - монтирование не будет происходит при загрузке.</li>
<li>
<i>x-systemd.automount</i> - делает магию, связанную с запросом.</li>
<li>
<i>_netdev</i> - показывает, что это сетевое устройство, а не блочное (без этой опции может появится ошибка "No such device")</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> После редактирования <code>/etc/fstab</code>, (пере)запустите соответствующий сервис: <code>systemctl daemon-reload &amp;&amp; systemctl restart &lt;цель&gt;</code>;  можно найти <code>&lt;цель&gt;</code>, используя <code>systemctl list-unit-files --type automount</code>
</div>
<h3>
<span id=".D0.9F.D1.80.D0.B8_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B5"></span><span class="mw-headline" id="При_загрузке">При загрузке</span>
</h3>
<p>Пример того, как использовать sshfs для монтировании удаленной файловой системы при помощи <code>/etc/fstab</code>
</p>
<pre>USERNAME@HOSTNAME_OR_IP:/REMOTE/DIRECTORY  /LOCAL/MOUNTPOINT  fuse.sshfs  defaults,_netdev  0  0
</pre>
<p>Для примера возьмите линию из <i>fstab</i>
</p>
<pre>llib@192.168.1.200:/home/llib/FAH  /media/FAH2  fuse.sshfs  defaults,_netdev  0  0
</pre>
<p>Выше приведенная строка будет работать только в том случае, если вы используете SSH ключ. Смотрите <a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a>.
</p>
<p>Если вы не единственный пользователь, использующий sshfs:
</p>
<pre>user@domain.org:/home/user  /media/user   fuse.sshfs    defaults,allow_other,_netdev    0  0
</pre>
<p>Очень важно убедится в том, что параметр <i>_netdev</i> установлен, чтобы быть уверенным в доступности сети перед монтированием.
</p>
<h3>
<span id=".D0.91.D0.B5.D0.B7.D0.BE.D0.BF.D0.B0.D1.81.D0.BD.D1.8B.D0.B9_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D0.B5.D0.B9"></span><span class="mw-headline" id="Безопасный_доступ_пользователей">Безопасный доступ пользователей</span>
</h3>
<p>Когда используется автомонтирование через <a href="../ru/Fstab.html" title="Fstab (Русский)">fstab</a>, файловая система будет монтироваться от суперпользователя. По умолчанию, это приводит к нежелательным результатам, если вы хотите получать доступ как обычный пользователь и ограничить доступ другим пользователям.
</p>
<p>Пример конфигурации:
</p>
<pre>USERNAME@HOSTNAME_OR_IP:/REMOTE/DIRECTORY  /LOCAL/MOUNTPOINT  fuse.sshfs noauto,x-systemd.automount,_netdev,user,idmap=user,follow_symlinks,identityfile=/home/USERNAME/.ssh/id_rsa,allow_other,default_permissions,uid=USER_ID_N,gid=USER_GID_N 0
</pre>
<p>Описание опций:
</p>
<ul>
<li>
<i>allow_other</i> - позволяет другим пользователям, отличным от монтирующего (то есть обычным пользователям), получать доступ к тому, что монтируется.</li>
<li>
<i>default_permissions</i> - позволяет ядру проверять права, иначе говоря использовать актуальные права на удаленной файловой системе. А также запрещает доступ всем, кроме объявленных в <i>allow_other</i>.</li>
<li>
<i>uid</i>, <i>gid</i> - устанавливает владельца файлов в соответствии с переданными значениями; <i>uid</i> - это числовой идентификатор пользователя, <i>gid</i> - числовой идентификатор группы пользователя.</li>
</ul>
<h2>
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span><span class="mw-headline" id="Решение_проблем">Решение проблем</span>
</h2>
<h3>
<span id=".D0.9A.D0.BE.D0.BD.D1.82.D1.80.D0.BE.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D1.81.D0.BF.D0.B8.D1.81.D0.BE.D0.BA"></span><span class="mw-headline" id="Контрольный_список">Контрольный список</span>
</h3>
<p>Для начала, прочитайте следующую страницу вики <a href="../ru/OpenSSH.html#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0" title="OpenSSH (Русский)">OpenSSH#Проверка</a>. Пункты, которые следует проверить:
</p>
<p>1. Получает ли ваш логин SSH дополнительную информацию от сервера, например, файл <code>/etc/issue</code>? Это может запутать SSHFS. Вам следует временно отключить серверный файл <code>/etc/issue</code>:
</p>
<pre>$ mv /etc/issue /etc/issue.orig
</pre>
<p>2. Имейте в виду, что большинство статей по устранению неполадок, связанных с SSH, <b>не</b> связаны с Systemd. Часто определения в <code>/etc/fstab</code> ошибочно начинаются с <code><i>sshfs#</i>user@host:/mnt/server/folder ... fuse ...</code> вместо того, чтобы использовать следующий синтаксис <code>user@host:/mnt/server/folder ... fuse.<i>sshfs</i> ... <i>x-systemd</i>, ...</code>.
</p>
<p>3. Убедитесь в том, что владелец исходной папки и ее содержимого на сервере владеет соответствующий пользователь:
</p>
<pre>$ chown -R USER_S: /mnt/servers/folder
</pre>
<p>4. Серверный идентификатор пользователя может отличаться от соответствующего клиентского. Очевидно, что имена пользователей будут одинаковыми. Вам просто нужно позаботиться о клиентском идентификаторе. SSHFS будет преобразовывать идентификатор пользователя посредством следующего параметра:
</p>
<pre>uid=<i>USER_C_ID</i>,gid=<i>GROUP_C_ID</i>
</pre>
<p>5. Проверьте, чтобы клиент имел права на целевую точку монтирования (каталог). Данная директория должна иметь такой же идентификатор, как в настройках монтирования SSHFS.
</p>
<pre>$ chown -R USER_C: /mnt/client/folder
</pre>
<p>6. Проверьте, что точка монтирования (папка) пуста. По умолчанию, вы не можете монтировать каталоги SSHFS в непустые директории.
</p>
<h3>
<span id=".D0.A1.D0.B1.D1.80.D0.BE.D1.81_.D1.81.D0.BE.D0.B5.D0.B4.D0.B8.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D0.B8.D1.80.D0.BE.D0.BC"></span><span class="mw-headline" id="Сброс_соединения_пиром">Сброс соединения пиром</span>
</h3>
<ul>
<li>Если вы пытаетесь получить доступ к удаленной машине, используя имя хоста, то попробуйте использовать ее адрес или доменной имя, смотря, что исправит проблему. Убедитесь в том, что вы изменили <code>/etc/hosts</code> в соответствии со свойствами сервера.</li>
<li>Если вы используете нестандартные имена ключей и передаете их как <code>-i .ssh/my_key</code>, то это не будет работать. Вам следует использовать <code>-o IdentityFile=/home/user/.ssh/my_key</code> с указанием полного пути к ключу.</li>
<li>Если ваш файл <code>/root/.ssh/config</code> является символической ссылкой, то вы получите сообщение об ошибке. Смотрите <a rel="nofollow" class="external text" href="https://serverfault.com/questions/507748/bad-owner-or-permissions-on-root-ssh-config">эту тему</a>
</li>
<li>Добавление опции '<code>sshfs_debug</code>' (как в '<code>sshfs -o sshfs_debug user@server ...</code>') может помочь в решении проблемы.</li>
<li>Если это не помогло выявить ничего полезного, то вы можете также попробовать добавить опцию '<code>debug</code>'</li>
<li>Если вы пытаетесь использовать sshfs в роутере, работающем на DD-WRT или чем-то подобном, то решение проблемы <a rel="nofollow" class="external text" href="https://www.dd-wrt.com/wiki/index.php/SFTP_with_DD-WRT">здесь</a>. (обратите внимание, что опция osftp_server=/opt/libexec/sftp-server может быть использована в командах SSH вместо патча dropbear)</li>
<li>Если это случается только при загрузке, то возможно, что причиной является systemd, который пытается выполнить монтирование до того, как сеть станет доступна. Это можно исправить, включив 'wait-online'-службу для вашего сетевого соединения (например, systemd-networkd-wait-online.service).</li>
<li>Старая тема на форуме: <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=27613">sshfs: Connection reset by peer</a>.</li>
<li>Убедитесь, что ваш пользователь можешь зайти на сервер (особенно при использовании AllowUsers).</li>
<li>Убедитесь в том, что <code>Subsystem sftp /usr/lib/ssh/sftp-server</code> включен в <code>/etc/ssh/sshd_config</code>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Когда вы посылаете больше одного аргумента в sshfs, они должны разделяться запятыми. Например: '<code>sshfs -o sshfs_debug,IdentityFile=&lt;/path/to/key&gt; user@server ...</code>')</div>
<h3>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D1.85.D0.BE.D1.81.D1.82_.D0.BE.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD"></span><span class="mw-headline" id="Удаленный_хост_отключен">Удаленный хост отключен</span>
</h3>
<p>Если это сообщение появляется непосредственно после попытки использовать <i>sshfs</i>:
</p>
<ul>
<li>Сначала убедитесь, что на удаленном компьютере установлен <i>sftp</i>! Ничего не будет работать, пока пакет не будет установлен.</li>
<li>Затем попробуйте проверить корректность пути к <code>Subsystem sftp</code>, указанного в <code>/etc/ssh/sshd_config</code> на удаленной машине.</li>
</ul>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D1.81_.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5.D0.BC_fstab"></span><span class="mw-headline" id="Проблемы_с_монтированием_fstab">Проблемы с монтированием fstab</span>
</h3>
<p>Для получения подробной отладочной информации, добавьте следующее в параметры монтирования:
</p>
<pre>ssh_command=ssh\040-vv,sshfs_debug,debug
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> <code>\040</code> - пробел, используемый fstab для разделения полей.</div>
<p>Чтобы видеть отладочную информацию, запустив при этом <code>mount -av</code>, удалите следующее:
</p>
<pre>noauto,x-systemd.automount
</pre>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<ul><li>
<a rel="nofollow" class="external text" href="https://wiki.gilug.org/index.php/How_to_mount_SFTP_accesses">Как монтировать файловую систему SSH, находящуюся в chroot-среде</a>, с специальными владельцами и вопросами доступа.</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:FUSE.html" title="Category:FUSE (Русский)">FUSE (Русский)</a></li>
<li><a href="../ru/Category:Secure_Shell.html" title="Category:Secure Shell (Русский)">Secure Shell (Русский)</a></li>
<li><a href="../ru/Category:Network_sharing.html" title="Category:Network sharing (Русский)">Network sharing (Русский)</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=765469">https://wiki.archlinux.org/index.php?title=SSHFS_(Русский)&amp;oldid=765469</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 28 January 2023, at 01:55.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
