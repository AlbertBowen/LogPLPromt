<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Power management/Suspend and hibernate - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Power_management_Suspend_and_hibernate rootpage-Power_management skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Low_level_interfaces" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a class="sidebar-toc-link" href="#Low_level_interfaces">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Low level interfaces</div>
			</a>
			
				<button aria-controls="toc-Low_level_interfaces-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Low level interfaces subsection
				</button>
			
			<ul id="toc-Low_level_interfaces-sublist" class="sidebar-toc-list">
				<li id="toc-Kernel_(swsusp)" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Kernel_(swsusp)">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.1</span>Kernel (swsusp)</div>
			</a>
			
			<ul id="toc-Kernel_(swsusp)-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Userspace_(uswsusp)" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Userspace_(uswsusp)">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.2</span>Userspace (uswsusp)</div>
			</a>
			
			<ul id="toc-Userspace_(uswsusp)-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-High_level_interfaces" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a class="sidebar-toc-link" href="#High_level_interfaces">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>High level interfaces</div>
			</a>
			
				<button aria-controls="toc-High_level_interfaces-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle High level interfaces subsection
				</button>
			
			<ul id="toc-High_level_interfaces-sublist" class="sidebar-toc-list">
				<li id="toc-systemd" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#systemd">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>systemd</div>
			</a>
			
			<ul id="toc-systemd-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Changing_suspend_method" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a class="sidebar-toc-link" href="#Changing_suspend_method">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Changing suspend method</div>
			</a>
			
			<ul id="toc-Changing_suspend_method-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Hibernation" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a class="sidebar-toc-link" href="#Hibernation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Hibernation</div>
			</a>
			
				<button aria-controls="toc-Hibernation-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Hibernation subsection
				</button>
			
			<ul id="toc-Hibernation-sublist" class="sidebar-toc-list">
				<li id="toc-About_swap_partition/file_size" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#About_swap_partition/file_size">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.1</span>About swap partition/file size</div>
			</a>
			
			<ul id="toc-About_swap_partition/file_size-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Configure_the_initramfs" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Configure_the_initramfs">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.2</span>Configure the initramfs</div>
			</a>
			
			<ul id="toc-Configure_the_initramfs-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Required_kernel_parameters" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Required_kernel_parameters">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3</span>Required kernel parameters</div>
			</a>
			
			<ul id="toc-Required_kernel_parameters-sublist" class="sidebar-toc-list">
				<li id="toc-Hibernation_into_swap_file" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Hibernation_into_swap_file">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3.1</span>Hibernation into swap file</div>
			</a>
			
			<ul id="toc-Hibernation_into_swap_file-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Hibernation_into_a_thinly-provisioned_LVM_volume" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Hibernation_into_a_thinly-provisioned_LVM_volume">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3.2</span>Hibernation into a thinly-provisioned LVM volume</div>
			</a>
			
			<ul id="toc-Hibernation_into_a_thinly-provisioned_LVM_volume-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Intel_Rapid_Start_Technology_(IRST)" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a class="sidebar-toc-link" href="#Intel_Rapid_Start_Technology_(IRST)">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>Intel Rapid Start Technology (IRST)</div>
			</a>
			
			<ul id="toc-Intel_Rapid_Start_Technology_(IRST)-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Troubleshooting" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a class="sidebar-toc-link" href="#Troubleshooting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6</span>Troubleshooting</div>
			</a>
			
				<button aria-controls="toc-Troubleshooting-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Troubleshooting subsection
				</button>
			
			<ul id="toc-Troubleshooting-sublist" class="sidebar-toc-list">
				<li id="toc-ACPI_OS_NAME" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#ACPI_OS_NAME">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6.1</span>ACPI_OS_NAME</div>
			</a>
			
			<ul id="toc-ACPI_OS_NAME-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Suspend/hibernate_does_not_work,_or_does_not_work_consistently" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Suspend/hibernate_does_not_work,_or_does_not_work_consistently">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6.2</span>Suspend/hibernate does not work, or does not work consistently</div>
			</a>
			
			<ul id="toc-Suspend/hibernate_does_not_work,_or_does_not_work_consistently-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Wake-on-LAN" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Wake-on-LAN">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6.3</span>Wake-on-LAN</div>
			</a>
			
			<ul id="toc-Wake-on-LAN-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Instantaneous_wakeups_from_suspend" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Instantaneous_wakeups_from_suspend">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6.4</span>Instantaneous wakeups from suspend</div>
			</a>
			
			<ul id="toc-Instantaneous_wakeups_from_suspend-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-System_does_not_power_off_when_hibernating" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#System_does_not_power_off_when_hibernating">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6.5</span>System does not power off when hibernating</div>
			</a>
			
			<ul id="toc-System_does_not_power_off_when_hibernating-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Operating_system_not_found_(or_wrong_OS_booting)_when_booting_after_hibernation" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Operating_system_not_found_(or_wrong_OS_booting)_when_booting_after_hibernation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6.6</span>Operating system not found (or wrong OS booting) when booting after hibernation</div>
			</a>
			
			<ul id="toc-Operating_system_not_found_(or_wrong_OS_booting)_when_booting_after_hibernation-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../../en/Power_management/Suspend_and_hibernate.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="mw-list-item"><a href="../../en/Talk:Power_management/Suspend_and_hibernate.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../../en/Power_management/Suspend_and_hibernate.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Power_management/Suspend_and_hibernate&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Power_management/Suspend_and_hibernate&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../../en/Power_management/Suspend_and_hibernate.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Power_management/Suspend_and_hibernate&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Power_management/Suspend_and_hibernate&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><span class="subpages">&lt; <a href="../../en/Power_management.html" title="Power management">Power management</a></span></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Related articles</p>
<ul>
<li><a href="../../en/Uswsusp.html" title="Uswsusp">Uswsusp</a></li>
<li><a href="../../en/Systemd.html" title="Systemd">systemd</a></li>
<li><a href="../../en/Power_management.html" title="Power management">Power management</a></li>
<li><a href="../../en/Power_management/Wakeup_triggers.html" class="mw-redirect" title="Wakeup triggers">Wakeup triggers</a></li>
<li><a href="../../en/Swap.html" title="Swap">swap</a></li>
</ul>
</div>
<p>There are <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/pm/sleep-states.html">multiple methods</a> of suspending available, notably:
</p>
<dl>
<dt>Suspend to idle</dt>
<dd>Called <a rel="nofollow" class="external text" href="https://01.org/blogs/qwang59/2018/how-achieve-s0ix-states-linux">S0ix</a> by Intel, <a rel="nofollow" class="external text" href="https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/modern-standby">Modern Standby</a> (previously "Connected Standby") by Microsoft and <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/pm/sleep-states.html#suspend-to-idle">S2Idle</a> by the kernel. Designed to be used instead of the <b>S3</b> <a href="https://en.wikipedia.org/wiki/ACPI#Global_states" class="extiw" title="wikipedia:ACPI">sleeping state</a> for supported systems, by providing identical energy savings but a drastically reduced wake-up time. <div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> While this state is subject to battery drain issues on <a rel="nofollow" class="external text" href="https://www.dell.com/support/kbdoc/en-us/000143524/the-battery-drains-quicker-than-expected-on-a-dell-notebook-with-modern-standby-mode-enabled">Windows</a> or <a rel="nofollow" class="external text" href="https://support.apple.com/guide/mac-help/mh40773/mac">macOS</a> since they support waking devices in this state for network activity, the Linux software ecosystem does not currently make use of this feature and should be unaffected.</div>
</dd>
<dt>Suspend to RAM (aka suspend, aka sleep)</dt>
<dd>The <b>S3</b> sleeping state as defined by ACPI. Works by cutting off power to most parts of the machine aside from the RAM, which is required to restore the machine's state. Because of the large power savings, it is advisable for laptops to automatically enter this mode when the computer is running on batteries and the lid is closed (or the user is inactive for some time).</dd>
<dt>Suspend to disk (aka hibernate)</dt>
<dd>The <b>S4</b> sleeping state as defined by ACPI. Saves the machine's state into <a href="../../en/Swap.html" class="mw-redirect" title="Swap space">swap space</a> and completely powers off the machine. When the machine is powered on, the state is restored. Until then, there is <a href="https://en.wikipedia.org/wiki/Standby_power" class="extiw" title="wikipedia:Standby power">zero</a> power consumption.</dd>
<dt>Hybrid suspend (aka hybrid sleep)</dt>
<dd>A hybrid of suspending and hibernating, sometimes called <b>suspend to both</b>. Saves the machine's state into swap space, but does not power off the machine. Instead, it invokes the default suspend. Therefore, if the battery is not depleted, the system can resume instantly. If the battery is depleted, the system can be resumed from disk, which is much slower than resuming from RAM, but the machine's state has not been lost.</dd>
</dl>
<p>There are multiple low level interfaces (backends) providing basic functionality, and some high level interfaces providing tweaks to handle problematic hardware drivers/kernel modules (e.g. video card re-initialization).
</p>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Low_level_interfaces">Low level interfaces</span></h2>
<p>Though these interfaces can be used directly, it is advisable to use the <a href="#High_level_interfaces">high level interfaces</a> to suspend/hibernate. Using low level interfaces directly is significantly faster than using any high level interface, since running all the pre- and post-suspend hooks takes time, but hooks can properly set the hardware clock, restore wireless, etc.
</p>
<h3>
<span id="Kernel_.28swsusp.29"></span><span class="mw-headline" id="Kernel_(swsusp)">Kernel (swsusp)</span>
</h3>
<p>The most straightforward approach is to directly inform the in-kernel software suspend code (swsusp) to enter a suspended state; the exact method and state depends on the level of hardware support. On modern kernels, writing appropriate strings to <code>/sys/power/state</code> is the primary mechanism to trigger this suspend.
</p>
<p>See <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/pm/sleep-states.html#basic-sysfs-interfaces-for-system-suspend-and-hibernation">kernel documentation</a> for details.
</p>
<h3>
<span id="Userspace_.28uswsusp.29"></span><span class="mw-headline" id="Userspace_(uswsusp)">Userspace (uswsusp)</span>
</h3>
<p>The uswsusp ('Userspace Software Suspend') tools provide wrappers around the kernel's suspend-to-RAM mechanism, which perform some graphics adapter manipulations from userspace before suspending and after resuming. See main article <a href="../../en/Uswsusp.html" title="Uswsusp">Uswsusp</a>.
</p>
<h2><span class="mw-headline" id="High_level_interfaces">High level interfaces</span></h2>
<p>The goal of these packages is to provide binaries/scripts that can be invoked to perform suspend/hibernate. Actually hooking them up to power buttons or menu clicks or laptop lid events is usually left to other tools. To automatically suspend/hibernate on certain power events, such as laptop lid close or battery depletion percentage, you may want to look into running <a href="../../en/Acpid.html" title="Acpid">Acpid</a>.
</p>
<h3><span class="mw-headline" id="systemd">systemd</span></h3>
<p><a href="../../en/Systemd.html" title="Systemd">systemd</a> provides native commands for suspend, hibernate and a hybrid suspend; see <a href="../../en/Power_management.html#Power_management" title="Power management">Power management#Power management</a> for details. This is the default interface used in Arch Linux.
</p>
<p>See <a href="../../en/Power_management.html#Sleep_hooks" title="Power management">Power management#Sleep hooks</a> for additional information on configuring suspend/hibernate hooks. Also see <span class="plainlinks archwiki-template-man" title="$ man 1 systemctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemctl.1">systemctl(1)</a></span>, <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-sleep"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-sleep.8">systemd-sleep(8)</a></span>, and <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.special"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.special.7">systemd.special(7)</a></span>.
</p>
<h2><span class="mw-headline" id="Changing_suspend_method">Changing suspend method</span></h2>
<p>On systems where S0ix suspension does not provide the same energy savings as the regular S3 sleep, or when conserving energy is preferred to a quick resume time, changing the default suspend method is possible.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> S0ix is supposed to provide identical or better energy savings as S3 sleep. See Intel blog posts <a rel="nofollow" class="external text" href="https://web.archive.org/web/20230614200816/https://01.org/blogs/qwang59/2018/how-achieve-s0ix-states-linux">How to achieve S0ix states in Linux</a>, <a rel="nofollow" class="external text" href="https://web.archive.org/web/20230614200306/https://01.org/blogs/qwang59/2020/linux-s0ix-troubleshooting">Linux S0ix Troubleshooting</a> and <a rel="nofollow" class="external text" href="https://web.archive.org/web/20230503102522/https://01.org/blogs/thac0/2019/idling-efficiently-linux-case-study">Idling Efficiently on Linux: A Case Study</a> to check if you can make it work as intended.</div>
<p>Run the following command to see all suspend methods hardware advertises support for (current method is shown in square brackets<a rel="nofollow" class="external autonumber" href="https://docs.kernel.org/admin-guide/pm/sleep-states.html#basic-sysfs-interfaces-for-system-suspend-and-hibernation">[1]</a>):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ cat /sys/power/mem_sleep</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[s2idle] shallow deep
</pre>
<p>If your hardware does not advertise the <code>deep</code> sleep status, check first if your UEFI advertises some settings for it, generally under <i>Power</i> or <i>Sleep state</i> or similar wording, with options named <i>Windows 10</i>, <i>Windows and Linux</i> or <i>S3/Modern standby support</i> for S0ix, and <i>Legacy</i>, <i>Linux</i>, <i>Linux S3</i> or <i>S3 enabled</i> for S3 sleep. Failing that, you can keep using <code>s2idle</code>, consider using <a href="../../en/Power_management/Suspend_and_hibernate.html#Hibernation" class="mw-redirect" title="Hibernation">hibernation</a> or try to patch the <a href="../../en/DSDT.html" title="DSDT">DSDT</a> tables (or find a patched version online). 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This last solution is likely going to cause issues. Manufacturers have stopped fixing bugs with the ACPI S3 state since systems shipping with Windows are encouraged to use "Modern standby" by default; if they have voluntarily not advertised it, it is probably broken in some way.</div>
<p>Confirm that your hardware does not exhibit issues with S3 sleep by testing a few sleep cycles after changing the sleep method: 
</p>
<pre># echo "deep" &gt; /sys/power/mem_sleep
</pre>
<p>If no issues have been found, you can make the change permanent with the <code>mem_sleep_default=deep</code> <a href="../../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>.
</p>
<p>In some opposite situations, faulty firmware advertises support for <code>deep</code> sleep, while only <code>s2idle</code> is supported. In this case, an alternative method for using <code>s2idle</code> is available through the <code>SuspendState</code> in <span class="plainlinks archwiki-template-man" title="$ man 5 sleep.conf.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sleep.conf.d.5">sleep.conf.d(5)</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/sleep.conf.d/freeze.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Sleep]
SuspendState=freeze</pre>
<h2><span class="mw-headline" id="Hibernation">Hibernation</span></h2>
<p>In order to use hibernation, you must create a <a href="../../en/Swap.html" title="Swap">swap</a> partition or file, and point the kernel to your swap using the <code>resume=</code> kernel parameter, which is configured via the boot loader. You will also need to <a href="#Configure_the_initramfs">configure the initramfs</a> so that the kernel will attempt to resume from the specified swap in early userspace. These three steps are described in detail below.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>See <a href="../../en/Dm-crypt/Swap_encryption.html#With_suspend-to-disk_support" title="Dm-crypt/Swap encryption">Dm-crypt/Swap encryption#With suspend-to-disk support</a> when using <a href="../../en/Data-at-rest_encryption.html" class="mw-redirect" title="Encryption">encryption</a>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> does not support hibernation, see <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/63648">FS#63648</a>.</li>
<li>Hibernating to <a href="../../en/Zram.html#Usage_as_swap" title="Zram">swap on zram</a> is not supported, even when zram is configured with a backing device on permanent storage. <i>logind</i> will protect against trying to hibernate to a swap space on zram.</li>
</ul>
</div>
<h3>
<span id="About_swap_partition.2Ffile_size"></span><span class="mw-headline" id="About_swap_partition/file_size">About swap partition/file size</span>
</h3>
<p>Even if your swap partition is smaller than RAM, you still have a good chance of hibernating successfully. See "image_size" in the <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/pm/sleep-states.html?highlight=image_size#basic-sysfs-interfaces-for-system-suspend-and-hibernation">kernel documentation</a> for information on the <code>image_size</code> <span class="plainlinks archwiki-template-man" title="$ man 5 sysfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sysfs.5">sysfs(5)</a></span> pseudo-file.
</p>
<p>You may either decrease the value of <code>/sys/power/image_size</code> to make the suspend image as small as possible (for small swap partitions), or increase it to possibly speed up the hibernation process. For systems with a large amount of RAM, smaller values may drastically increase the speed of resuming a hibernating system. <a href="../../en/Systemd.html#systemd-tmpfiles_-_temporary_files" title="Systemd">systemd#systemd-tmpfiles - temporary files</a> can be used to make this change persistent:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/tmpfiles.d/hibernation_image_size.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#    Path                   Mode UID  GID  Age Argument
w    /sys/power/image_size  -    -    -    -   0
</pre>
<p>The suspend image cannot span multiple swap partitions and/or swap files. It must fully fit in one swap partition or one swap file.<a rel="nofollow" class="external autonumber" href="https://docs.kernel.org/power/swsusp.html">[2]</a>
</p>
<h3><span class="mw-headline" id="Configure_the_initramfs">Configure the initramfs</span></h3>
<ul><li>When an <a href="../../en/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs">initramfs</a> with the <code>base</code> hook is used, which is the default, the <code>resume</code> hook is required in <code>/etc/mkinitcpio.conf</code>. Whether by label or by UUID, the swap partition is referred to with a udev device node, so the <code>resume</code> hook must go <i>after</i> the <code>udev</code> hook. This example was made starting from the default hook configuration:</li></ul>
<dl><dd><pre>HOOKS=(base udev autodetect modconf kms keyboard keymap consolefont block filesystems <b>resume</b> fsck)</pre></dd></dl>
<dl><dd>Remember to <a href="../../en/Mkinitcpio.html#Image_creation_and_activation" class="mw-redirect" title="Regenerate the initramfs">regenerate the initramfs</a> for these changes to take effect.</dd></dl>
<dl><dd><div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <a href="../../en/LVM.html" title="LVM">LVM</a> users should add the <code>resume</code> hook after <code>lvm2</code>.</div></dd></dl>
<ul><li>When an initramfs with the <code>systemd</code> hook is used, a resume mechanism is already provided, and no further hooks need to be added.</li></ul>
<h3><span class="mw-headline" id="Required_kernel_parameters">Required kernel parameters</span></h3>
<p>The <a href="../../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> <code>resume=<i>swap_device</i></code> must be used. Any of the <a href="../../en/Persistent_block_device_naming.html" title="Persistent block device naming">persistent block device naming</a> methods can be used as <code><i>swap_device</i></code>. For example:
</p>
<ul>
<li><code>resume=UUID=4209c845-f495-4c43-8a03-5363dd433153</code></li>
<li><code>resume="PARTLABEL=Swap partition"</code></li>
<li>
<code>resume=/dev/archVolumeGroup/archLogicalVolume</code> -- if swap is on a <a href="../../en/LVM.html" title="LVM">LVM</a> logical volume (UUID and Label should also work)</li>
</ul>
<p>The kernel parameters will only take effect after rebooting. To hibernate right away, obtain the volume's major and minor device numbers from <a href="../../en/Device_file.html#lsblk" class="mw-redirect" title="Lsblk">lsblk</a> and echo them in format <code><i>major</i>:<i>minor</i></code> to <code>/sys/power/resume</code>. If using a swap file, additionally echo the resume offset to <code>/sys/power/resume_offset</code>. <a rel="nofollow" class="external autonumber" href="https://docs.kernel.org/power/swsusp.html">[3]</a>
</p>
<p>For example, if the swap device is <code>8:3</code>:
</p>
<pre># echo 8:3 &gt; /sys/power/resume
</pre>
<p>Or when hibernating to a swap file, if the swap file is on volume <code>8:2</code> and has the offset <code>38912</code>:
</p>
<pre># echo 8:2 &gt; /sys/power/resume
# echo 38912 &gt; /sys/power/resume_offset
</pre>
<h4><span class="mw-headline" id="Hibernation_into_swap_file">Hibernation into swap file</span></h4>
<p>Using a <a href="../../en/Swap.html#Swap_file" class="mw-redirect" title="Swap file">swap file</a> requires also setting the <code>resume=UUID=<i>swap_device_uuid</i></code> and additionally a <code>resume_offset=<i>swap_file_offset</i></code> <a href="../../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>. See <a rel="nofollow" class="external text" href="https://docs.kernel.org/power/swsusp-and-swap-files.html">the kernel documentation</a>.
</p>
<p><code><i>swap_device</i></code> is the volume where the swap file resides and it follows the same format as for the <a href="../../en/Persistent_block_device_naming.html#Kernel_parameters" title="Persistent block device naming">root parameter</a>.
</p>
<p>On file systems other than Btrfs, the value of <code><i>swap_file_offset</i></code> can be obtained by running <code>filefrag -v <i>swap_file</i></code>. The output is in a table format and the required value is in the first row of the <code>physical_offset</code> column. 
</p>
<p>For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># filefrag -v /swapfile</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Filesystem type is: ef53
File size of /swapfile is 4294967296 (1048576 blocks of 4096 bytes)
 ext:     logical_offset:        physical_offset: length:   expected: flags:
   0:        0..       0:      <b>38912</b>..     38912:      1:            
   1:        1..   22527:      38913..     61439:  22527:             unwritten
   2:    22528..   53247:     899072..    929791:  30720:      61440: unwritten
...
</pre>
<p>In the example the value of <code><i>swap_file_offset</i></code> is the first <code>38912</code> with the two periods and the kernel parameter would be <code>resume_offset=38912</code>.
</p>
<p>For <a href="../../en/Btrfs.html" title="Btrfs">Btrfs</a>, do not try to use the <i>filefrag</i> tool, since the "physical" offset you get from <i>filefrag</i> is not the real physical offset on disk; there is a virtual disk address space in order to support multiple devices.<a rel="nofollow" class="external autonumber" href="https://bugzilla.kernel.org/show_bug.cgi?id=202803">[4]</a> Instead, use the <span class="plainlinks archwiki-template-man" title="$ man 8 btrfs-inspect-internal"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/btrfs-inspect-internal.8">btrfs-inspect-internal(8)</a></span> command. E.g.:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># btrfs inspect-internal map-swapfile -r /swap/swapfile</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">198122980
</pre>
<p>In this example, <code><i>swap_file_offset</i></code> is <code>198122980</code> and the kernel parameter would be <code>resume_offset=198122980</code>
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>The following command may be used to identify <code><i>swap_device_uuid</i></code>: <code>findmnt -no UUID -T /swapfile</code>
</li>
<li>The following command may be used to identify <code><i>swap_file_offset</i></code> on file systems other than Btrfs: <code>filefrag -v /swapfile | awk '$1=="0:" {print substr($4, 1, length($4)-2)}'</code>
</li>
<li>The value of <code><i>swap_file_offset</i></code> can also be obtained by running <code>swap-offset <i>swap_file</i></code>. The <i>swap-offset</i> binary is provided within the set of tools <a href="../../en/Uswsusp.html" title="Uswsusp">uswsusp</a>. If using this method, then these two parameters have to be provided in <code>/etc/suspend.conf</code> via the keys <code>resume device</code> and <code>resume offset</code>. No reboot is required in this case.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>For a stacked block device such as an encrypted container (LUKS), RAID or LVM, the <code>resume</code> parameter must point to the unlocked/mapped device that contains the file system with the swap file.</li>
<li>If the swap file is in <code>/home/</code>, <i>systemd-logind</i> will not be able to determine its size and thus will prevent hibernation with the following message: <code>Failed to hibernate system via logind: Not enough swap space for hibernation</code>. See <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/15354">systemd issue 15354</a> for two workarounds.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> You might want to decrease the <a href="../../en/Swap.html#Swappiness" class="mw-redirect" title="Swappiness">swappiness</a> for your swap file if the only purpose is to be able to hibernate, not to expand RAM.</div>
<h4><span class="mw-headline" id="Hibernation_into_a_thinly-provisioned_LVM_volume">Hibernation into a thinly-provisioned LVM volume</span></h4>
<p>Hibernation into a thinly-provisioned <a href="../../en/LVM.html" title="LVM">LVM</a> volume is possible, but you have to make sure that the volume is fully allocated. Otherwise resuming from it will fail, see <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/50703">FS#50703</a>.
</p>
<p>You can fully allocate the LVM volume by simply filling it with zeros. E.g.:
</p>
<pre># dd if=/dev/zero of=/dev/vg0/swap bs=1M status=progress
</pre>
<p>To verify the volume is fully allocated, you can use:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># lvs</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  LV                   VG  Attr       LSize   Pool Origin    Data%  Meta%  Move Log Cpy%Sync Convert
  swap                 vg0 Vwi-aot--- 10.00g  pool           100
</pre>
<p>A fully allocated volume will show up as having 100% data usage.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Do not to use <a href="../../en/Solid_state_drive.html#TRIM" class="mw-redirect" title="TRIM">TRIM</a> on thinly-provisioned swap volumes that are used for hibernation, i.e. do not use <code>discard</code> in <code>/etc/fstab</code> and the <code>-d</code>/<code>--discard</code> option of <i>swapon</i>. Otherwise the used space will be deallocated.</div>
<h2>
<span id="Intel_Rapid_Start_Technology_.28IRST.29"></span><span class="mw-headline" id="Intel_Rapid_Start_Technology_(IRST)">Intel Rapid Start Technology (IRST)</span>
</h2>
<p>Intel Rapid Start Technology is a firmware method of hibernation that allows hibernating from sleep after a predefined interval or according to battery state. This should be faster and more reliable than regular hibernation as it is done by firmware instead of at the operating system level. Generally it must enabled in the firmware, and the firmware also provides support for setting the duration after suspend/battery event triggering hibernation. However, some devices–despite supporting IRST in the firmware–only allow it to be configured via Intel's Windows drivers. In such cases the intel-rst kernel module described below should be able to configure the events under Linux.
</p>
<p>With Intel Rapid Start Technology (IRST) enabled, resuming from a deep sleep takes "<a rel="nofollow" class="external text" href="https://mjg59.dreamwidth.org/26022.html">a few seconds longer than resuming from S3 but is far faster than resuming from hibernation</a>".
</p>
<p>Many Intel-based systems have firmware support for IRST but require a special partition on an SSD (rather than an HDD). OEM deployments of Windows may have a pre-existing IRST partition which can be retained during the Arch Linux installation process (rather than wiping and re-partitioning the whole SSD). It should show up as an unformatted partition equal in size to the system's RAM.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The Intel Rapid Start partition is not encrypted; "Intel recommends disabling Intel Rapid Start Technology if you are using software-based disk encryption".<a rel="nofollow" class="external autonumber" href="https://www.intel.com/content/www/us/en/support/articles/000024080/technologies.html">[5]</a>
</div>
<p>If you intend to wipe and re-partition the whole drive (or have already done so), then the IRST partition must be recreated if you also plan on using the technology. This can be done by creating an empty partition equal in size to the system's RAM and by setting its partition type to <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs" class="extiw" title="wikipedia:GUID Partition Table">GUID</a> <code>D3BFE2DE-3DAF-11DF-BA40-E3A556D89593</code> for a <a href="../../en/Partitioning.html#GUID_Partition_Table" class="mw-redirect" title="GPT">GPT</a> partition or <a href="https://en.wikipedia.org/wiki/Partition_type" class="extiw" title="wikipedia:Partition type">ID</a> <code>0x84</code> for an <a href="../../en/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="MBR">MBR</a> partition. You may also need to enable support for IRST in your system's firmware settings.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> The duration of time before IRST kicks in (after suspending) can be adjusted in the system's firmware settings.</div>
<p>The duration of the IRST hibernation process (i.e., copying the "entire contents of RAM to a special partition") is dependent on the system's RAM size and SSD speed and can thus take 20–60 seconds. Some systems may indicate the process's completion with an LED indicator, e.g., when it stops blinking.
</p>
<p>Configuring IRST hibernation events in the Linux kernel requires <code>CONFIG_INTEL_RST</code> built-in or as a module. Once loaded via <code>modprobe intel_rst</code>, it should create the files <code>wakeup_events</code> and <code>wakeup_time</code> under <code>/sys/bus/acpi/drivers/intel_rapid_start/*/</code> that can be used for further configuration. This module is tersely documented, see the source <a rel="nofollow" class="external text" href="https://github.com/torvalds/linux/blob/143a6252e1b8ab424b4b293512a97cca7295c182/drivers/platform/x86/intel/rst.c">drivers/platform/x86/intel/rst.c</a> for more details.
</p>
<p>See also the <a rel="nofollow" class="external text" href="https://www.intel.com/content/www/us/en/support/articles/000024078/technologies.html">general Q&amp;A</a> and <a rel="nofollow" class="external text" href="https://www.intel.com/content/www/us/en/support/articles/000005836/boards-and-kits/desktop-boards.html">user guides</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2023-07-30 ⓘ]</sup> for Intel Rapid Start Technology.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="ACPI_OS_NAME">ACPI_OS_NAME</span></h3>
<p>You might want to tweak your <b>DSDT table</b> to make it work. See <a href="../../en/DSDT.html" title="DSDT">DSDT</a>.
</p>
<h3>
<span id="Suspend.2Fhibernate_does_not_work.2C_or_does_not_work_consistently"></span><span class="mw-headline" id="Suspend/hibernate_does_not_work,_or_does_not_work_consistently">Suspend/hibernate does not work, or does not work consistently</span>
</h3>
<p>There have been many reports about the screen going black without easily viewable errors or the ability to do anything when going into and coming back from suspend and/or hibernate. These problems have been seen on both laptops and desktops. This is not an official solution, but switching to an older kernel, especially the LTS-kernel, will probably fix this.
</p>
<p>A problem may arise when using the hardware watchdog timer (disabled by default, see <code>RuntimeWatchdogSec=</code> in <span class="plainlinks archwiki-template-man" title="$ man 5 systemd-system.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-system.conf.5#OPTIONS">systemd-system.conf(5) § OPTIONS</a></span>). A buggy watchdog timer may reset the computer before the system finishes creating the hibernation image.
</p>
<p>Sometimes the screen goes black due to device initialization from within the initramfs. Removing any modules you might have in <a href="../../en/Mkinitcpio.html#MODULES" title="Mkinitcpio">Mkinitcpio#MODULES</a>, removing the <code>kms</code> hook and rebuilding the initramfs can possibly solve this issue, in particular with graphics drivers for <a href="../../en/Kernel_mode_setting.html#Early_KMS_start" title="Kernel mode setting">early KMS</a>. Initializing such devices before resuming can cause inconsistencies that prevents the system resuming from hibernation. This does not affect resuming from RAM. Also, check the blog article <a rel="nofollow" class="external text" href="https://web.archive.org/web/20230502010825/https://01.org/blogs/rzhang/2015/best-practice-debug-linux-suspend/hibernate-issues">best practices to debug suspend issues</a>.
</p>
<p>Moving from the <a href="../../en/ATI.html" title="ATI">ATI</a> video driver to the newer <a href="../../en/AMDGPU.html" title="AMDGPU">AMDGPU</a> driver could also help to make the hibernation and awakening process successful.
</p>
<p>For <a href="../../en/NVIDIA.html" title="NVIDIA">NVIDIA</a> users, <a href="../../en/Kernel_module.html#Blacklisting" class="mw-redirect" title="Blacklisting">blacklisting</a> the module <code>nvidiafb</code> might help. <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=234646">[6]</a>
</p>
<p>Laptops with an Intel CPU that load the <code>intel_lpss_pci</code> module for a touchpad may face kernel panic on resume (blinking caps lock) <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=231881">[7]</a>. The module needs to be added to <a href="../../en/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs">initramfs</a> as:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES=(... intel_lpss_pci ...)</pre>
<p>Then <a href="../../en/Mkinitcpio.html#Image_creation_and_activation" class="mw-redirect" title="Regenerate the initramfs">regenerate the initramfs</a>.
</p>
<h3><span class="mw-headline" id="Wake-on-LAN">Wake-on-LAN</span></h3>
<p>If <a href="../../en/Wake-on-LAN.html" title="Wake-on-LAN">Wake-on-LAN</a> is active, the network interface card will consume power even if the computer is hibernated.
</p>
<h3><span class="mw-headline" id="Instantaneous_wakeups_from_suspend">Instantaneous wakeups from suspend</span></h3>
<p>See <a href="../../en/Power_management/Wakeup_triggers.html#Instantaneous_wakeups_from_suspend" class="mw-redirect" title="Wakeup triggers">Wakeup triggers#Instantaneous wakeups from suspend</a>.
</p>
<p>If you are using Linux kernel 6.1 and above on an AMD CPU, this can also be caused by <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/drm/amd/-/issues/2357">an S3-related control policy issue in the kernel</a>. A temporary solution would be turning off wakeup on related i2c devices. You can find them by
</p>
<pre>$ ls /sys/bus/i2c/devices/*/power/wakeup
</pre>
<p>And the format of the device name should be <code>i2c-ELAN0679:00</code> or <code>i2c-MSFT0001:00</code>. Then, test if the below command can enter suspend:
</p>
<pre># echo disabled &gt; /sys/bus/i2c/devices/<i>device_name</i>/power/wakeup
# systemctl suspend
</pre>
<p>If it works, you can persist this config by adding udev rules:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/99-avoid-i2c-wakeup.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">KERNEL=="<i>device_name</i>", SUBSYSTEM=="i2c", ATTR{power/wakeup}="disabled"</pre>
<h3><span class="mw-headline" id="System_does_not_power_off_when_hibernating">System does not power off when hibernating</span></h3>
<p>When you hibernate your system, the system should power off (after saving the state on the disk). Sometimes, you might see the power LED is still glowing. If that happens, it might be instructive to set the <code>HibernateMode</code> to <code>shutdown</code> in <span class="plainlinks archwiki-template-man" title="$ man 5 sleep.conf.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sleep.conf.d.5">sleep.conf.d(5)</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/sleep.conf.d/hibernatemode.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Sleep]
HibernateMode=shutdown</pre>
<p>With the above configuration, if everything else is set up correctly, on invocation of a <code>systemctl hibernate</code> the machine will shut down, saving state to disk as it does so.
</p>
<h3>
<span id="Operating_system_not_found_.28or_wrong_OS_booting.29_when_booting_after_hibernation"></span><span class="mw-headline" id="Operating_system_not_found_(or_wrong_OS_booting)_when_booting_after_hibernation">Operating system not found (or wrong OS booting) when booting after hibernation</span>
</h3>
<p>This can happen when the boot disk is an external disk, and seems to be caused by a BIOS/firmware limitation. The BIOS/firmware tries to boot from an internal disk, while hibernation was done from an OS on an external (or other) disk.
</p>
<p>Set <code>HibernateMode=shutdown</code> as shown in <a href="#System_does_not_power_off_when_hibernating">#System does not power off when hibernating</a> to solve the problem permanently. If you have already locked yourself out, you can try rebooting your system 4 times (wait for the error to appear each time), which on some BIOS'es forces a normal boot procedure.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:Power_management.html" title="Category:Power management">Power management</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Power_management/Suspend_and_hibernate&amp;oldid=786654">https://wiki.archlinux.org/index.php?title=Power_management/Suspend_and_hibernate&amp;oldid=786654</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 1 September 2023, at 17:22.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
