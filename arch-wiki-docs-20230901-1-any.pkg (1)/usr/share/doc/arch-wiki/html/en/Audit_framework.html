<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Audit framework - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Audit_framework rootpage-Audit_framework skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Installation</div>
			</a>
			
			<ul id="toc-Installation-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Adding_rules" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Adding_rules">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Adding rules</div>
			</a>
			
				<button aria-controls="toc-Adding_rules-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Adding rules subsection
				</button>
			
			<ul id="toc-Adding_rules-sublist" class="sidebar-toc-list">
				<li id="toc-Audit_files_and_directories_access" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Audit_files_and_directories_access">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>Audit files and directories access</div>
			</a>
			
			<ul id="toc-Audit_files_and_directories_access-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Audit_syscalls" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Audit_syscalls">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.2</span>Audit syscalls</div>
			</a>
			
			<ul id="toc-Audit_syscalls-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Filter_unwanted_messages" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Filter_unwanted_messages">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.3</span>Filter unwanted messages</div>
			</a>
			
			<ul id="toc-Filter_unwanted_messages-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Search_the_logs" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Search_the_logs">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Search the logs</div>
			</a>
			
				<button aria-controls="toc-Search_the_logs-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Search the logs subsection
				</button>
			
			<ul id="toc-Search_the_logs-sublist" class="sidebar-toc-list">
				<li id="toc-Using_pid" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Using_pid">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3.1</span>Using pid</div>
			</a>
			
			<ul id="toc-Using_pid-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Using_keys" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Using_keys">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3.2</span>Using keys</div>
			</a>
			
			<ul id="toc-Using_keys-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Look_for_abnormalities" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Look_for_abnormalities">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3.3</span>Look for abnormalities</div>
			</a>
			
			<ul id="toc-Look_for_abnormalities-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Which_files_or_syscalls_are_worth-auditing?" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Which_files_or_syscalls_are_worth-auditing?">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Which files or syscalls are worth-auditing?</div>
			</a>
			
			<ul id="toc-Which_files_or_syscalls_are_worth-auditing?-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Gather_logs_from_different_hosts" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Gather_logs_from_different_hosts">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>Gather logs from different hosts</div>
			</a>
			
				<button aria-controls="toc-Gather_logs_from_different_hosts-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Gather logs from different hosts subsection
				</button>
			
			<ul id="toc-Gather_logs_from_different_hosts-sublist" class="sidebar-toc-list">
				<li id="toc-Send_logfiles" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Send_logfiles">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.1</span>Send logfiles</div>
			</a>
			
			<ul id="toc-Send_logfiles-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Receive_logfiles" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Receive_logfiles">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.2</span>Receive logfiles</div>
			</a>
			
			<ul id="toc-Receive_logfiles-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Rotate_the_logs" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Rotate_the_logs">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6</span>Rotate the logs</div>
			</a>
			
			<ul id="toc-Rotate_the_logs-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Troubleshooting" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Troubleshooting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">7</span>Troubleshooting</div>
			</a>
			
				<button aria-controls="toc-Troubleshooting-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Troubleshooting subsection
				</button>
			
			<ul id="toc-Troubleshooting-sublist" class="sidebar-toc-list">
				<li id="toc-Audit_logs_flooding_into_virtual_console" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Audit_logs_flooding_into_virtual_console">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">7.1</span>Audit logs flooding into virtual console</div>
			</a>
			
			<ul id="toc-Audit_logs_flooding_into_virtual_console-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Audit_framework.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="mw-list-item"><a href="../en/Talk:Audit_framework.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Audit_framework.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Audit_framework&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Audit_framework&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Audit_framework.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Audit_framework&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Audit_framework&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<p>The Linux audit framework provides a CAPP-compliant (<a href="https://en.wikipedia.org/wiki/Controlled_Access_Protection_Profile" class="extiw" title="wikipedia:Controlled Access Protection Profile">Controlled Access Protection Profile</a>) auditing system that reliably collects information about any security-relevant (or non-security-relevant) event on a system. It can help you track actions  performed on a system.
</p>
<p>Linux audit helps make your system more secure by providing you with means to analyze what is happening on your system in great detail. It does not, however, provide additional security itself—it does not protect your system from code malfunctions or any kind of exploits. Instead, Audit is useful for tracking these issues and helps you take additional security measures to prevent them.
</p>
<p>The audit framework works by listening to the event reported by the kernel and logging them to a log file.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Audit framework compatibility with containers was fixed in Linux 3.15, see <a rel="nofollow" class="external autonumber" href="https://bugzilla.redhat.com/show_bug.cgi?id=893751">[1]</a>, however interpreting audit records may be difficult as support for namespace ID is still work in progress, see <a rel="nofollow" class="external autonumber" href="https://github.com/linux-audit/audit-kernel/issues/32">[2]</a>.</div>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>In-kernel audit support is available in all <a href="../en/Kernel.html#Officially_supported_kernels" title="Kernel">officially supported kernels</a>. For custom kernels <code>CONFIG_AUDIT</code> should be enabled.
</p>
<p>Audit can be enabled at boot-time by setting <code>audit=1</code> as <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>. This will ensure that all processes that run before the audit daemon starts are marked as auditable by the kernel. Not doing that will make a few processes impossible to properly audit. See <span class="plainlinks archwiki-template-man" title="$ man 8 auditd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/auditd.8">auditd(8)</a></span>.
</p>
<p>For userspace support <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=audit">audit</a></span> and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a> <code>auditd.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> In order to disable audit completely and suppress audit messages from appearing in journal you may set <code>audit=0</code> as <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> and/or <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Mask">mask</a> <code>systemd-journald-audit.socket</code>.</div>
<p>Audit framework is composed of the auditd daemon, responsible for writing the audit messages that were generated through the audit kernel interface and triggered by application and system activity.
</p>
<p>This daemon can be controlled by several commands and files:
</p>
<ul>
<li>
<i>auditctl</i> : to control the behavior of the daemon on the fly, adding rules etc.</li>
<li>
<code>/etc/audit/audit.rules</code> : contains the rules and various parameters of the auditd daemon</li>
<li>
<i>aureport</i> : generate report of the activity on a system</li>
<li>
<i>ausearch</i> : search for various events</li>
<li>
<i>auditspd</i> : the daemon which can be used to relay event notifications to other applications instead of writing them to disk in the audit log</li>
<li>
<i>autrace</i> : this command can be used to trace a process, in a similar way as strace.</li>
<li>
<code>/etc/audit/auditd.conf</code> : configuration file related to the logging.</li>
</ul>
<h2><span class="mw-headline" id="Adding_rules">Adding rules</span></h2>
<p>Before adding rules, you must know that the audit framework can be very verbose and that each rule must be carefully tested before being effectively deployed. Indeed, just one rule can flood all your logs within a few minutes.
</p>
<h3><span class="mw-headline" id="Audit_files_and_directories_access">Audit files and directories access</span></h3>
<p>The most basic use of the audit framework is to log the access to the files you want.
To do this, you must use a watch <code>-w</code> to a file or a directory.
The most basic rule to set up is to track accesses to the passwd file :
</p>
<pre># auditctl -w /etc/passwd -p rwxa
</pre>
<p>You can track access to a folder with :
</p>
<pre># auditctl -w /etc/security/
</pre>
<p>The first rule keeps track of every read <code>r</code> , write <code>w</code> , execution <code>x</code> , attribute change <code>a</code>  to the file <code>/etc/passwd</code>.
The second one keeps track of any access to the <code>/etc/security/</code> folder.
</p>
<p>You can list all active rules with :
</p>
<pre># auditctl -l
</pre>
<p>You can delete all rules with :
</p>
<pre># auditctl -D
</pre>
<p>Once you validate the rules, you can append them to the <code>/etc/audit/audit.rules</code> file like that : 
</p>
<pre>-w /etc/audit/audit.rules -p rwxa
-w /etc/security/
</pre>
<h3><span class="mw-headline" id="Audit_syscalls">Audit syscalls</span></h3>
<p>The audit framework allows you to audit the syscalls performed with the <code>-a</code> option.
</p>
<p>A security related rule is to track the <span class="plainlinks archwiki-template-man" title="$ man 2 chmod"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/chmod.2">chmod(2)</a></span> syscall, to detect file ownership changes :
</p>
<pre># auditctl -a exit,always -S chmod
</pre>
<p>For a list of all syscalls: <span class="plainlinks archwiki-template-man" title="$ man 2 syscalls"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/syscalls.2">syscalls(2)</a></span>
</p>
<p>A lot of rules and possibilities are available, see <span class="plainlinks archwiki-template-man" title="$ man 8 auditctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/auditctl.8">auditctl(8)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 7 audit.rules"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/audit.rules.7">audit.rules(7)</a></span>.
</p>
<h3><span class="mw-headline" id="Filter_unwanted_messages">Filter unwanted messages</span></h3>
<p>In order to prevent noisy audit messages from flooding system logs you may add rules to exclude some of them:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/audit/rules.d/quiet.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">-A exclude,always -F msgtype=SERVICE_START
-A exclude,always -F msgtype=SERVICE_STOP
-A exclude,always -F msgtype=BPF
-A exclude,always -F exe=/usr/bin/sudo</pre>
<p>Remember to verify changes (fix as necessary) and regenerate <code>/etc/audit/audit.rules</code> as follows:
</p>
<pre># augenrules --check
# augenrules --load
</pre>
<h2><span class="mw-headline" id="Search_the_logs">Search the logs</span></h2>
<p>The audit framework provides some tools to ease the use and the research of events happening on a system.
</p>
<h3><span class="mw-headline" id="Using_pid">Using pid</span></h3>
<p>You can search events related to a particular pid using <code>ausearch</code>:
</p>
<pre># ausearch -p 1
</pre>
<p>This command will show you all the events logged according to your rules related to PID 1 (i.e. systemd).
</p>
<h3><span class="mw-headline" id="Using_keys">Using keys</span></h3>
<p>One of the great features of the audit framework is its ability to use <code>keys</code> to manage events, such a usage is recommended.
</p>
<p>You can use the <code>-k</code> option in your rules to be able to find related events easily :
</p>
<pre># auditctl -w /etc/passwd -p rwxa -k KEY_pwd
</pre>
<p>Then, if you search for events with the key <code>KEY_pwd</code>, ausearch will display only event related to the file <code>/etc/passwd</code>.
</p>
<pre># ausearch -k KEY_pwd
</pre>
<h3><span class="mw-headline" id="Look_for_abnormalities">Look for abnormalities</span></h3>
<p>The <code>aureport</code> tool can be used to quickly report any abnormal event performed on the system, it includes network interfaces used in promiscous mode, process or thread crashing or exiting with ENOMEM error etc.
</p>
<p>The easiest way to use <code>aureport</code> is :
</p>
<pre># aureport -n
</pre>
<p>aureport can be used to generate custom reports, see <span class="plainlinks archwiki-template-man" title="$ man 8 aureport"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aureport.8">aureport(8)</a></span>.
</p>
<h2>
<span id="Which_files_or_syscalls_are_worth-auditing.3F"></span><span class="mw-headline" id="Which_files_or_syscalls_are_worth-auditing?">Which files or syscalls are worth-auditing?</span>
</h2>
<p>Keep in mind that each audit rule added will generate logs, so you must be ready to treat this amount of information.
Basically, each security-related event/file must be monitored, like ids, ips, anti-rootkits etc.
On the other side, it is totally useless to track every write syscall, the smallest compilation will fill your logs with this event.
</p>
<p>More complex set of rules can be set up, performing auditing on a very fine-grained base. If you want to do so, see <span class="plainlinks archwiki-template-man" title="$ man 8 auditctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/auditctl.8">auditctl(8)</a></span>.
</p>
<h2><span class="mw-headline" id="Gather_logs_from_different_hosts">Gather logs from different hosts</span></h2>
<p>The audit framework has a plugin system which provides the possibility to send local logfiles to a remote auditd.
</p>
<h3><span class="mw-headline" id="Send_logfiles">Send logfiles</span></h3>
<p>To send your logfiles to a remote host you need the <code>audisp-remote</code> plugin which comes automatically with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=audit">audit</a></span> package.
Activate the plugin:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/audisp/plugins.d/au-remote.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">active = yes
direction = out
path = /usr/bin/audisp-remote
type = always
format = string</pre>
<p>and set the remote host where the logs should be send to:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/audisp/audisp-remote.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">remote_server = domain.name.or.ip
port = 60
##local_port = optional
transport = tcp</pre>
<h3><span class="mw-headline" id="Receive_logfiles">Receive logfiles</span></h3>
<p>To make audit listen for remote audispds you just need to set the tcp options:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/audit/auditd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">tcp_listen_port = 60
tcp_listen_queue = 5
tcp_max_per_addr = 1
##tcp_client_ports = 1024-65535 #optional
tcp_client_max_idle = 0</pre>
<p>Now you can view the logs of <b>all</b> configured hosts in the logfiles of the receiving auditd.
</p>
<h2><span class="mw-headline" id="Rotate_the_logs">Rotate the logs</span></h2>
<p>Send <code>SIGUSR1</code> to the audit daemon:
</p>
<pre># pkill -USR1 -x auditd
</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Audit_logs_flooding_into_virtual_console">Audit logs flooding into virtual console</span></h3>
<p>For users not having enabled auditd, using kernel debug messages higher than <code>loglevel=4</code> can result in audit flooding security notices on top of virtual terminal.
</p>
<p>These messages can be silenced by <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enabling">enabling</a> <code>auditd.service</code>. 
</p>
<p>Alternative solutions are: 
</p>
<ul>
<li>lowering your loglevel,</li>
<li>disabling audit logs with the <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> <code>audit=0</code>.</li>
</ul>
<p>See the <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/15324">systemd issue 15324 on GitHub</a> for the details.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Security.html" title="Category:Security">Security</a></li>
<li><a href="../en/Category:Logging.html" title="Category:Logging">Logging</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Audit_framework&amp;oldid=786370">https://wiki.archlinux.org/index.php?title=Audit_framework&amp;oldid=786370</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 28 August 2023, at 14:53.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
