<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Kernel/Arch build system - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Kernel_Arch_build_system rootpage-Kernel skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Getting_the_ingredients" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Getting_the_ingredients">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Getting the ingredients</div>
			</a>
			
			<ul id="toc-Getting_the_ingredients-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Modifying_the_PKGBUILD" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Modifying_the_PKGBUILD">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Modifying the PKGBUILD</div>
			</a>
			
				<button aria-controls="toc-Modifying_the_PKGBUILD-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Modifying the PKGBUILD subsection
				</button>
			
			<ul id="toc-Modifying_the_PKGBUILD-sublist" class="sidebar-toc-list">
				<li id="toc-Avoid_creating_the_doc" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Avoid_creating_the_doc">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>Avoid creating the doc</div>
			</a>
			
			<ul id="toc-Avoid_creating_the_doc-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Changing_prepare()" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Changing_prepare()">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.2</span>Changing prepare()</div>
			</a>
			
			<ul id="toc-Changing_prepare()-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Generate_new_checksums" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Generate_new_checksums">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.3</span>Generate new checksums</div>
			</a>
			
			<ul id="toc-Generate_new_checksums-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Compiling" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Compiling">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Compiling</div>
			</a>
			
			<ul id="toc-Compiling-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Installing" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Installing">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Installing</div>
			</a>
			
			<ul id="toc-Installing-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Boot_loader" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Boot_loader">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>Boot loader</div>
			</a>
			
			<ul id="toc-Boot_loader-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Updating" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Updating">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6</span>Updating</div>
			</a>
			
				<button aria-controls="toc-Updating-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Updating subsection
				</button>
			
			<ul id="toc-Updating-sublist" class="sidebar-toc-list">
				<li id="toc-Cleanup" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Cleanup">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6.1</span>Cleanup</div>
			</a>
			
			<ul id="toc-Cleanup-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-See_also" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#See_also">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">7</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../../en/Kernel/Arch_build_system.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="mw-list-item"><a href="../../en/Talk:Kernel/Arch_build_system.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../../en/Kernel/Arch_build_system.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Kernel/Arch_build_system&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Kernel/Arch_build_system&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../../en/Kernel/Arch_build_system.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Kernel/Arch_build_system&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Kernel/Arch_build_system&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><span class="subpages">&lt; <a href="../../en/Kernel.html" title="Kernel">Kernel</a></span></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<p>The <a href="../../en/Arch_build_system.html" title="Arch build system">Arch build system</a> can be used to build a custom kernel based on the official <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> package. This compilation method can automate the entire process, and is based on a very well tested package. You can edit the PKGBUILD to use a custom kernel configuration or add additional <a href="../../en/Patching_packages.html" class="mw-redirect" title="Patch">patches</a>.
</p>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Getting_the_ingredients">Getting the ingredients</span></h2>
<p>Since you will be using <a href="../../en/Makepkg.html" title="Makepkg">makepkg</a>, follow the best practices outlined there first. For example, you cannot run makepkg as the <a href="../../en/Users_and_groups.html#Overview" class="mw-redirect" title="Root user">root user</a>. Therefore, create a <code>build</code> directory in your user home first.
</p>
<pre>$ mkdir ~/build/
$ cd ~/build/
</pre>
<p><a href="../../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=devtools">devtools</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base-devel">base-devel</a></span> package.
</p>
<p>You need a clean kernel to start your customization from. <a href="../../en/Arch_build_system.html#Retrieve_PKGBUILD_source_using_Git" class="mw-redirect" title="ABS">Retrieve PKGBUILD source using Git</a> and few other files into your build directory by running:
</p>
<pre>$ pkgctl repo clone --protocol=https linux
</pre>
<p>At this point, the directory tree looks like (there may be a few other files):
</p>
<pre>~/build/linux/-+
               +--config
               \__PKGBUILD
</pre>
<p>Then, get any other file you need (e.g. custom configuration files, patches, etc.) from the respective sources.
</p>
<h2><span class="mw-headline" id="Modifying_the_PKGBUILD">Modifying the PKGBUILD</span></h2>
<p>Edit <code>PKGBUILD</code> and look for the <code>pkgbase</code> parameter. Change this to your custom package name, e.g.:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">PKGBUILD</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pkgbase=linux-custom</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> <b>Do not</b> add <code>linux</code> to the <code>provides</code> array. Your custom kernel will not be compatible with binary modules built against that kernel, so it cannot satisfy that dependency. Similarly, do not add <code>linux-headers</code> to the <code>provides</code> array of the headers package, for similar reasons.</div>
<h3><span class="mw-headline" id="Avoid_creating_the_doc">Avoid creating the doc</span></h3>
<p>A large portion of the lengthy <a href="#Compiling">compiling</a> effort is devoted to creating the documentation. As of 25 August 2022, the following patch to PKGBUILD avoids its creation:
</p>
<pre>63c63
&lt;   make htmldocs all
---
&gt;   make all
195c195
&lt; pkgname=("$pkgbase" "$pkgbase-headers" "$pkgbase-docs")
---
&gt; pkgname=("$pkgbase" "$pkgbase-headers")</pre>
<p>This patch changes lines #63 and #195. You might have to edit the PKGBUILD file manually if it does not apply cleanly.
</p>
<h3>
<span id="Changing_prepare.28.29"></span><span class="mw-headline" id="Changing_prepare()">Changing prepare()</span>
</h3>
<p>In <code>prepare()</code> function, you can <a href="../../en/Patching_packages.html#Applying_patches" title="Patching packages">apply needed kernel patches</a> or change kernel build configuration. As of 20 August 2023, the PKGBUILD automatically applies all <code>*.patch</code> files in source.
</p>
<p>If you need to change a few configuration options you can edit <code>config</code> in the source.
</p>
<p>Or you can use a GUI tool to tweak the options. Comment <code>make olddefconfig</code> in the prepare() function of the PKGBUILD, and add your favorite tool (run <code>make help</code> to list all of the possible configuration targets):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">PKGBUILD</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
  msg2 "Setting config..."
  cp ../config .config
  #make olddefconfig

  make nconfig     # new CLI menu for configuration
  #make menuconfig # CLI menu for configuration
  #make xconfig    # X-based configuration
  #make oldconfig  # using old config from previous kernel version
  # ... or manually edit .config
  make prepare
...
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> systemd has a number of kernel configuration requirements for general use, for specific usecases (e.g., UEFI) and for specific systemd functionality (e.g., bootchart). Failure to meet these requirements can result in your system being degraded or unusable. The list of required and recommended kernel CONFIGs can be found in <code>/usr/share/doc/systemd/README</code>. Check them before you compile. These requirements also change over time. Because Arch assumes you are using the official kernel, there will be no announcement of these changes. Before you install a new version of systemd, check the version release notes to make sure your current custom kernel meets any new systemd requirements.</div>
<h3><span class="mw-headline" id="Generate_new_checksums">Generate new checksums</span></h3>
<p><a href="#Changing_prepare()">#Changing prepare()</a> suggests a possible modification to <code>$_srcname/.config</code>. Since this path is not where downloading the package files ended, its checksum was not checked by makepkg (which actually checked <code>$_srcname/../../config</code>).
</p>
<p>If you replaced the downloaded <code>config</code> with another one before running makepkg, <a href="../../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman-contrib">pacman-contrib</a></span> package and generate new checksums by running:
</p>
<pre>$ updpkgsums
</pre>
<h2><span class="mw-headline" id="Compiling">Compiling</span></h2>
<p>You can now proceed to compile your kernel by the usual command <code>makepkg</code>.
</p>
<p>If you have chosen an interactive program for configuring the kernel parameters (like menuconfig), you need to be there during the compilation.
</p>
<pre>$ makepkg -s
</pre>
<p>The <code>-s</code> parameter will download any additional dependencies used by recent kernels such as xml and docs.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Kernel sources are <a rel="nofollow" class="external text" href="https://www.kernel.org/signature.html#kernel-org-web-of-trust">PGP signed</a>, and makepkg will attempt to verify them. See <a href="../../en/Makepkg.html#Signature_checking" title="Makepkg">makepkg#Signature checking</a> for details.</li>
<li>The compilation can take up to several hours to complete depending on the hardware performance. <a href="../../en/Makepkg.html#Parallel_compilation" title="Makepkg">Running compilation jobs simultaneously</a> can reduce compilation time significantly on multi-core systems.</li>
<li>It can be informative to run the above <code>makepkg</code> using the <code>time</code> command to know how long your system took to perform the compilation.</li>
</ul>
</div>
<h2><span class="mw-headline" id="Installing">Installing</span></h2>
<p>The compile step will leave two packages in the <code>~/build/linux</code> folder, one for the kernel and one for the kernel headers. They might have names like:
</p>
<pre>linux-custom-5.8.12-x86_64.pkg.tar.zst
linux-custom-headers-5.8.12-x86_64.pkg.tar.zst
</pre>
<p>Best practice is to <a href="../../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> both packages together as they might be both needed (e.g. <a href="../../en/Dynamic_Kernel_Module_Support.html" class="mw-redirect" title="DKMS">DKMS</a>):
</p>
<pre># pacman -U <i>linux-custom-headers-5.8.12-x86_64.pkg.tar.zst</i> <i>linux-custom-5.8.12-x86_64.pkg.tar.zst</i>
</pre>
<p>(substitute the actual names of the files you have in the folder)
</p>
<h2><span class="mw-headline" id="Boot_loader">Boot loader</span></h2>
<p>If you have modified <code>pkgbase</code> in order to have your new kernel installed alongside the default kernel you will need to update your bootloader configuration file and add new entries ('default' and 'fallback') for your custom kernel and the associated initramfs images.
</p>
<h2><span class="mw-headline" id="Updating">Updating</span></h2>
<p>Assuming one has an arch kernel source that they want to update, one method to do that is with <a rel="nofollow" class="external free" href="https://github.com/archlinux/linux">https://github.com/archlinux/linux</a>. In what follows, the top kernel source directory is assumed at <code>~/build/linux/</code>.
</p>
<p>In general, arch sets an arch kernel source with two local git repositories. The one at <code>archlinux-linux/</code> is a local bare <a href="../../en/Git.html" title="Git">git</a> repository pointing to <code>https://github.com/archlinux/linux.git</code>. The other one is at <code><b>src/</b>archlinux-linux/</code>, pulling from the bare repository. Possible local patches, and building, are expected at <code><b>src/</b>archlinux-linux/</code>.
</p>
<p>For this example, the HEAD of the locally installed bare git repository source at <code>archlinux-linux/</code> was initially pointing to
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ cd ~/build/linux/archlinux-linux/
$ git log --oneline --max-count 1 HEAD</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">4010b622f1d2 Merge branch 'dax-fix-5.3-rc3' of git://git.kernel.org/pub/scm/linux/kernel/git/nvdimm/nvdimm</pre>
<p>which is somewhere between v5.2.5-arch1 and v5.2.6-arch1.
</p>
<pre>$ git fetch --verbose
</pre>
<p>One can see it fetched v5.2.7-arch1, which was the newest archlinux tag, because it prints what new tags were obtained. If no new tags were obtained then there is no newer archlinux source available.
</p>
<p>Now the source can be updated where the actual build will take place.
</p>
<pre>$ cd ~/build/linux/src/archlinux-linux/
$ git checkout master
$ git pull
$ git fetch --tags --verbose
$ git branch --verbose 5.2.7-arch1 v5.2.7-arch1
$ git checkout 5.2.7-arch1
</pre>
<p>You can verify you are on track with something like
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ git log --oneline 5.2.7-arch1 --max-count=7</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">13193bfc03d4 <b>Arch Linux kernel v5.2.7-arch1</b>
9475c6772d05 netfilter: nf_tabf676926c7f60les: fix module autoload for redir
498d650048f6 iwlwifi: Add support for SAR South Korea limitation
bb7293abdbc7 iwlwifi: mvm: disable TX-AMSDU on older NICs
f676926c7f60 ZEN: Add CONFIG for unprivileged_userns_clone
5e4e503f4f28 add sysctl to disallow unprivileged CLONE_NEWUSER by default
5697a9d3d55f <b>Linux 5.2.7</b></pre>
<p>This shows few specific archlinux patches between <code>Arch Linux kernel v5.2.7-arch1</code> and <code>Linux 5.2.7</code>.
</p>
<p>The up to date PKGBUILD, as well archlinux kernel configuration file, can be pulled in using <code>git</code> in the package directory:
</p>
<pre>$ cd ~/build/linux/
$ git pull
</pre>
<p>Now you should <a href="../../en/Vim.html#Merging_files" title="Vim">merge files</a> located in <code>~/build/linux/linux/*</code> into <code>~/build/linux/</code>. Merging can also done manually, or with <a href="../../en/List_of_applications.html#Comparison,_diff,_merge" title="List of applications">specific utilities</a>. Review <a href="#Changing_prepare()">#Changing prepare()</a>, and run manually most, if not all, the shell commands of PKGBUILD::prepare().
</p>
<p>At this point, <code>makepkg --verifysource</code> should succeed. While <a href="#Compiling">#Compiling</a>, make sure to also add <code>--noextract</code> option to the <code>makepkg</code> command, since it should be able to build the packages as if the source was extracted by <code>makepkg --nobuild</code>. And you are back to <a href="#Installing">#Installing</a>.
</p>
<h3><span class="mw-headline" id="Cleanup">Cleanup</span></h3>
<p>One will probably want to remove <code>~/build/linux/linux/</code> after merging. In addition, <code>~/build/linux/src/archlinux</code> will accumulate branches in the form of <code>5.2.7-arch1</code> if more recent updates are done in this fashion. These can be deleted with
</p>
<pre>$ cd ~/build/linux/src/archlinux
$ git branch --delete --force --verbose 5.2.7-arch1
</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li>
<a rel="nofollow" class="external free" href="https://docs.kernel.org/kbuild/kconfig.html">https://docs.kernel.org/kbuild/kconfig.html</a> and the parent directory</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:Kernel.html" title="Category:Kernel">Kernel</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Kernel/Arch_build_system&amp;oldid=785784">https://wiki.archlinux.org/index.php?title=Kernel/Arch_build_system&amp;oldid=785784</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 20 August 2023, at 02:27.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
