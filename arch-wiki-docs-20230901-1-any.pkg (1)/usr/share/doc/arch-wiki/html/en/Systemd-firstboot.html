<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>systemd-firstboot - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Systemd-firstboot rootpage-Systemd-firstboot skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Installation</div>
			</a>
			
			<ul id="toc-Installation-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Usage_Example" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Usage_Example">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Usage Example</div>
			</a>
			
				<button aria-controls="toc-Usage_Example-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Usage Example subsection
				</button>
			
			<ul id="toc-Usage_Example-sublist" class="sidebar-toc-list">
				<li id="toc-Interactively_configure_system_settings_during_boot_of_a_fresh_Arch_Linux_installation" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Interactively_configure_system_settings_during_boot_of_a_fresh_Arch_Linux_installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>Interactively configure system settings during boot of a fresh Arch Linux installation</div>
			</a>
			
			<ul id="toc-Interactively_configure_system_settings_during_boot_of_a_fresh_Arch_Linux_installation-sublist" class="sidebar-toc-list">
				<li id="toc-Delete_existing_settings" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Delete_existing_settings">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1.1</span>Delete existing settings</div>
			</a>
			
			<ul id="toc-Delete_existing_settings-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Modify_and_enable_systemd-firstboot.service" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Modify_and_enable_systemd-firstboot.service">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1.2</span>Modify and enable systemd-firstboot.service</div>
			</a>
			
			<ul id="toc-Modify_and_enable_systemd-firstboot.service-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Finalize_installation" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Finalize_installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1.3</span>Finalize installation</div>
			</a>
			
			<ul id="toc-Finalize_installation-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-See_also" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#See_also">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Systemd-firstboot.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Systemd-firstboot&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Systemd-firstboot.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Systemd-firstboot&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Systemd-firstboot&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Systemd-firstboot.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Systemd-firstboot&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Systemd-firstboot&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<p><span>
</span>
Starting with version 216 of <a href="../en/Systemd.html" title="Systemd">systemd</a>, the command <i>systemd-firstboot</i> allows for setting of basic system settings before or during the first boot of a newly created system. The tool is able of initialize the following system settings: <a href="../en/System_time.html#Time_zone" class="mw-redirect" title="Timezone">timezone</a>, <a href="../en/Locale.html" title="Locale">locale</a>, <a href="../en/Network_configuration.html#Set_the_hostname" class="mw-redirect" title="Hostname">hostname</a>, the root password, as well as automated generation of a machine ID. 
</p>
<p>As <i>systemd-firstboot</i> interacts with the filesystem directly and does not make use of the related systemd services (such as timedatectl, hostnamectl or localectl), it should not be executed on an already running system. 
</p>
<p>Settings can be specified non-interactively when externally used on filesystem images, or interactively if executed during the early boot process. 
</p>
<p>A default Arch Linux installation will set most variables <i>systemd-firstboot</i> is able to manipulate, or facilitate the creation of skeleton files which prevent its use when installing the systemd package through pacstrap.
</p>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><i>systemd-firstboot</i> is part of and packaged with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span>.
</p>
<h2><span class="mw-headline" id="Usage_Example">Usage Example</span></h2>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Doing this on an existing Arch Linux instance may break your system. The following steps should only be used on new installations.</div>
<h3><span class="mw-headline" id="Interactively_configure_system_settings_during_boot_of_a_fresh_Arch_Linux_installation">Interactively configure system settings during boot of a fresh Arch Linux installation</span></h3>
<p>Allowing <i>systemd-firstboot</i> to manipulate a previously un-booted Arch Linux installation is particularly useful in situations where installation is undertaken by an individual other than the eventual end user, such as in the distribution of laptops with a pre-loaded install.
</p>
<p>The following steps should be appended to the end of the <a href="../en/Installation_guide.html#Configure_the_system" title="Installation guide">Configure the system section</a> of the <a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a>, before the target partitions are unmounted, thus taking place within the chroot of the new installation. Make sure all locales you want available have been generated, non-generated ones will not be offered as a possible setting.
</p>
<h4><span class="mw-headline" id="Delete_existing_settings">Delete existing settings</span></h4>
<p>If the following files are present, <i>systemd-firstboot</i> will not prompt for the setting they relate to.
</p>
<pre># rm /etc/{machine-id,localtime,hostname,shadow,locale.conf}
</pre>
<h4><span class="mw-headline" id="Modify_and_enable_systemd-firstboot.service">Modify and enable systemd-firstboot.service</span></h4>
<p>Use a <a href="../en/Systemd.html#Drop-in_files" class="mw-redirect" title="Drop-in file">drop-in file</a> in which <code>--prompt</code> makes <i>systemd-firstboot</i> query for all possible settings and  the <code>[Install]</code> section specifies where in the boot process the service is to be activated. 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/systemd-firstboot.service.d/install.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
ExecStart=
ExecStart=/usr/bin/systemd-firstboot --prompt

[Install]
WantedBy=sysinit.target</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">Enable</a> <code>systemd-firstboot.service</code>
</p>
<h4><span class="mw-headline" id="Finalize_installation">Finalize installation</span></h4>
<p>Continue installing as per the <a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a>. Unless more configuration is to be undertaken, exit the chroot, unmount the partitions and shut down. Upon the next boot, <i>systemd-firstboot</i> will execute. Presuming <b>no other changes to system configuration are made</b>, removing the files above and rebooting will trigger systemd-firstboot again, in case you wish to test whether the installation worked.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 1 systemd-firstboot"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-firstboot.1">systemd-firstboot(1)</a></span></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Installation_process.html" title="Category:Installation process">Installation process</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Systemd-firstboot&amp;oldid=764712">https://wiki.archlinux.org/index.php?title=Systemd-firstboot&amp;oldid=764712</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 21 January 2023, at 20:03.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
