<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>SSHFS - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-SSHFS rootpage-SSHFS skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Installation</div>
			</a>
			
				<button aria-controls="toc-Installation-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Installation subsection
				</button>
			
			<ul id="toc-Installation-sublist" class="sidebar-toc-list">
				<li id="toc-Mounting" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Mounting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.1</span>Mounting</div>
			</a>
			
			<ul id="toc-Mounting-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Unmounting" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Unmounting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.2</span>Unmounting</div>
			</a>
			
			<ul id="toc-Unmounting-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Options" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Options">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Options</div>
			</a>
			
			<ul id="toc-Options-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Chrooting" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Chrooting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Chrooting</div>
			</a>
			
			<ul id="toc-Chrooting-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Automounting" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Automounting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Automounting</div>
			</a>
			
				<button aria-controls="toc-Automounting-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Automounting subsection
				</button>
			
			<ul id="toc-Automounting-sublist" class="sidebar-toc-list">
				<li id="toc-On_demand" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#On_demand">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.1</span>On demand</div>
			</a>
			
			<ul id="toc-On_demand-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-On_boot" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#On_boot">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.2</span>On boot</div>
			</a>
			
			<ul id="toc-On_boot-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Secure_user_access" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Secure_user_access">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3</span>Secure user access</div>
			</a>
			
			<ul id="toc-Secure_user_access-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Troubleshooting" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Troubleshooting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>Troubleshooting</div>
			</a>
			
				<button aria-controls="toc-Troubleshooting-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Troubleshooting subsection
				</button>
			
			<ul id="toc-Troubleshooting-sublist" class="sidebar-toc-list">
				<li id="toc-Checklist" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Checklist">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.1</span>Checklist</div>
			</a>
			
			<ul id="toc-Checklist-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Connection_reset_by_peer" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Connection_reset_by_peer">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.2</span>Connection reset by peer</div>
			</a>
			
			<ul id="toc-Connection_reset_by_peer-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Remote_host_has_disconnected" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Remote_host_has_disconnected">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.3</span>Remote host has disconnected</div>
			</a>
			
			<ul id="toc-Remote_host_has_disconnected-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-fstab_mounting_issues" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#fstab_mounting_issues">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.4</span>fstab mounting issues</div>
			</a>
			
			<ul id="toc-fstab_mounting_issues-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Some_directories_are_empty" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Some_directories_are_empty">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.5</span>Some directories are empty</div>
			</a>
			
			<ul id="toc-Some_directories_are_empty-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Files_not_refreshed" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Files_not_refreshed">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.6</span>Files not refreshed</div>
			</a>
			
			<ul id="toc-Files_not_refreshed-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Limited_transfer_on_fast_network" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Limited_transfer_on_fast_network">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.7</span>Limited transfer on fast network</div>
			</a>
			
			<ul id="toc-Limited_transfer_on_fast_network-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-See_also" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#See_also">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/SSHFS.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="mw-list-item"><a href="../en/Talk:SSHFS.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/SSHFS.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=SSHFS&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=SSHFS&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/SSHFS.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=SSHFS&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=SSHFS&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Related articles</p>
<ul>
<li><a href="../en/SCP_and_SFTP.html" title="SCP and SFTP">SCP and SFTP</a></li>
<li><a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a></li>
<li><a href="../en/Pure-FTPd.html" title="Pure-FTPd">Pure-FTPd</a></li>
<li><a href="../en/Sftpman.html" title="Sftpman">sftpman</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://github.com/libfuse/sshfs">SSHFS</a> is a <a href="../en/FUSE.html" title="FUSE">FUSE</a>-based filesystem client for mounting remote directories over a <a href="../en/Secure_Shell.html" title="Secure Shell">Secure Shell</a> connection.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This project has been archived by its developers and is no longer developed. Alternatives include the mount feature of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rclone">rclone</a></span>.</div>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sshfs">sshfs</a></span> package.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>If you often need to mount sshfs filesystems you may be interested in using an sshfs helper, such as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/qsshfs/">qsshfs</a></span><sup><small>AUR</small></sup>, <a href="../en/Sftpman.html" title="Sftpman">sftpman</a>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/sshmnt/">sshmnt</a></span><sup><small>AUR</small></sup> or <a rel="nofollow" class="external text" href="https://github.com/lahwaacz/Scripts/blob/master/fmount.py">fmount.py</a>.</li>
<li>You may want to use <a href="../en/Google_Authenticator.html" title="Google Authenticator">Google Authenticator</a> or <a href="../en/SSH_keys.html#FIDO/U2F" title="SSH keys">Fido Tokens</a> providing additional security as in two-step authentication.</li>
<li>
<a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a> may be used over traditional password authentication.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Mounting">Mounting</span></h3>
<p>In order to be able to mount a directory the SSH user needs to be able to access it. Invoke <i>sshfs</i> to mount a remote directory:
</p>
<pre>$ sshfs <i>[user@]host:[dir] mountpoint [options]</i>
</pre>
<p>For example:
</p>
<pre>$ sshfs myuser@mycomputer:/remote/path /local/path -C -p 9876
</pre>
<p>Here <code>-p 9876</code> specifies the port number and <code>-C</code> enables compression. For more options see the <a href="#Options">#Options</a> section.
</p>
<p>When not specified, the remote path defaults to the remote user home directory. Default user names and options can be predefined on a host-by-host basis in <code>~/.ssh/config</code> to simplify the <i>sshfs</i> usage. For more information see <a href="../en/OpenSSH.html#Client_usage" title="OpenSSH">OpenSSH#Client usage</a>.
</p>
<p>SSH will ask for the password, if needed. If you do not want to type in the password multiple times a day, see <a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a>.
</p>
<h3><span class="mw-headline" id="Unmounting">Unmounting</span></h3>
<p>To unmount the remote system:
</p>
<pre>$ fusermount3 -u <i>mountpoint</i>
</pre>
<p>Example:
</p>
<pre>$ fusermount3 -u /local/path
</pre>
<h2><span class="mw-headline" id="Options">Options</span></h2>
<p><i>sshfs</i> can automatically convert between local and remote user IDs. Use the <code>idmap=user</code> option to translate the UID of the connecting user to the remote user <code>myuser</code> (GID remains unchanged):
</p>
<pre>$ sshfs <i>myuser</i>@<i>mycomputer</i>:<i>/remote/path /local/path</i> -o idmap=user
</pre>
<p>If you need more control over UID and GID translation, look at the options <code>idmap=file</code>, <code>uidfile</code> and <code>gidfile</code>.
</p>
<p>A complete list of options can be found in <span class="plainlinks archwiki-template-man" title="$ man 1 sshfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshfs.1">sshfs(1)</a></span>.
</p>
<h2><span class="mw-headline" id="Chrooting">Chrooting</span></h2>
<p>You may want to restrict a specific user to a specific directory on the remote system. This can be done by editing <code>/etc/ssh/sshd_config</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">.....
Match User <i>someuser</i> 
       ChrootDirectory <i>/chroot/%u</i>
       ForceCommand internal-sftp
       AllowTcpForwarding no
       X11Forwarding no
.....
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The chroot directory <b>must</b> be owned by root, otherwise you will not be able to connect.</div>
<p>See also <a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a>. For more information check the <span class="plainlinks archwiki-template-man" title="$ man 5 sshd_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd_config.5">sshd_config(5)</a></span> man page for <code>Match</code>, <code>ChrootDirectory</code> and <code>ForceCommand</code>.
</p>
<h2><span class="mw-headline" id="Automounting">Automounting</span></h2>
<p>Automounting can happen on boot, or on demand (when accessing the directory). For both, the setup happens in the <a href="../en/Fstab.html" title="Fstab">fstab</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Keep in mind that automounting is done through the root user, therefore you cannot use hosts configured in <code>.ssh/config</code> of your normal user.
<p>To let the root user use an SSH key of a normal user, specify its full path in the <code>IdentityFile</code> option.
</p>
<p><b>And most importantly</b>, use each sshfs mount at least once manually <b>while root</b> on the client machine so the host's signature is added to the client's <code>/root/.ssh/known_hosts</code> file. This can also be done manually by appending one or more of the the SSH server's public host keys (the <code>/etc/ssh/ssh_host_*key.pub</code> files) to <code>/root/.ssh/known_hosts</code>.
</p>
</div>
<h3><span class="mw-headline" id="On_demand">On demand</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Is there a way to make this work with a passphrase-protected private key? E.g. it prompts for the passphrase at first access. Alternatively, clearly state that it is not possible and why. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:SSHFS">Talk:SSHFS</a>)</div>
</div>
<p>With systemd on-demand mounting is possible using <code>/etc/fstab</code> entries.
</p>
<p>Example:
</p>
<pre><i>user</i>@<i>host</i>:<i>/remote/path /local/path</i>  fuse.sshfs noauto,x-systemd.automount,_netdev,users,idmap=user,IdentityFile=/home/<i>user</i>/.ssh/id_rsa,allow_other,reconnect 0 0
</pre>
<p>The important mount options here are <i>noauto,x-systemd.automount,_netdev</i>.
</p>
<ul>
<li>
<i>noauto</i> tells it not to mount at boot</li>
<li>
<i>x-systemd.automount</i> does the on-demand magic</li>
<li>
<i>_netdev</i> tells it that it is a network device, not a block device (without it "No such device" errors might happen)</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> After editing <code>/etc/fstab</code>, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Reload">reload</a> the systemd configuration and the required services, which can be found by running <code>systemctl list-unit-files --type automount</code>.</div>
<h3><span class="mw-headline" id="On_boot">On boot</span></h3>
<p>An example on how to use sshfs to mount a remote filesystem through <code>/etc/fstab</code>
</p>
<pre><i>user</i>@<i>host</i>:<i>/remote/path  /local/path</i>  fuse.sshfs  _netdev  0  0
</pre>
<p>Take for example the <i>fstab</i> line
</p>
<pre>llib@192.168.1.200:/home/llib/FAH  /media/FAH2  fuse.sshfs  _netdev  0  0
</pre>
<p>The above will work automatically if you are using an SSH key for the user. See <a href="../en/SSH_keys.html" class="mw-redirect" title="Using SSH Keys">Using SSH Keys</a>.
</p>
<p>If you want to use sshfs with multiple users, add the following option:
</p>
<pre>user@domain.org:/home/user  /media/user   fuse.sshfs    <b>allow_other</b>,_netdev    0  0
</pre>
<p>In order to ensure the network is available before trying to mount, it is not only important to set the <code>_netdev</code> mount option, but also to add either <code>--any</code> or a specific <code>--interface</code> to the appropriate <a href="../en/Systemd.html#Running_services_after_the_network_is_up" title="Systemd">wait-online service</a> for your network manager.
</p>
<h3><span class="mw-headline" id="Secure_user_access">Secure user access</span></h3>
<p>When automounting via <a href="../en/Fstab.html" title="Fstab">fstab</a>, the filesystem will generally be mounted by root. By default, this produces undesireable results if you wish access as an ordinary user and limit access to other users.
</p>
<p>An example mountpoint configuration:
</p>
<pre><i>user</i>@<i>host</i>:<i>/remote/path /local/path</i>  fuse.sshfs noauto,x-systemd.automount,_netdev,user,idmap=user,follow_symlinks,identityfile=/home/<i>user</i>/.ssh/id_rsa,allow_other,default_permissions,uid=USER_ID_N,gid=USER_GID_N 0 0
</pre>
<p>Summary of the relevant options:
</p>
<ul>
<li>
<i>allow_other</i> - Allow other users than the mounter (i.e. root) to access the share.</li>
<li>
<i>default_permissions</i> - Allow kernel to check permissions, i.e. use the actual permissions on the remote filesystem. This allows prohibiting access to everybody otherwise granted by <i>allow_other</i>.</li>
<li>
<i>uid</i>, <i>gid</i> - set reported ownership of files to given values; <i>uid</i> is the numeric user ID of your user, <i>gid</i> is the numeric group ID of your user.</li>
</ul>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Checklist">Checklist</span></h3>
<p>Read <a href="../en/OpenSSH.html#Checklist" title="OpenSSH">OpenSSH#Checklist</a> first. Further issues to check are:
</p>
<ol>
<li>Is your SSH login sending additional information from server's <code>/etc/issue</code> file e.g.? This might confuse SSHFS. You should temporarily deactivate server's <code>/etc/issue</code> file: <pre>$ mv /etc/issue /etc/issue.orig</pre>
</li>
<li>Keep in mind that most SSH related troubleshooting articles you will find on the web are <b>not</b> systemd related. Often <code>/etc/fstab</code> definitions wrongly begin with <pre><i>sshfs#</i>user@host:/mnt/server/directory ... fuse ...</pre> instead of using the syntax <pre>user@host:/mnt/server/directory ... fuse.<i>sshfs</i> ... <i>x-systemd</i>, ...</pre>
</li>
<li>Check that the owner of server's source directory and content is owned by the server's user. <pre>$ chown -R <i>user_s</i>: /mnt/servers/directory</pre>
</li>
<li>The server's user ID can be different from the client's one. Obviously both user names have to be the same. You just have to care for the client's user IDs. SSHFS will translate the UID for you with the following mount options:<pre>uid=<i>USER_C_ID</i>,gid=<i>GROUP_C_ID</i></pre>
</li>
<li>Check that the client's target mount point (directory) is owned by the client user. This directory should have the same user ID as defined in SSHFS's mount options.<pre>$ chown -R <i>user_c</i>: /mnt/client/directory</pre>
</li>
<li>Check that the client's mount point (directory) is empty. By default you cannot mount SSHFS directories to non-empty directories.</li>
</ol>
<h3><span class="mw-headline" id="Connection_reset_by_peer">Connection reset by peer</span></h3>
<ul>
<li>If you are trying to access the remote system with a hostname, try using its IP address, as it can be a domain name resolving issue. Make sure you edit <code>/etc/hosts</code> with the server details.</li>
<li>Make sure your user can log into the server (especially when using <code>AllowUsers</code>).</li>
<li>Make sure <code>Subsystem sftp /usr/lib/ssh/sftp-server</code> is enabled in <code>/etc/ssh/sshd_config</code> on the remote system.</li>
<li>If you are using a non-default key name and passing it as <code>-i .ssh/my_key</code>, this will not work. You have to use <code>-o IdentityFile=/home/<i>user</i>/.ssh/<i>my_key</i></code>, with the full path to the key.</li>
<li>If your <code>/root/.ssh/config/</code> is a symlink, you will be getting this error as well. See <a rel="nofollow" class="external text" href="https://serverfault.com/questions/507748/bad-owner-or-permissions-on-root-ssh-config">this serverfault topic</a>
</li>
<li>Adding the option <code>sshfs_debug</code> (as in <code>sshfs -o sshfs_debug <i>user</i>@<i>server</i> ...</code>) can help in resolving the issue.</li>
<li>If that does not reveal anything useful, you might also try adding the option <code>debug</code>.</li>
<li>If you are trying to sshfs into a router running DD-WRT or the like, there is a solution <a rel="nofollow" class="external text" href="https://www.dd-wrt.com/wiki/index.php/SFTP_with_DD-WRT">here</a>. (Note that the <code>-osftp_server=/opt/libexec/sftp-server</code> option can be used to the sshfs command instead of patching dropbear).</li>
<li>If you see this only on boot, it may be that systemd is attempting to mount prior to a network connection being available. Enabling the appropriate <a href="../en/Systemd.html#Running_services_after_the_network_is_up" title="Systemd">wait-online service</a> for your network manager fixes this.</li>
<li>Old Forum thread: <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=27613">sshfs: Connection reset by peer</a>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> When providing more than one option for sshfs, they must be comma separated. Like so: <code>sshfs -o sshfs_debug,IdentityFile=<i>/path/to/key</i> <i>user</i>@<i>server</i> ...</code>).</div>
<h3><span class="mw-headline" id="Remote_host_has_disconnected">Remote host has disconnected</span></h3>
<p>If you receive this message directly after attempting to use <i>sshfs</i>:
</p>
<ul>
<li>First make sure that the <b>remote</b> machine has <i>sftp</i> installed! It will not work, if not.</li>
<li>Then, check that the path of the <code>Subsystem sftp</code> in <code>/etc/ssh/sshd_config</code> on the remote machine is valid.</li>
</ul>
<h3><span class="mw-headline" id="fstab_mounting_issues">fstab mounting issues</span></h3>
<p>To get verbose debugging output, add the following to the mount options:
</p>
<pre>ssh_command=ssh\040-vv,sshfs_debug,debug
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Here, <code>\040</code> represents a space which fstab uses to separate fields.</div>
<p>To be able to run <code>mount -av</code> and see the debug output, remove the following:
</p>
<pre> noauto,x-systemd.automount
</pre>
<h3><span class="mw-headline" id="Some_directories_are_empty">Some directories are empty</span></h3>
<p>sshfs by default does not support symlinks. If those directories happened to be symlinks, use:
</p>
<pre>$ sshfs <i>user</i>@<i>host</i>:<i>/remote/path /local/path</i> -o follow_symlinks
</pre>
<h3><span class="mw-headline" id="Files_not_refreshed">Files not refreshed</span></h3>
<p>If you see old content on remote, consider using option <code>dir_cache=no</code>:
</p>
<pre>$ sshfs <i>user</i>@<i>host</i>:<i>/remote/path /local/path</i> -o dir_cache=no
</pre>
<h3><span class="mw-headline" id="Limited_transfer_on_fast_network">Limited transfer on fast network</span></h3>
<p>If you observe transfer than is lower than your network capabilities and high CPU usage on the party where files are copied from, disable compression (remove <code>-C</code> option or set <code>-o compression=no</code>).
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li>
<a rel="nofollow" class="external text" href="https://wiki.gilug.org/index.php/How_to_mount_SFTP_accesses">How to mount chrooted SSH filesystem</a>, with special care with owners and permissions questions.</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:FUSE.html" title="Category:FUSE">FUSE</a></li>
<li><a href="../en/Category:Secure_Shell.html" title="Category:Secure Shell">Secure Shell</a></li>
<li><a href="../en/Category:Network_sharing.html" title="Category:Network sharing">Network sharing</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=SSHFS&amp;oldid=782295">https://wiki.archlinux.org/index.php?title=SSHFS&amp;oldid=782295</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 1 July 2023, at 09:39.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
