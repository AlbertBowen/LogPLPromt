<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>doas - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Doas rootpage-Doas skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Installation</div>
			</a>
			
			<ul id="toc-Installation-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Usage" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Usage">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Usage</div>
			</a>
			
			<ul id="toc-Usage-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Configuration" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Configuration">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Configuration</div>
			</a>
			
			<ul id="toc-Configuration-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Tips_and_tricks" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Tips_and_tricks">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Tips and tricks</div>
			</a>
			
				<button aria-controls="toc-Tips_and_tricks-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Tips and tricks subsection
				</button>
			
			<ul id="toc-Tips_and_tricks-sublist" class="sidebar-toc-list">
				<li id="toc-doas_persist_feature" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#doas_persist_feature">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.1</span>doas persist feature</div>
			</a>
			
			<ul id="toc-doas_persist_feature-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Smooth_transition_sudo_to_doas" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Smooth_transition_sudo_to_doas">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.2</span>Smooth transition sudo to doas</div>
			</a>
			
			<ul id="toc-Smooth_transition_sudo_to_doas-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Bash_tab_completion" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Bash_tab_completion">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3</span>Bash tab completion</div>
			</a>
			
			<ul id="toc-Bash_tab_completion-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Doas.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Doas&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Doas.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Doas&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Doas&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Doas.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Doas&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Doas&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Related articles</p>
<ul>
<li><a href="../en/Users_and_groups.html" title="Users and groups">Users and groups</a></li>
<li><a href="../en/Sudo.html" title="Sudo">sudo</a></li>
<li><a href="../en/List_of_applications/Security.html#Privilege_elevation" title="List of applications/Security">List of applications/Security#Privilege elevation</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/doas" class="extiw" title="wikipedia:doas">OpenDoas</a> is a portable version of OpenBSD's doas command, known for being substantially smaller in size compared to <a href="../en/Sudo.html" title="Sudo">sudo</a>. Like <i>sudo</i>, <i>doas</i> is used to assume the identity of another user on the system.
</p>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=opendoas">opendoas</a></span> package.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>To begin using <i>doas</i> as a non-privileged user, it must be properly configured. See <a href="#Configuration">#Configuration</a>.
</p>
<p>To use <i>doas</i>, simply prefix a command and its arguments with <code>doas</code> and a space:
</p>
<pre>$ doas <i>cmd</i>
</pre>
<p>For example, to use <a href="../en/Pacman.html" title="Pacman">pacman</a>:
</p>
<pre>$ doas pacman -Syu
</pre>
<p>To get to an interactive shell with root prompt:
</p>
<pre>$ doas -s
</pre>
<p>For more information, see <span class="plainlinks archwiki-template-man" title="$ man 1 doas"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/doas.1">doas(1)</a></span>.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>After installing OpenDoas, it will be attached with <a href="../en/PAM.html" title="PAM">PAM</a>, but no default configuration or examples are included. 
</p>
<p>To allow members of group <a href="../en/Users_and_groups.html#Group_list" class="mw-redirect" title="Wheel">wheel</a> to run commands as other users, create a configuration file with the following content:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :wheel

</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>The configuration file must end with a newline.</li>
<li>The <code>setenv</code> option works around an <a rel="nofollow" class="external text" href="https://github.com/Duncaen/OpenDoas/issues/117">issue</a> arising from OpenDoas's BSD origin where additional system packages are stored under <code>/usr/local/bin</code>. In Linux <code>/usr/local/bin</code> is generally used to override executables so it comes before <code>/usr/bin</code> which contains executables from packages.</li>
</ul>
</div>
<p>The owner and group for <code>/etc/doas.conf</code> should both be <code>0</code>, file permissions should be set to <code>0400</code>:
</p>
<pre># chown -c root:root /etc/doas.conf
# chmod -c 0400 /etc/doas.conf
</pre>
<p>To check <code>/etc/doas.conf</code> for syntax errors, run:
</p>
<pre># doas -C /etc/doas.conf &amp;&amp; echo "config ok" || echo "config error" 
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> It is imperative that <code>/etc/doas.conf</code> is free of syntax errors!</div>
<p>To allow members of the <code>plugdev</code> group to run <a href="../en/S.M.A.R.T..html#smartctl" class="mw-redirect" title="Smartctl">smartctl</a> without password as <a href="../en/Users_and_groups.html#Overview" class="mw-redirect" title="Root user">Root user</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit nopass :plugdev as root cmd /usr/bin/smartctl
</pre>
<p>The general syntax form of <code>/etc/doas.conf</code> is:
</p>
<pre>permit|deny [options] identity [as target] [cmd command [args ...]]
</pre>
<p>For more details please read <span class="plainlinks archwiki-template-man" title="$ man 5 doas.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/doas.conf.5">doas.conf(5)</a></span>.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="doas_persist_feature">doas persist feature</span></h3>
<p><i>doas</i> provides a persist feature: after the user successfully authenticates, they will not be prompted for a password again for some time. It is disabled by default, enable it with the <code>persist</code> option:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit persist :wheel
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The persist feature is disabled by default and because it is new and potentially dangerous. In the original <i>doas</i>, a kernel API is used to set and clear timeouts. This API is OpenBSD specific and no similar API is available on other operating systems. As a workaround, the persist feature is implemented using timestamp files similar to <i>sudo</i>.</div>
<h3><span class="mw-headline" id="Smooth_transition_sudo_to_doas">Smooth transition sudo to doas</span></h3>
<p>For a smooth transition from <i>sudo</i> to <i>doas</i> and to stay downward compatible, you could add to your environment:
</p>
<pre>alias sudo='doas'
alias sudoedit='doas rnano'
</pre>
<p>Or alternatively, symlink <i>doas</i> to where <i>sudo</i> would normally be (but it does not provide <code>sudoedit</code> command):
</p>
<pre># ln -s $(which doas) /usr/bin/sudo
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> By default <i>sudo</i> preserves some environment variables while <i>doas</i> does not, most notably XAUTHORITY, LANG and LC_ALL. This means you will not be able to start graphical applications under X nor to access the user's locale without further configuration. For instance, to allow members of the <i>wheel</i> group to run graphical applications and to access the user's locale using the setenv option:
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit setenv { XAUTHORITY LANG LC_ALL } :wheel
</pre>
</div>
<h3><span class="mw-headline" id="Bash_tab_completion">Bash tab completion</span></h3>
<p>By default Bash will only tab complete files and directories within the current or referenced directory. To tell Bash to complete arguments as if they were separate commands (also leveraging the tab completion settings of other commands) the following can be added to either the users <code>.bashrc</code>, or the global <code>/etc/bash.bashrc</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.bashrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">complete -cf doas
</pre>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Security.html" title="Category:Security">Security</a></li>
<li><a href="../en/Category:Commands.html" title="Category:Commands">Commands</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Doas&amp;oldid=780499">https://wiki.archlinux.org/index.php?title=Doas&amp;oldid=780499</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 6 June 2023, at 17:31.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
