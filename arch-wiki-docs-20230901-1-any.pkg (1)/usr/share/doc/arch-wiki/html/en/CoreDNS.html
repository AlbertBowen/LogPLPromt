<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>CoreDNS - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-CoreDNS rootpage-CoreDNS skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Installation</div>
			</a>
			
			<ul id="toc-Installation-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Configuration" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Configuration">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Configuration</div>
			</a>
			
				<button aria-controls="toc-Configuration-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Configuration subsection
				</button>
			
			<ul id="toc-Configuration-sublist" class="sidebar-toc-list">
				<li id="toc-NextDNS_as_upstream_resolver" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#NextDNS_as_upstream_resolver">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>NextDNS as upstream resolver</div>
			</a>
			
			<ul id="toc-NextDNS_as_upstream_resolver-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Example_Configuration" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Example_Configuration">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Example Configuration</div>
			</a>
			
			<ul id="toc-Example_Configuration-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-See_also" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#See_also">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/CoreDNS.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:CoreDNS&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/CoreDNS.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=CoreDNS&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=CoreDNS&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/CoreDNS.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=CoreDNS&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=CoreDNS&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Related articles</p>
<ul>
<li><a href="../en/Domain_name_resolution.html" title="Domain name resolution">Domain name resolution</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://coredns.io/">CoreDNS</a> is a DNS server/forwarder, written in Go, that chains plugins. Each plugin performs a (DNS) function.
</p>
<p>CoreDNS is a fast and flexible DNS server. The key word here is flexible: with CoreDNS you are able to do what you want with your DNS data by utilizing plugins. If some functionality is not provided out of the box you can add it by writing a plugin.
</p>
<p>CoreDNS can listen for DNS requests coming in over UDP/TCP (go'old DNS), TLS (<a href="https://tools.ietf.org/html/rfc7858" class="extiw" title="rfc:7858">RFC:7858</a>), also called DoT, DNS over HTTP/2 - DoH - (<a href="https://tools.ietf.org/html/rfc8484" class="extiw" title="rfc:8484">RFC:8484</a>)
</p>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns/">coredns</a></span><sup><small>AUR</small></sup>, or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns-bin/">coredns-bin</a></span><sup><small>AUR</small></sup>, or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns-git/">coredns-git</a></span><sup><small>AUR</small></sup> package.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Currently only <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns-git/">coredns-git</a></span><sup><small>AUR</small></sup> provides an example configuration file.  You can find that here: <a rel="nofollow" class="external text" href="https://aur.archlinux.org/cgit/aur.git/tree/corefile.example?h=coredns-git">Example CoreDNS configuration file</a>
</p>
<p>systemd will look in <code>/etc/coredns/Corefile</code>, save the above configuration file in that location.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">Start/enable</a> <code>coredns.service</code>.
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 1 coredns"><a rel="nofollow" class="external text" href="https://coredns.io/manual/toc/">coredns(1)</a></span></li></ul>
<p>With the example configuration CoreDNS will start on port 1053.  You can use the <code>drill</code> command to verify to use CoreDNS is working:  <code>drill archlinux.org @127.0.0.1 -p 1053</code>
</p>
<h3><span class="mw-headline" id="NextDNS_as_upstream_resolver">NextDNS as upstream resolver</span></h3>
<p>If you would like to encrypt your recursive requests, edit the Corefile and remove lines 6 through 12 in the example configuration. 
<code>forward . tls://45.90.28.0 tls://45.90.30.0 { tls_servername dns.nextdns.io </code>}
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-forward"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/forward/">coredns-forward(7)</a></span></li></ul>
<p>You can use any dns53 or DoT resolver in the forward. as the local resolver, edit <code>/etc/coredns/Corefile</code> and change <code>.:1053</code> to <code>.:53</code> you can then configure <code>127.0.0.1</code> as your nameserver (see see <a href="../en/Domain_name_resolution.html" title="Domain name resolution">Domain name resolution</a>). <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>coredns.service</code> after that.
</p>
<p>Run <code>journalctl -u coredns</code> as root to verify things are working by default. The resolver will now listen on port <code>53</code>. If the resolver should be accessible from other hosts, configure other network interfaces in <code>/etc/coredns/Corefile</code> with <code>bind</code>. Also the <code>acl</code> plugin can be used to block ranges that should be use the server for recursion. Refer to <a rel="nofollow" class="external text" href="https://coredns.io/plugins/">CoreDNS plugin documentation</a> for more information.
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-bind"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/bind/">coredns-bind(7)</a></span></li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Unless you specifically want to run an open DNS resolver, do not configure the resolver to listen on a public (internet-facing) IP address.</div>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-acl"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/acl/">coredns-acl(7)</a></span></li></ul>
<p>If the resolver should respect entries from the <code>/etc/hosts</code> file, add a <code>hosts</code> line to <code>/etc/coredns/Corefile</code>.
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-hosts"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/hosts/">coredns-hosts(7)</a></span></li></ul>
<h2><span class="mw-headline" id="Example_Configuration">Example Configuration</span></h2>
<p>This is a configuration with useful plugins:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/coredns/Corefile</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">.:53 {
       bind 127.0.53.1 192.168.1.254 192.0.0.1 
       bufsize 1232 
       acl { 
               allow net 192.168.0.0/16 172.16.0.0/12 10.0.0.0/8 192.0.0.0/24
               block
       }
       hosts { 
               reload 0
               fallthrough
       }
       loadbalance
       forward . tls://45.90.28.0 tls://45.90.30.0 {
               tls_servername dns.nextdns.io
       }
       cache {
               success 4096
               denial  1024
               prefetch 512
       }
       prometheus :9153
       errors
       log
}</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><span class="plainlinks archwiki-template-man" title="$ man 1 coredns"><a rel="nofollow" class="external text" href="https://coredns.io/manual/toc/">coredns(1)</a></span></li>
<li><a rel="nofollow" class="external text" href="https://coredns.io/manual/toc/">CoreDNS manual</a></li>
<li><a rel="nofollow" class="external text" href="https://coredns.io/plugins/">CoreDNS plugins</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/coredns/coredns">CoreDNS github</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Domain_Name_System.html" title="Category:Domain Name System">Domain Name System</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=CoreDNS&amp;oldid=740304">https://wiki.archlinux.org/index.php?title=CoreDNS&amp;oldid=740304</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 6 August 2022, at 11:05.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
