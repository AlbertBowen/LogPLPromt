<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Tillitis TKey - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Tillitis_TKey rootpage-Tillitis_TKey skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-First_usage" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#First_usage">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>First usage</div>
			</a>
			
				<button aria-controls="toc-First_usage-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle First usage subsection
				</button>
			
			<ul id="toc-First_usage-sublist" class="sidebar-toc-list">
				<li id="toc-Verification_with_tkey-verification" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Verification_with_tkey-verification">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.1</span>Verification with tkey-verification</div>
			</a>
			
			<ul id="toc-Verification_with_tkey-verification-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Applications" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Applications">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Applications</div>
			</a>
			
				<button aria-controls="toc-Applications-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Applications subsection
				</button>
			
			<ul id="toc-Applications-sublist" class="sidebar-toc-list">
				<li id="toc-tkey-ssh-agent" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#tkey-ssh-agent">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>tkey-ssh-agent</div>
			</a>
			
			<ul id="toc-tkey-ssh-agent-sublist" class="sidebar-toc-list">
				<li id="toc-Use_both_tkey-ssh-agent_and_ssh-agent" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Use_both_tkey-ssh-agent_and_ssh-agent">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1.1</span>Use both tkey-ssh-agent and ssh-agent</div>
			</a>
			
			<ul id="toc-Use_both_tkey-ssh-agent_and_ssh-agent-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Tillitis_TKey.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Tillitis_TKey&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Tillitis_TKey.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Tillitis_TKey&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Tillitis_TKey&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Tillitis_TKey.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Tillitis_TKey&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Tillitis_TKey&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Related articles</p>
<ul>
<li><a href="../en/Universal_2nd_Factor.html" title="Universal 2nd Factor">Universal 2nd Factor</a></li>
</ul>
</div>
<p>The <a rel="nofollow" class="external text" href="https://www.tillitis.se/tkey/">TKey</a> is an <a href="https://en.wikipedia.org/wiki/Open-source_hardware" class="extiw" title="wikipedia:Open-source hardware">Open-source hardware</a> and open source software <a href="https://en.wikipedia.org/wiki/Security_token" class="extiw" title="wikipedia:Security token">USB security key</a> that can support use cases such as <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a> login, Ed25519 <a href="https://en.wikipedia.org/wiki/Digital_signature" class="extiw" title="wikipedia:Digital signature">digital signing</a>, Root of Trust, <a href="https://en.wikipedia.org/wiki/FIDO2_Project" class="extiw" title="wikipedia:FIDO2 Project">FIDO2</a>, and more.
The software, and board designs, FPGA verilog and firmware for the TKey are released by <a rel="nofollow" class="external text" href="https://github.com/tillitis">Tillitis</a>.
</p>
<p>The <a href="https://en.wikipedia.org/wiki/Threat_model" class="extiw" title="wikipedia:Threat model">threat model</a>, such as assumptions on trust and attack vectors, for the TKey is <a rel="nofollow" class="external text" href="https://www.tillitis.se/tkey/threat-model/">specified by Tillitis</a>.
</p>
<p>As the TKey has no persistent storage its output are calculated from any input and a unique device secret (UDS), see <a rel="nofollow" class="external text" href="https://dev.tillitis.se/intro/">Tillitis TKey Developer Handbook</a>.
Every time the TKey is plugged into the computer a device app has to be loaded onto it.
When the device app is loaded, the TKey calculates a Compound Device Identifier (CDI) based on a hash of the device app binary code, the UDS and possibly a User Supplied Secret (USS). The CDI is then available for use by the device app, for example to derive a private key from.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> If the code of the device app changes, also the CDI will change. This cuts your access to any account for which you used the TKey with this particular device app. For example, if you use TKey for <a href="../en/Secure_Shell.html" class="mw-redirect" title="Ssh">ssh</a> with tkey-ssh-agent version 41 and you upgrade to tkey-ssh-agent version 42 (in which the device app changed) you end up locked out of your ssh accounts. The package version should be <a href="../en/System_maintenance.html#Backup" title="System maintenance">backed-up</a> and prevented from upgrades, see <a href="../en/Pacman.html#Skip_package_from_being_upgraded" title="Pacman">Pacman#Skip package from being upgraded</a>.</div>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="First_usage">First usage</span></h2>
<p>The TKey identifies with the device signature: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ lsusb | grep Tillitis</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Bus 008 Device 001: ID 1207:8887 Tillitis MTA1-USB-V1
</pre>
<p>and is accessible at a serial port like <code>/dev/ttyACM0</code>.
To use the TKey, add yourself to the <code>uucp</code> <a href="../en/Users_and_groups.html#Group_management" class="mw-redirect" title="User group">user group</a>.
</p>
<p>It is preferred to use a <a href="../en/Udev.html" title="Udev">udev</a> rule for the vendor <code>1207</code> and the product <code>8887</code> instead that makes the device <a href="../en/Udev.html#Allowing_regular_users_to_use_devices" title="Udev">writable for a user</a>.
</p>
<h3><span class="mw-headline" id="Verification_with_tkey-verification">Verification with tkey-verification</span></h3>
<p>To test if the device is properly set-up, it is recommended to run the 
vendor provided <a rel="nofollow" class="external text" href="https://github.com/tillitis/tkey-verification/">tkey-verification</a> program, packaged in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/tkey-verification-bin/">tkey-verification-bin</a></span><sup><small>AUR</small></sup>.
Apart from a functionality check of the TKey, the software also verifies that the TKey contains the same firmware as at the time of production so the firmware on the TKey has not been altered.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ tkey-verification verify</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
TKey is genuine!
</pre>
<h2><span class="mw-headline" id="Applications">Applications</span></h2>
<p>This section describes usage of some available tools.
</p>
<h3><span class="mw-headline" id="tkey-ssh-agent">tkey-ssh-agent</span></h3>
<p>The TKey may authenticate SSH agent requests with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/tkey-ssh-agent/">tkey-ssh-agent</a></span><sup><small>AUR</small></sup>. To print its public <a href="../en/Secure_Shell.html" class="mw-redirect" title="Ssh">ssh</a> key:
</p>
<pre>$ tkey-ssh-agent --show-pubkey
</pre>
<p>An additional user supplied secret (USS) can be provided either with <code>--uss</code> (requiring a <a href="../en/GnuPG.html#pinentry" class="mw-redirect" title="Pinentry">pinentry</a> program) or with <code>--uss-file</code> command-line arguments to <i>tkey-ssh-agent</i>.
The USS determines the ssh public key, that means providing a different USS will output a different key.
If, for instance, the USS that was used to generate a public ssh key is <code>--uss "<i>arch, btw</i>"</code>, this USS shall be typed into the pinentry prompt when authenticating to the server that uses this public key.
</p>
<p>To start the ssh agent:
</p>
<pre>$ tkey-ssh-agent --agent-socket $XDG_RUNTIME_DIR/tkey_ssh_agent.sock
</pre>
<h4><span class="mw-headline" id="Use_both_tkey-ssh-agent_and_ssh-agent">Use both tkey-ssh-agent and ssh-agent</span></h4>
<p>Openssh can be configured (see <span class="plainlinks archwiki-template-man" title="$ man 5 ssh_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh_config.5">ssh_config(5)</a></span>) to authenticate only some connections with <code>tkey-ssh-agent</code> and default to <code>ssh-agent</code> for other ssh connections.
To use the TKey to authenticate a connection to a certain host set the ssh configuration option <code>IdentityAgent</code> to the socket path of the tkey-ssh-agent:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.ssh/config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Host aur.archlinux.org
  User aur
  IdentityAgent /run/user/<i>1000</i>/tkey-ssh-agent/sock
</pre>
<p>The above example would ask to authenticate to <code>aur.archlinux.org</code> with the TKey, assuming its <code>--agent-socket</code> is the above configured <code>IdentityAgent</code> path.
</p>
<p>If <code>tkey-ssh-agent</code> is <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Started">started</a>/managed with the <code>tkey-ssh-agent.service</code> (provided as part of the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/tkey-ssh-agent/">tkey-ssh-agent</a></span><sup><small>AUR</small></sup> package) as a <a href="../en/Systemd/User.html" title="Systemd/User">Systemd/User</a> unit, then the socket path is the value of <code>$XDG_RUNTIME_DIR/tkey-ssh-agent/sock</code>.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Universal_2nd_Factor.html" title="Category:Universal 2nd Factor">Universal 2nd Factor</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Tillitis_TKey&amp;oldid=776121">https://wiki.archlinux.org/index.php?title=Tillitis_TKey&amp;oldid=776121</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 22 April 2023, at 19:56.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
