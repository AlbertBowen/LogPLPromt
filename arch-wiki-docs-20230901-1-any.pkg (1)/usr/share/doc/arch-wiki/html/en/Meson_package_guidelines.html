<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Meson package guidelines - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Meson_package_guidelines rootpage-Meson_package_guidelines skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Usage" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Usage">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Usage</div>
			</a>
			
				<button aria-controls="toc-Usage-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Usage subsection
				</button>
			
			<ul id="toc-Usage-sublist" class="sidebar-toc-list">
				<li id="toc-Requirements" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Requirements">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.1</span>Requirements</div>
			</a>
			
			<ul id="toc-Requirements-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-prepare()" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#prepare()">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.2</span>prepare()</div>
			</a>
			
			<ul id="toc-prepare()-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-build()" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#build()">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.3</span>build()</div>
			</a>
			
			<ul id="toc-build()-sublist" class="sidebar-toc-list">
				<li id="toc-Using_meson_binary_directly" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Using_meson_binary_directly">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.3.1</span>Using meson binary directly</div>
			</a>
			
			<ul id="toc-Using_meson_binary_directly-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Using_arch-meson_wrapper_script" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Using_arch-meson_wrapper_script">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.3.2</span>Using arch-meson wrapper script</div>
			</a>
			
			<ul id="toc-Using_arch-meson_wrapper_script-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Setting_software-specific_build_options" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Setting_software-specific_build_options">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.3.3</span>Setting software-specific build options</div>
			</a>
			
			<ul id="toc-Setting_software-specific_build_options-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-check()" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#check()">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.4</span>check()</div>
			</a>
			
			<ul id="toc-check()-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-package()" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#package()">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.5</span>package()</div>
			</a>
			
			<ul id="toc-package()-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Troubleshooting" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Troubleshooting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Troubleshooting</div>
			</a>
			
				<button aria-controls="toc-Troubleshooting-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Troubleshooting subsection
				</button>
			
			<ul id="toc-Troubleshooting-sublist" class="sidebar-toc-list">
				<li id="toc-ERROR:_Function_does_not_take_positional_arguments" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#ERROR:_Function_does_not_take_positional_arguments">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>ERROR: Function does not take positional arguments</div>
			</a>
			
			<ul id="toc-ERROR:_Function_does_not_take_positional_arguments-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Template" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Template">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Template</div>
			</a>
			
			<ul id="toc-Template-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Example_packages" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Example_packages">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Example packages</div>
			</a>
			
			<ul id="toc-Example_packages-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-See_also" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#See_also">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Meson_package_guidelines.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Meson_package_guidelines&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Meson_package_guidelines.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Meson_package_guidelines&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Meson_package_guidelines&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Meson_package_guidelines.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Meson_package_guidelines&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Meson_package_guidelines&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="toc" style="display:block; text-align: center; margin-bottom: 1em;">
<b><a href="../en/Arch_package_guidelines.html" title="Arch package guidelines">Arch package guidelines</a></b>
<hr>
<p><a href="../en/32-bit_package_guidelines.html" title="32-bit package guidelines">32-bit</a> – <a href="../en/CLR_package_guidelines.html" title="CLR package guidelines">CLR</a> – <a href="../en/CMake_package_guidelines.html" title="CMake package guidelines">CMake</a> – <a href="../en/Cross-compiling_tools_package_guidelines.html" title="Cross-compiling tools package guidelines">Cross</a> – <a href="../en/DKMS_package_guidelines.html" title="DKMS package guidelines">DKMS</a> – <a href="../en/Eclipse_plugin_package_guidelines.html" title="Eclipse plugin package guidelines">Eclipse</a> – <a href="../en/Electron_package_guidelines.html" title="Electron package guidelines">Electron</a> – <a href="../en/Font_package_guidelines.html" title="Font package guidelines">Font</a> – <a href="../en/Free_Pascal_package_guidelines.html" title="Free Pascal package guidelines">Free Pascal</a> – <a href="../en/GNOME_package_guidelines.html" title="GNOME package guidelines">GNOME</a> – <a href="../en/Go_package_guidelines.html" title="Go package guidelines">Go</a> – <a href="../en/Haskell_package_guidelines.html" title="Haskell package guidelines">Haskell</a> – <a href="../en/Java_package_guidelines.html" title="Java package guidelines">Java</a> – <a href="../en/KDE_package_guidelines.html" title="KDE package guidelines">KDE</a> – <a href="../en/Kernel_module_package_guidelines.html" title="Kernel module package guidelines">Kernel</a> – <a href="../en/Lisp_package_guidelines.html" title="Lisp package guidelines">Lisp</a> – <a class="mw-selflink selflink">Meson</a> – <a href="../en/MinGW_package_guidelines.html" title="MinGW package guidelines">MinGW</a> – <a href="../en/Node.js_package_guidelines.html" title="Node.js package guidelines">Node.js</a> – <a href="../en/Nonfree_applications_package_guidelines.html" title="Nonfree applications package guidelines">Nonfree</a> – <a href="../en/OCaml_package_guidelines.html" title="OCaml package guidelines">OCaml</a> – <a href="../en/Perl_package_guidelines.html" title="Perl package guidelines">Perl</a> – <a href="../en/PHP_package_guidelines.html" title="PHP package guidelines">PHP</a> – <a href="../en/Python_package_guidelines.html" title="Python package guidelines">Python</a> – <a href="../en/R_package_guidelines.html" title="R package guidelines">R</a> – <a href="../en/Ruby_package_guidelines.html" title="Ruby package guidelines">Ruby</a> – <a href="../en/Rust_package_guidelines.html" title="Rust package guidelines">Rust</a> – <a href="../en/Shell_package_guidelines.html" title="Shell package guidelines">Shell</a> – <a href="../en/VCS_package_guidelines.html" title="VCS package guidelines">VCS</a> – <a href="../en/Web_application_package_guidelines.html" title="Web application package guidelines">Web</a> – <a href="../en/Wine_package_guidelines.html" title="Wine package guidelines">Wine</a>
</p>
</div>
<p>From <a rel="nofollow" class="external text" href="https://mesonbuild.com/">Meson's official website</a>:
</p>
<dl><dd>Meson is an open source build system meant to be both extremely fast, and, even more importantly, as user friendly as possible.</dd></dl>
<p>Written in Python, Meson features multi-platform support, support several programming languages, cross compilation, and more.
</p>
<p>Meson does not build software directly, but rather sets up a back-end build system. While it is commonly used with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ninja">ninja</a></span>, other build systems can be used. It is commonly used to replace <a href="../en/GNU.html#Build_system" class="mw-redirect" title="GNU Build System">GNU Build System</a>.
</p>
<p>This document covers standards and guidelines on writing <a href="../en/PKGBUILD.html" title="PKGBUILD">PKGBUILDs</a> for software that uses <a rel="nofollow" class="external text" href="https://mesonbuild.com/">Meson</a>.
</p>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<h3><span class="mw-headline" id="Requirements">Requirements</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=meson">meson</a></span> has to be included to the <a href="../en/PKGBUILD.html" title="PKGBUILD">PKGBUILD</a>'s <a href="../en/PKGBUILD.html#makedepends" class="mw-redirect" title="Makedepends">makedepends</a> array.
</p>
<h3>
<span id="prepare.28.29"></span><span class="mw-headline" id="prepare()">prepare()</span>
</h3>
<p>Meson includes an utility to manage subprojects, able to download all subprojects ahead of time.
Running this in the prepare() stage enables the later build() and other stages to be run entirely offline.
</p>
<p>Example:
</p>
<pre>prepare() {
  meson subprojects download --sourcedir=<i>source</i>
}
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This step is not required if the project doesn't include downloadable subprojects or when they are only provided as a fallback to a system library.</div>
<h3>
<span id="build.28.29"></span><span class="mw-headline" id="build()">build()</span>
</h3>
<p>Configuring and building is normally done <a href="#Using_meson_binary_directly">using <i>meson</i> binary</a>, but it can also be done by <a href="#Using_arch-meson_wrapper_script">using Arch Linux's <i>arch-meson</i> wrapper script</a>.
</p>
<p>Both <i>meson</i> and <i>arch-meson</i> commands include in the usage syntax <b>options</b>, <b>source directory</b> and <b>build directory</b>:
</p>
<ul>
<li>
<b>options</b>: must include at least <code>--prefix /usr</code>, but make sure to check other options with <code>meson setup --help</code>; also check <a href="#Setting_software-specific_build_options">software-specific build options</a>.</li>
<li>
<b>source directory</b> (or "sourcedir"): where the software's source code is stored, e.g. <code>.</code>, <code>$pkgname</code> or <code>$pkgname-$pkgver</code>.</li>
<li>
<b>build directory</b> (or "builddir"): where the build files will stored by Meson; commonly named <code>build</code> or <code>_build</code>, but it is discretionary.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It does not matter if source directory is passed to <i>meson</i> before the build directory, and vice-versa, as Meson will know which is which and will set up the environment properly.</div>
<h4><span class="mw-headline" id="Using_meson_binary_directly">Using meson binary directly</span></h4>
<p>This method uses <code>meson setup</code>, which is the similar to the <code>./configure</code> command used by the <a href="../en/GNU.html#Build_system" class="mw-redirect" title="GNU Build System">GNU Build System</a>.
</p>
<p>The <code>--prefix=/usr</code> command-line flag must always be passed to <code>meson setup</code> because Arch Linux packages must not install files to <code>/usr/local</code>, according <a href="../en/Arch_package_guidelines.html#Package_etiquette" title="Arch package guidelines">Arch package guidelines#Package etiquette</a>. The <code>--buildtype=plain</code> built-in option can be set to another value, if you know what you are doing.
</p>
<p>Example:
</p>
<pre>build() {
  meson setup --prefix=/usr --buildtype=plain <i>source</i> <i>build</i>
  meson compile -C <i>build</i>
}
</pre>
<p><code>meson compile</code> is a wrapper for supported back-end build systems, which currently defaults to <i>ninja</i><a rel="nofollow" class="external autonumber" href="https://github.com/mesonbuild/meson/blob/master/mesonbuild/mcompile.py">[1]</a>
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <code>ninja -C <i>build</i></code> could be directly used instead.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  Using <code>meson ...</code> (without commands) currently defaults to <code>meson setup ...</code>, however since Meson 0.64 it raises the warning: <code>Running the setup command as meson [options] instead of meson setup [options] is ambiguous and deprecated</code>.</div>
<h4><span class="mw-headline" id="Using_arch-meson_wrapper_script">Using arch-meson wrapper script</span></h4>
<p><i>arch-meson</i> is a wrapper script included in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=meson">meson</a></span> package which has the advantage of setting some of Meson built-in options that would probably be used in an Arch package, saving packager's time and code in the PKGBUILD. Quoting the description written in <i>arch-meson</i>, it is a "Highly opinionated wrapper for Arch Linux packaging".
</p>
<p>Example:
</p>
<pre>build() {
  arch-meson <i>source</i> <i>build</i>
  meson compile -C <i>build</i>
}
</pre>
<h4><span class="mw-headline" id="Setting_software-specific_build_options">Setting software-specific build options</span></h4>
<p>While Meson has some <a rel="nofollow" class="external text" href="https://mesonbuild.com/Builtin-options.html">built-in build options</a> (e.g. <code>--prefix</code>), the software being packaged could have other <a rel="nofollow" class="external text" href="https://mesonbuild.com/Build-options.html">build options</a> which the packager should consider. Valid software-specific build options are normally found in a file named <code>meson_options.txt</code> (if present) and in <code>meson.build</code>. Look for <code>option(<i>settings</i>)</code> in these files, then read the <code><i>settings</i></code>.
</p>
<p>To use a software-specific build option, use the notation <code>-D <i>key</i>=<i>value</i></code>, where <code><i>key</i></code> is the build option name set in the project and <code><i>value</i></code> is a valid value, like e.g. <code>true</code>.
</p>
<p>For instance, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gtranslator">gtranslator</a></span> has the following build options:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">meson_options.txt</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">option('gtk_doc', type: 'boolean', value: false, description: 'use gtk-doc to build documentation')
</pre>
<p>So, to build its documentation, one must run Meson appending <code>-D gtk_doc=true</code> build option, resulting in a command line like e.g.
</p>
<pre>arch-meson $pkgname-$pkgver build -Dgtk_doc=true
</pre>
<h3>
<span id="check.28.29"></span><span class="mw-headline" id="check()">check()</span>
</h3>
<p>If the software being packaged provides test suite, consider running it in the PKGBUILD's <a href="../en/Creating_packages.html#check()" title="Creating packages">check()</a> function. This can be accomplished with <code>meson test</code> command.
</p>
<p>Example:
</p>
<pre>check() {
  meson test -C <i>build</i>
}
</pre>
<p>where <code><i>build</i></code> is the same build directory name used in the above <a href="#build()">#build()</a> step.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>
<code>ninja test -C <i>build</i></code> could be directly used instead.</li>
<li>The <code>--print-errorlogs</code> parameter can be added to <code>meson test</code> in order to report the output produced by the failing tests along with other useful information as the environmental variables.</li>
</ul>
</div>
<p>See <code>meson test --help</code> and <a rel="nofollow" class="external text" href="https://mesonbuild.com/Unit-tests.html">Unit tests in Meson docs</a> for more info.
</p>
<h3>
<span id="package.28.29"></span><span class="mw-headline" id="package()">package()</span>
</h3>
<p>Packaging normally requires running only <code>meson install</code>, but check if another installation command is required (e.g. an <a href="../en/PKGBUILD.html#license" title="PKGBUILD">uncommon license</a>). Use the same build directory as above and set the <code>--destdir</code> flag:
</p>
<pre>package() {
  meson install -C <i>build</i> --destdir "$pkgdir"
}
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Appending <code>DESTDIR="$pkgdir"</code> is also a valid alternative to <code>--destdir</code>.<a rel="nofollow" class="external autonumber" href="https://mesonbuild.com/Release-notes-for-0-57-0.html#specify-destdir-on-command-line">[2]</a>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <code>ninja install -C <i>build</i></code> could be directly used instead.</div>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="ERROR:_Function_does_not_take_positional_arguments">ERROR: Function does not take positional arguments</span></h3>
<p>Example of error output:
</p>
<pre> data/meson.build:21:5: ERROR: Function does not take positional arguments.
</pre>
<p>Error present since Meson 0.60, which promoted from warning to error the use of positional arguments. One very common example of this error is to add invalid arguments to i18n.merge_file(). For instance, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=aisleriot">aisleriot</a></span> had:
</p>
<pre>i18n.merge_file(
  'sol.metainfo.xml',
  input: desktop_in,
  output: '@BASENAME@',
  type: 'desktop',
  po_dir: po_dir,
  install: true,
  install_dir: desktopdatadir,
)
</pre>
<p>where <code>'sol.metainfo.xml'</code> is the now invalid argument that should be removed. For the fix applied in the upstream, see <a rel="nofollow" class="external text" href="https://gitlab.gnome.org/GNOME/aisleriot/-/commit/4bf6fcf5c8043adfcadd948e678cc68f150cc998">this commit</a>.
</p>
<p>Measures to be taken in this case:
</p>
<ol>
<li>Patch the meson.build reported in the error to fix the build, and the publish the updated PKGBUILD (if that is case)</li>
<li>Contribute to the upstream repository with your patch, to fix it for everyone and to avoid having patches in the source array in the next versions.</li>
</ol>
<h2><span class="mw-headline" id="Template">Template</span></h2>
<p>To sum up the above instructions and to provide a single copy-and-paste point, see the template below:
</p>
<pre>makedepends=(meson)

build() {
  arch-meson $pkgname-$pkgver build
  meson compile -C build
}

check() {
  meson test -C build --print-errorlogs
}

package() {
  meson install -C build --destdir "$pkgdir"
}</pre>
<h2><span class="mw-headline" id="Example_packages">Example packages</span></h2>
<p>This is a small list of packages that use Meson. See other packages in the list "Required by" in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=meson">meson</a></span> package's page.
</p>
<ul>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gstreamer">gstreamer</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-desktop">gnome-desktop</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=switchboard">switchboard</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cinnamon-desktop">cinnamon-desktop</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=networkmanager">networkmanager</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-server">xorg-server</a></span></li>
</ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://mesonbuild.com/">Meson official website</a></li>
<li><a rel="nofollow" class="external text" href="https://mesonbuild.com/Builtin-options.html">List of Meson built-in options</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/mesonbuild/meson">Meson source code repository in GitHub</a></li>
<li><a href="https://en.wikipedia.org/wiki/Meson_(software)" class="extiw" title="wikipedia:Meson (software)">Meson article on Wikipedia</a></li>
<li><span class="plainlinks archwiki-template-man" title="$ man 1 meson"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/meson.1">meson(1)</a></span></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Arch_package_guidelines.html" title="Category:Arch package guidelines">Arch package guidelines</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Meson_package_guidelines&amp;oldid=782730">https://wiki.archlinux.org/index.php?title=Meson_package_guidelines&amp;oldid=782730</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 7 July 2023, at 14:49.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
