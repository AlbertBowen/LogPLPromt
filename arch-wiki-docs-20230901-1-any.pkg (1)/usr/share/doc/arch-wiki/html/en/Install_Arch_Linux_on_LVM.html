<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Install Arch Linux on LVM - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Install_Arch_Linux_on_LVM rootpage-Install_Arch_Linux_on_LVM skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Installation">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Installation</div>
			</a>
			
				<button aria-controls="toc-Installation-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Installation subsection
				</button>
			
			<ul id="toc-Installation-sublist" class="sidebar-toc-list">
				<li id="toc-Create_partitions" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Create_partitions">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.1</span>Create partitions</div>
			</a>
			
			<ul id="toc-Create_partitions-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Create_physical_volumes" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Create_physical_volumes">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.2</span>Create physical volumes</div>
			</a>
			
			<ul id="toc-Create_physical_volumes-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Create_and_extend_your_volume_group" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Create_and_extend_your_volume_group">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.3</span>Create and extend your volume group</div>
			</a>
			
			<ul id="toc-Create_and_extend_your_volume_group-sublist" class="sidebar-toc-list">
				<li id="toc-Combined_creation_of_physical_volumes_and_volume_groups" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Combined_creation_of_physical_volumes_and_volume_groups">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.3.1</span>Combined creation of physical volumes and volume groups</div>
			</a>
			
			<ul id="toc-Combined_creation_of_physical_volumes_and_volume_groups-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Create_logical_volumes" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Create_logical_volumes">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.4</span>Create logical volumes</div>
			</a>
			
			<ul id="toc-Create_logical_volumes-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Format_and_mount_logical_volumes" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Format_and_mount_logical_volumes">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.5</span>Format and mount logical volumes</div>
			</a>
			
			<ul id="toc-Format_and_mount_logical_volumes-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Configure_the_system" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Configure_the_system">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Configure the system</div>
			</a>
			
				<button aria-controls="toc-Configure_the_system-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Configure the system subsection
				</button>
			
			<ul id="toc-Configure_the_system-sublist" class="sidebar-toc-list">
				<li id="toc-Adding_mkinitcpio_hooks" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Adding_mkinitcpio_hooks">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1</span>Adding mkinitcpio hooks</div>
			</a>
			
			<ul id="toc-Adding_mkinitcpio_hooks-sublist" class="sidebar-toc-list">
				<li id="toc-Configure_mkinitcpio_for_RAID" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Configure_mkinitcpio_for_RAID">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.1.1</span>Configure mkinitcpio for RAID</div>
			</a>
			
			<ul id="toc-Configure_mkinitcpio_for_RAID-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Kernel_boot_options" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Kernel_boot_options">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2.2</span>Kernel boot options</div>
			</a>
			
			<ul id="toc-Kernel_boot_options-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Install_Arch_Linux_on_LVM.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Install_Arch_Linux_on_LVM&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Install_Arch_Linux_on_LVM.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Install_Arch_Linux_on_LVM&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Install_Arch_Linux_on_LVM&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Install_Arch_Linux_on_LVM.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Install_Arch_Linux_on_LVM&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Install_Arch_Linux_on_LVM&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Related articles</p>
<ul>
<li><a href="../en/LVM.html" title="LVM">LVM</a></li>
<li><a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a></li>
</ul>
</div>
<p>You should create your LVM Volumes between the <a href="../en/Partitioning.html" title="Partitioning">partitioning</a> and <a href="../en/File_systems.html#Create_a_file_system" title="File systems">formatting</a> steps of the <a href="../en/Installation_guide.html" title="Installation guide">installation procedure</a>. Instead of directly formatting a partition to be your root file system, the file system will be created inside a logical volume (LV).
</p>
<p>Quick overview: 
</p>
<ul>
<li>Install the required packages. (refer to <a href="../en/LVM.html#Installation" title="LVM">LVM#Installation</a>)</li>
<li>Create <a href="../en/Partitioning.html" title="Partitioning">partition(s)</a> where your physical volumes (PVs) will reside.</li>
<li>Create your PVs. If you have one disk it is best to just create one PV in one large partition. If you have multiple disks you can create partitions on each of them and create a PV on each partition.</li>
<li>Create your volume group (VG) and add all PVs to it.</li>
<li>Create logical volumes (LVs) inside that VG.</li>
<li>Continue with <a href="../en/Installation_guide.html#Format_the_partitions" title="Installation guide">Installation guide#Format the partitions</a>.</li>
<li>When you reach the “Create initial ramdisk environment” step in the Installation guide, add the <code>lvm2</code> hook to <code>/etc/mkinitcpio.conf</code> (see below for details).</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> <code>/boot</code> cannot reside in LVM when using a boot loader which does not support LVM; you must create a separate <code>/boot</code> partition and format it directly. While this partition is already necessary for UEFI/GPT it is an additional partition for both BIOS/MBR and BIOS/GPT. Create the partition <code>/boot</code> for BIOS systems irrespective of the partition table and create a <code>Linux filesystem</code> on it (partition type <code>8300</code> in <i>gdisk</i>). Mount the created partition to <code>/boot</code>. Only <a href="../en/GRUB.html" title="GRUB">GRUB</a> is known to support LVM. Nevertheless, it requires this separate boot partition.</div>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>You will follow along with the installation guide until you come to <a href="../en/Installation_guide.html#Partition_the_disks" title="Installation guide">Installation guide#Partition the disks</a>. At this point you will diverge and doing all your partitioning with LVM in mind.
</p>
<h3><span class="mw-headline" id="Create_partitions">Create partitions</span></h3>
<p>First, <a href="../en/Partitioning.html" class="mw-redirect" title="Partition">partition</a> your disks as required before configuring LVM.
</p>
<p>Create the partitions:
</p>
<ul>
<li>If you use GUID Partition Table, set the <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs" class="extiw" title="wikipedia:GUID Partition Table">partition type GUID</a> to <code>E6D6D379-F507-44C2-A23C-238F2A3DF928</code> (partition type <code>Linux LVM</code> in <i>fdisk</i> and <code>8e00</code> in <i>gdisk</i>).</li>
<li>If you use Master Boot Record partition table, set the <a href="https://en.wikipedia.org/wiki/Partition_type" class="extiw" title="wikipedia:Partition type">partition type ID</a> to <code>8e</code> (partition type <code>Linux LVM</code> in <i>fdisk</i>).</li>
</ul>
<h3><span class="mw-headline" id="Create_physical_volumes">Create physical volumes</span></h3>
<p>To list all your devices capable of being used as a physical volume:
</p>
<pre># lvmdiskscan
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Make sure you target the correct device, or below commands will result in data loss!</div>
<p>Create a physical volume on them:
</p>
<pre># pvcreate <i>DEVICE</i>
</pre>
<p>This command creates a header on each device so it can be used for LVM. As defined in <a href="../en/LVM.html#LVM_building_blocks" title="LVM">LVM#LVM building blocks</a>, <i>DEVICE</i> can be any <a href="../en/Device_file.html#Block_devices" class="mw-redirect" title="Block device">block device</a>, e.g. a disk <code>/dev/sda</code>, a partition <code>/dev/sda2</code> or a loop back device. For example: 
</p>
<pre># pvcreate /dev/sda2
</pre>
<p>You can track created physical volumes with:
</p>
<pre># pvdisplay
</pre>
<p>You can also get summary information on physical volumes with:
</p>
<pre># pvscan
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you run into trouble with a pre-existing disk signature, you can delete it using <a href="../en/Device_file.html#wipefs" class="mw-redirect" title="Wipefs">wipefs</a>.</div>
<h3><span class="mw-headline" id="Create_and_extend_your_volume_group">Create and extend your volume group</span></h3>
<p>First you need to create a volume group on any one of the physical volumes:
</p>
<pre># vgcreate <i>volume_group</i> <i>physical_volume</i>
</pre>
<p>For example:
</p>
<pre># vgcreate VolGroup00 /dev/sda2
</pre>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 8 lvm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvm.8">lvm(8)</a></span> for a list of valid characters for volume group names.
</p>
<p>Extending the volume group is just as easy:
</p>
<pre># vgextend <i>volume_group</i> <i>physical_volume</i>
</pre>
<p>For example, to add both <code>sdb1</code> and <code>sdc</code> to your volume group:
</p>
<pre># vgextend VolGroup00 /dev/sdb1
# vgextend VolGroup00 /dev/sdc
</pre>
<p>You can track how your volume group grows with:
</p>
<pre># vgdisplay
</pre>
<p>This is also what you would do if you wanted to add a disk to a RAID or mirror group with failed disks.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You can create more than one volume group if you need to, but then you will not have all your storage presented as a single disk.</div>
<h4><span class="mw-headline" id="Combined_creation_of_physical_volumes_and_volume_groups">Combined creation of physical volumes and volume groups</span></h4>
<p>LVM allows you to combine the creation of a volume group and the physical volumes in one easy step. For example, to create the group VolGroup00 with the three devices mentioned above, you can run:
</p>
<pre># vgcreate VolGroup00 /dev/sda2 /dev/sdb1 /dev/sdc
</pre>
<p>This command will first set up the three partitions as physical volumes (if necessary) and then create the volume group with the three volumes. The command will warn you if it detects an existing filesystem on any devices.
</p>
<h3><span class="mw-headline" id="Create_logical_volumes">Create logical volumes</span></h3>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>If you wish to use snapshots, logical volume caching, thin provisioned logical volumes or RAID see <a href="../en/LVM.html#Logical_volumes" title="LVM">LVM#Logical volumes</a>.</li>
<li>If a logical volume will be formatted with <a href="../en/Ext4.html" title="Ext4">ext4</a>, leave at least 256 MiB free space in the volume group to allow using <span class="plainlinks archwiki-template-man" title="$ man 8 e2scrub"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/e2scrub.8">e2scrub(8)</a></span>. After creating the last volume with <code>-l 100%FREE</code>, this can be accomplished by reducing its size with <code>lvreduce -L -256M <i>volume_group</i>/<i>logical_volume</i></code>.</li>
</ul>
</div>
<p>Now we need to create logical volumes on this volume group. You create a logical volume with the next command by specifying the new volume's name and size, and the volume group it will reside on:
</p>
<pre># lvcreate -L <i>size</i> <i>volume_group</i> -n <i>logical_volume</i>
</pre>
<p>For example:
</p>
<pre># lvcreate -L 10G VolGroup00 -n lvolhome
</pre>
<p>This will create a logical volume that you can access later with <code>/dev/VolGroup00/lvolhome</code>. Just like volume groups, you can use any name you want for your logical volume when creating it besides a few exceptions listed in <span class="plainlinks archwiki-template-man" title="$ man 8 lvm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvm.8#VALID_NAMES">lvm(8) § VALID_NAMES</a></span>.
</p>
<p>You can also specify one or more physical volumes to restrict where LVM allocates the data. For example, you may wish to create a logical volume for the root filesystem on your small SSD, and your home volume on a slower mechanical drive. Simply add the physical volume devices to the command line, for example:
</p>
<pre># lvcreate -L 10G VolGroup00 -n lvolhome /dev/sdc1
</pre>
<p>To use all the free space left in a volume group, use the next command:
</p>
<pre># lvcreate -l 100%FREE  <i>volume_group</i> -n <i>logical_volume</i>
</pre>
<p>You can track created logical volumes with:
</p>
<pre># lvdisplay
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You may need to load the <i>device-mapper</i> kernel module (<code>modprobe dm_mod</code>) for the above commands to succeed.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> You can start out with relatively small logical volumes and expand them later if needed. For simplicity, leave some free space in the volume group so there is room for expansion.</div>
<h3><span class="mw-headline" id="Format_and_mount_logical_volumes">Format and mount logical volumes</span></h3>
<p>Your logical volumes should now be located in <code>/dev/<i>YourVolumeGroupName</i>/</code>. If you cannot find them, use the next commands to bring up the module for creating device nodes and to make volume groups available:
</p>
<pre># modprobe dm_mod
# vgscan
# vgchange -ay
</pre>
<p>Now you can format your logical volumes and mount them as normal partitions (see <a href="../en/File_systems.html#Mount_a_file_system" class="mw-redirect" title="Mount">mount a file system</a> for additional details):
</p>
<pre># mkfs.<i>fstype</i> /dev/<i>volume_group</i>/<i>logical_volume</i>
# mount /dev/<i>volume_group</i>/<i>logical_volume</i> /<i>mountpoint</i>
</pre>
<p>For example:
</p>
<pre># mkfs.ext4 /dev/VolGroup00/lvolhome
# mount /dev/VolGroup00/lvolhome /home
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> When choosing mountpoints, just select your newly created logical volumes (use: <code>/dev/Volgroup00/lvolhome</code>). Do <b>not</b> select the actual partitions on which logical volumes were created (do not use: <code>/dev/sda2</code>).</div>
<h2><span class="mw-headline" id="Configure_the_system">Configure the system</span></h2>
<p>Make sure the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> package is <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">installed</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> provides the <code>lvm2</code> hook. If you are running <i>mkinitcpio</i> in an <i>arch-chroot</i> for a new installation, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> must be installed inside the <i>arch-chroot</i> for <i>mkinitcpio</i> to find the <code>lvm2</code> hook. If <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> only exists outside the <i>arch-chroot</i>, <i>mkinitcpio</i> will output <code>Error: Hook 'lvm2' cannot be found</code>.</li>
<li>If your root filesystem is on LVM RAID see <a href="#Configure_mkinitcpio_for_RAID">#Configure mkinitcpio for RAID</a>.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Adding_mkinitcpio_hooks">Adding mkinitcpio hooks</span></h3>
<p>In case your root filesystem is on LVM, you will need to enable the appropriate <a href="../en/Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a> hooks, otherwise your system might not boot. Enable:
</p>
<ul>
<li>
<code>udev</code> and <code>lvm2</code> for the default busybox-based initramfs</li>
<li>
<code>systemd</code> and <code>lvm2</code> for systemd-based initramfs</li>
</ul>
<p><code>udev</code> is there by default. Edit the file and insert <code>lvm2</code> between <code>block</code> and <code>filesystems</code> like so:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">HOOKS=(base <b>udev</b> ... block <b>lvm2</b> filesystems)</pre>
<p>For systemd based initramfs:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">HOOKS=(base <b>systemd</b> ... block <b>lvm2</b> filesystems)</pre>
<p>Afterwards, you can continue in normal installation instructions with the <a href="../en/Mkinitcpio.html#Image_creation_and_activation" title="Mkinitcpio">create an initial ramdisk</a> step.
</p>
<h4><span class="mw-headline" id="Configure_mkinitcpio_for_RAID">Configure mkinitcpio for RAID</span></h4>
<p>If your root filesystem is on LVM RAID additionally to the <code>lvm2</code> hook, you need to add <code>dm-raid</code> and the appropriate RAID modules (e.g. <code>raid0</code>, <code>raid1</code>, <code>raid10</code> and/or <code>raid456</code>) to the MODULES array in <code>mkinitcpio.conf</code>. Also <code>dm_integrity</code> module is needed if you created RAID with integrity checksums (<code>--raidintegrity</code> option in <code>lvcreate</code>).
</p>
<p>For busybox based initramfs:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES=(<b>dm-raid dm_integrity raid0 raid1 raid10 raid456</b>)
HOOKS=(base <b>udev</b> ... block <b>lvm2</b> filesystems)</pre>
<p>For systemd based initramfs:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES=(<b>dm-raid dm_integrity raid0 raid1 raid10 raid456</b>)
HOOKS=(base <b>systemd</b> ... block <b>lvm2</b> filesystems)</pre>
<p>For systems using LVM thin volumes the location of systemd between udev and block causes the malfunction of the thin volume. just with the parameters (base udev autodetect modconf block lvm2 filesystems keyboard fsck) works: root FS inside a lvm logical volume, and other LVM's (normal and thin) at other locations.
</p>
<h3><span class="mw-headline" id="Kernel_boot_options">Kernel boot options</span></h3>
<p>If the root file system resides in a logical volume, the <code>root=</code> <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> must be pointed to the mapped device, e.g <code>/dev/<i>vg-name</i>/<i>lv-name</i></code>.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Installation_process.html" title="Category:Installation process">Installation process</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Install_Arch_Linux_on_LVM&amp;oldid=782729">https://wiki.archlinux.org/index.php?title=Install_Arch_Linux_on_LVM&amp;oldid=782729</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 7 July 2023, at 14:30.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
