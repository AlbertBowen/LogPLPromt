<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>iMac Unibody - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-IMac_Unibody rootpage-IMac_Unibody skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Workaround_for_the_KMS_bug" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Workaround_for_the_KMS_bug">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Workaround for the KMS bug</div>
			</a>
			
			<ul id="toc-Workaround_for_the_KMS_bug-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Workaround_for_suspend-and-resume" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Workaround_for_suspend-and-resume">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Workaround for suspend-and-resume</div>
			</a>
			
			<ul id="toc-Workaround_for_suspend-and-resume-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Workaround_for_the_fake_backlight_control" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Workaround_for_the_fake_backlight_control">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Workaround for the fake backlight control</div>
			</a>
			
			<ul id="toc-Workaround_for_the_fake_backlight_control-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Suggestions_about_the_bootloader" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Suggestions_about_the_bootloader">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Suggestions about the bootloader</div>
			</a>
			
			<ul id="toc-Suggestions_about_the_bootloader-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id='toc-iMac12,2_27"_2011' class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href='#iMac12,2_27"_2011'>
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>iMac12,2 27" 2011</div>
			</a>
			
				<button aria-controls='toc-iMac12,2_27"_2011-sublist' class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle iMac12,2 27" 2011 subsection
				</button>
			
			<ul id='toc-iMac12,2_27"_2011-sublist' class="sidebar-toc-list">
				<li id="toc-Sound" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Sound">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.1</span>Sound</div>
			</a>
			
			<ul id="toc-Sound-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Brightness" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Brightness">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5.2</span>Brightness</div>
			</a>
			
			<ul id="toc-Brightness-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/IMac_Unibody.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="mw-list-item"><a href="../en/Talk:IMac_Unibody.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/IMac_Unibody.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=IMac_Unibody&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=IMac_Unibody&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/IMac_Unibody.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=IMac_Unibody&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=IMac_Unibody&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<p><span>
</span>
</p>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Written in first person and other issues. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:IMac_Unibody">Talk:IMac Unibody</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> No updates since  2018-06-29 for hardware spanning from 2009 to 2011. Said hardware is considered <a rel="nofollow" class="external text" href="https://support.apple.com/en-us/HT201624#macobsolete">obsolete</a> by Apple since it was last sold more than 7 years ago. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:IMac_Unibody">Talk:IMac Unibody</a>)</div>
</div>
<p>Despite having Radeon rather than nVidia graphics, <a rel="nofollow" class="external text" href="https://support.apple.com/kb/sp588?locale=en_US">this</a> iMac model suffers from a number of graphics-related problems. The problems I have encountered are:
</p>
<ul>
<li>The screen becomes disabled/turned off when <a href="../en/Kernel_mode_setting.html" title="Kernel mode setting">kernel mode setting</a> kicks in.</li>
<li>After resuming from suspend-to-RAM, the screen cannot be re-enabled even with the fix described below.</li>
<li>The system produces an interface for controlling a nonexistent backlight in <code>/sys/class/backlight/acpi_video0</code>.</li>
</ul>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Workaround_for_the_KMS_bug">Workaround for the KMS bug</span></h2>
<p>During the initial installation process, it is simplest to add <code>modprobe.blacklist=radeon</code> to your <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel command line">kernel command line</a> when booting from the installation media. I did not attempt to boot in BIOS mode, though I doubt it would make much difference with regards to the black screen. You will need to keep this parameter in your kernel command line until after you have installed a graphical environment, so when you install your desktop environment, be sure to also install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-video-fbdev">xf86-video-fbdev</a></span>. This will allow you to use software rendering and the high-resolution EFI framebuffer until you get the radeon problem sorted out. When you have gotten your graphical environment the way you want, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xrandr">xorg-xrandr</a></span>, and create the following script:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/fix_display</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/bash
/usr/bin/xrandr -d :0 --output eDP-1 --crtc 1
</pre>
<p><b>Note: if eDP-1 does not work, try just "eDP." If you can log into the graphical session blindly, you can then use SSH to see the exact name by running <code>xrandr -d :0</code>.</b>
</p>
<p>Make it <a href="../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a>.
</p>
<p>Edit your <a href="../en/Display_manager.html" title="Display manager">display manager</a>'s configuration so that the script runs while the greeter is starting up. I use <a href="../en/SDDM.html" title="SDDM">SDDM</a>, so I configured it like this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sddm.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[X11]
DisplayCommand=/usr/local/bin/fix_display</pre>
<p>Note that you may need to first create this file by running <code>sddm --example-config &gt; /etc/sddm.conf</code>.
</p>
<p>Now, you should be able to remove the <code>modprobe.blacklist</code> parameter from your kernel command line and reboot with 3D acceleration supported.
</p>
<h2><span class="mw-headline" id="Workaround_for_suspend-and-resume">Workaround for suspend-and-resume</span></h2>
<p>Currently, there is no solution to the suspend-and-resume issues although using Legacy boot instead of EFI is worth a try if possible.
</p>
<h2><span class="mw-headline" id="Workaround_for_the_fake_backlight_control">Workaround for the fake backlight control</span></h2>
<p>Add <code>acpi_backlight=none</code> to your <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel command line">kernel command line</a> and reboot. Your desktop environment should now be able to adjust the screen brightness properly. (Note that you will have to install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=powerdevil">powerdevil</a></span> package if you wish to adjust the brightness in <a href="../en/KDE.html#Plasma" class="mw-redirect" title="Plasma">Plasma</a>.)
</p>
<h2><span class="mw-headline" id="Suggestions_about_the_bootloader">Suggestions about the bootloader</span></h2>
<p>Because Mac computers do not have a normal <a href="../en/Unified_Extensible_Firmware_Interface.html" class="mw-redirect" title="UEFI">UEFI</a>, I advise making your bootloader follow Apple's conventions as much as possible. This will allow you to make the Arch entry in the Option-key boot menu nice and pretty, as well as allowing you to set Arch as the default OS instead of macOS. Here are the rough steps to do this. Consider these instructions a supplement to—not a replacement for—the <a href="../en/Installation_guide.html" title="Installation guide">installation guide</a>. They only detail the steps that deviate from the normal install process.
</p>
<ol>
<li>Before installing Arch, create a 1 GiB partition in Disk Utility formatted as MacOS Extended (Journaled). Name it "ArchLinux-Boot".</li>
<li>Run <code>diskutil disableJournal /dev/disk<i>X</i>s<i>Y</i></code> from the macOS terminal. (Replace <i>X</i> and <i>Y</i> with the disk and partition numbers from <code>diskutil list</code>.)</li>
<li>Create a full-sized partition for the root filesystem and optionally a swap partition in Disk Utility as well. The filesystem does not matter for these, as they will be overwritten anyway.</li>
<li>Boot into the install media (do not forget the workaround for graphics above)</li>
<li>Use <code>gdisk</code> to change the partition type codes on the root and swap partitions to the proper codes for Linux Filesystem (8300) and Linux Swap (8200).</li>
<li>
<a href="../en/File_systems.html#Create_a_file_system" class="mw-redirect" title="Format">Format</a> the partitions with your choice of filesystem.</li>
<li>Mount your newly-formatted root filesystem on <code>/mnt</code>. Create the directories <code>/mnt/esp</code>, <code>/mnt/applebootpartition</code>, and <code>/mnt/boot</code>.</li>
<li>Mount the EFI system partition under <code>/mnt/esp</code>
</li>
<li>Mount the HFS+ filesystem you created in Disk Utility under <code>/mnt/applebootpartition</code>.</li>
<li>Run <code>mkdir -p /mnt/applebootpartition/System/Library/CoreServices /mnt/applebootpartition/loader/entries /mnt/applebootpartition/kernel</code>. The first set of directories emulates a macOS installation so that it will be picked up by the firmware. The second two are for Linux-specific things, as you will see later.</li>
<li>Bind-mount <code>/mnt/applebootpartition/kernel</code> to <code>/mnt/boot</code>
</li>
<li>Generate the fstab file. You will probably need to correct the bind-mount fstab entries to use directories that make sense for the installed system rather than the live environment.</li>
<li>Run <code>pacstrap</code> as specified in the main installation guide and chroot into the new system.</li>
<li>Copy <code>/usr/lib/systemd/boot/efi/systemd-bootx64.efi</code> to <code>/applebootpartition/System/Library/CoreServices/boot.efi</code> and from there configure <a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a> as though <code>/applebootpartition</code> were the EFI system partition. <code>/applebootpartition/kernel</code> should contain your vmlinuz and <a href="../en/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs">initramfs</a> images.</li>
<li>Create the file <code>/applebootpartition/mach_kernel</code> (it should be an empty file). I'm not sure whether this is actually necessary for the firmware to detect the partition as bootable.</li>
<li>Perform any other needed installation steps, then reboot into the installed system by holding down the option key when the iMac boots.</li>
</ol>
<h2>
<span id="iMac12.2C2_27.22_2011"></span><span class="mw-headline" id='iMac12,2_27"_2011'>iMac12,2 27" 2011</span>
</h2>
<h3><span class="mw-headline" id="Sound">Sound</span></h3>
<p>The following setting should be used to handle headphone detection correctly:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/sound.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options snd-hda-intel model=imac27</pre>
<h3><span class="mw-headline" id="Brightness">Brightness</span></h3>
<p>To adjust the backlight, adjust the values in "radeon_bl1" rather than "acpi_video0." 
</p>
<p>You can check the maximum value allowed with:
</p>
<pre>$ cat /sys/class/backlight/radeon_bl1/max_brightness
</pre>
<p>And you can set the current brightness with:
</p>
<pre># echo <i>value</i> &gt; /sys/class/backlight/radeon_bl1/brightness
</pre>
<p>Alternatively, add <code>acpi_backlight=native</code> to the <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel command line">kernel command line</a>.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Apple.html" title="Category:Apple">Apple</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=IMac_Unibody&amp;oldid=762558">https://wiki.archlinux.org/index.php?title=IMac_Unibody&amp;oldid=762558</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 30 December 2022, at 10:18.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
