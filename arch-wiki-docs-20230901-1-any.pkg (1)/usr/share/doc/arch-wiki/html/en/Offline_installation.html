<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Offline installation - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Offline_installation rootpage-Offline_installation skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Prepare_local_repository" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Prepare_local_repository">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Prepare local repository</div>
			</a>
			
			<ul id="toc-Prepare_local_repository-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Mount_and_configure" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Mount_and_configure">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Mount and configure</div>
			</a>
			
			<ul id="toc-Mount_and_configure-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Pacstrap" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Pacstrap">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Pacstrap</div>
			</a>
			
			<ul id="toc-Pacstrap-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Offline_installation_of_packages" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Offline_installation_of_packages">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Offline installation of packages</div>
			</a>
			
				<button aria-controls="toc-Offline_installation_of_packages-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Offline installation of packages subsection
				</button>
			
			<ul id="toc-Offline_installation_of_packages-sublist" class="sidebar-toc-list">
				<li id="toc-Install_from_file" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Install_from_file">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.1</span>Install from file</div>
			</a>
			
			<ul id="toc-Install_from_file-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Offline_cache" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Offline_cache">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.2</span>Offline cache</div>
			</a>
			
			<ul id="toc-Offline_cache-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Local_repository" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Local_repository">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3</span>Local repository</div>
			</a>
			
			<ul id="toc-Local_repository-sublist" class="sidebar-toc-list">
				<li id="toc-Complete_repository" class="sidebar-toc-list-item sidebar-toc-level-3">
			<a class="sidebar-toc-link" href="#Complete_repository">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3.1</span>Complete repository</div>
			</a>
			
			<ul id="toc-Complete_repository-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-See_also" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#See_also">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Offline_installation.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="mw-list-item"><a href="../en/Talk:Offline_installation.html" rel="discussion" title="Discussion about the content page [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Offline_installation.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Offline_installation&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Offline_installation&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Offline_installation.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Offline_installation&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Offline_installation&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<p>This article provides instructions on installing Arch Linux on a system without an Internet connection. To do this, another system with a working Internet connection is required.
</p>
<p>First, follow the <a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a>, skipping the <a href="../en/Installation_guide.html#Connect_to_the_internet" title="Installation guide">Installation guide#Connect to the internet</a> section, until the <a href="../en/Installation_guide.html#Install_essential_packages" title="Installation guide">Installation guide#Install essential packages</a> step.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Extracting the root file system image (<code>airootfs.sfs</code>) from the ISO or copying the live environment's root file system is not a supported installation method.</div>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Prepare_local_repository">Prepare local repository</span></h2>
<p>Follow <a href="../en/Pacman/Tips_and_tricks.html#Installing_packages_from_a_CD/DVD_or_USB_stick" title="Pacman/Tips and tricks">Pacman/Tips and tricks#Installing packages from a CD/DVD or USB stick</a> for instructions on preparing a local repository with the necessary files on a separate host installation.
</p>
<p>At the very least, for a functioning system, the following packages are recommended:
</p>
<pre># pacman -Syw --cachedir . --dbpath /tmp/blankdb base base-devel linux linux-firmware mkinitcpio vim
</pre>
<p>Create your custom offline repository
</p>
<pre># repo-add ./custom.db.tar.gz ./*[^sig]
</pre>
<h2><span class="mw-headline" id="Mount_and_configure">Mount and configure</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Add optional instructions on placing the custom repo in the ISO. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:Offline_installation">Talk:Offline installation</a>)</div>
</div>
<p>Once the repository is prepared, connect the external media to the new installation, and mount it on the newly created root filesystem:
</p>
<pre># mount --mkdir /dev/sd<i>xy</i> /mnt/repo
</pre>
<p>Edit your archiso <code>/etc/pacman.conf</code> and add a new section:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[custom]
SigLevel = Optional
Server = file:///mnt/repo/</pre>
<p>Comment out <code>[core]</code> and <code>[extra]</code> so that pacman does not fail on the default repositories.
</p>
<h2><span class="mw-headline" id="Pacstrap">Pacstrap</span></h2>
<p>You can now continue to pacstrap your locally-available packages to the new installation:
</p>
<pre># pacstrap -K /mnt base base-devel linux linux-firmware mkinitcpio vim
</pre>
<h2><span class="mw-headline" id="Offline_installation_of_packages">Offline installation of packages</span></h2>
<h3><span class="mw-headline" id="Install_from_file">Install from file</span></h3>
<p>In case the offline installation process was only temporary, but requires manual installation of some packages before being able to access a network, see <a href="../en/Pacman.html#Additional_commands" title="Pacman">pacman#Additional commands</a> to learn how to install local packages. 
</p>
<p><a href="../en/Command-line_shell.html" class="mw-redirect" title="Shell">Shell</a> <a href="https://en.wikipedia.org/wiki/Glob_(programming)" class="extiw" title="wikipedia:Glob (programming)">globbing</a> can be used to install many packages at once: 
</p>
<pre># pacman -U /package/folder/*.tar.zst
</pre>
<h3><span class="mw-headline" id="Offline_cache">Offline cache</span></h3>
<p>You can put the required files into <code>/var/lib/pacman/sync</code> and <code>/var/cache/pacman/pkg</code>, so as to make <code>pacman</code> think it has everything it needs to do searches, updates, and installs. The following method is based on two forum threads: <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?pid=463238#p463238">[1]</a><a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=30431">[2]</a>.
</p>
<p>The steps are:
</p>
<ol>
<li>downloading the up to date package databases on a computer with internet access,</li>
<li>transferring them to the offline computer,</li>
<li>generating the list of packages required from the offline computer to update it,</li>
<li>downloading them with their signature on a computer with internet access,</li>
<li>transferring them to the pacman cache of the offline computer,</li>
<li>installing the updates.</li>
</ol>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you changed your default repositories from the defaults (core, extra and multilib), you should review your <code>/etc/pacman.conf</code> file.</div>
<p>The following script will download the updated package databases. If needed, change <code>MIRROR</code> to any mirror from the <a rel="nofollow" class="external text" href="https://archlinux.org/mirrors/status/">mirror status list</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">download_databases.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

ARCH="x86_64"
MIRROR="<a rel="nofollow" class="external free" href="https://mirrors.kernel.org/archlinux/">https://mirrors.kernel.org/archlinux/</a>"

wget "${MIRROR}/core/os/${ARCH}/core.db"
wget "${MIRROR}/extra/os/${ARCH}/extra.db"
wget "${MIRROR}/multilib/os/${ARCH}/multilib.db"

# and possibly -uncomment- (if customized in /etc/pacman.conf or pacman.conf.d):

#wget "${MIRROR}/core-testing/os/${ARCH}/core-testing.db"
#wget "${MIRROR}/extra-testing/os/${ARCH}/extra-testing.db"
#wget "${MIRROR}/multilib-testing/os/${ARCH}/multilib-testing.db"

# and -additionaly- debug and staging packages.</pre>
<p>Make the script <a href="../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a> and run it. You will obtain multiple <i>.db</i> files. 
</p>
<p>The following steps will be transferring the <i>.db</i> files to the offline PC, making it so you are working with up-to-date package lists (as if you ran <code>pacman -Sy</code>), then generating a list of package required for the update: 
</p>
<pre># cp *.db /var/lib/pacman/sync/
# pacman -Sup --noconfirm &gt; pkglist
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Make sure that you have enabled at least one of the servers defined in the <code>/etc/pacman.d/mirrorlist</code> file. Otherwise, all what you get is a misleading error message: <code>error: no database for package: package-name</code>.</div>
<p>You will also need to download the corresponding package signatures, so prepare the list of signatures to download:
</p>
<pre># sed -e 's/\.zst$/.zst.sig/' ../pkglist &gt; ../siglist
</pre>
<p>Next, bring the two lists with you to a place where you have internet and download the listed packages in an empty directory:
</p>
<pre># wget -nv -i ../pkglist
# wget -nv -i ../siglist
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> When using <a rel="nofollow" class="external text" href="https://www.cygwin.com">cygwin</a> or some other kind of Windows environment to download the packages, the filenames will get mangled since default Windows file naming requires to escape e.g. colons. To avoid this (under cygwin, since it does not follow such restrictions), use <code>wget --restrict-file-names=unix</code>.</div>
<p>Take all the <code>*.pkg.tar.zst</code> and <code>*.pkg.tar.zst.sig</code> files back home, put them in <code>/var/cache/pacman/pkg</code> and finally run
</p>
<pre># pacman -Su
</pre>
<h3><span class="mw-headline" id="Local_repository">Local repository</span></h3>
<p>In case the new system is expected to remain offline or airgapped, it should be configured to expect only local repositories. 
</p>
<h4><span class="mw-headline" id="Complete_repository">Complete repository</span></h4>
<p>After chrooting into your new installation, edit the new <code>/etc/pacman.conf</code> in the same way as previously (but without the <code>/mnt</code> prefix):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[custom]
SigLevel = Optional
Server = file:///repo/</pre>
<p>Comment out all other repositories and save. Continue configuring the new system as usual.
</p>
<p>From now on any updates to the offline system can be made by bringing an up to date copy of the local repository, mounting it to <code>/repo</code> and running pacman commands as usual.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li>
<a href="../en/Help:Browsing.html#Offline_viewing" class="mw-redirect" title="Offline reading">Offline reading</a>: for browsing ArchWiki offline.</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Live_Arch_systems.html" title="Category:Live Arch systems">Live Arch systems</a></li>
<li><a href="../en/Category:Installation_process.html" title="Category:Installation process">Installation process</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Offline_installation&amp;oldid=781395">https://wiki.archlinux.org/index.php?title=Offline_installation&amp;oldid=781395</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 18 June 2023, at 07:56.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
