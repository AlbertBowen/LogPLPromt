<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Home Assistant - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Home_Assistant rootpage-Home_Assistant skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Install" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Install">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>Install</div>
			</a>
			
				<button aria-controls="toc-Install-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Install subsection
				</button>
			
			<ul id="toc-Install-sublist" class="sidebar-toc-list">
				<li id="toc-Home_Assistant_Supervised" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Home_Assistant_Supervised">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1.1</span>Home Assistant Supervised</div>
			</a>
			
			<ul id="toc-Home_Assistant_Supervised-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Configuration" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Configuration">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Configuration</div>
			</a>
			
			<ul id="toc-Configuration-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Usage" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Usage">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Usage</div>
			</a>
			
				<button aria-controls="toc-Usage-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Usage subsection
				</button>
			
			<ul id="toc-Usage-sublist" class="sidebar-toc-list">
				<li id="toc-Using_MariaDB" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Using_MariaDB">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3.1</span>Using MariaDB</div>
			</a>
			
			<ul id="toc-Using_MariaDB-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Troubleshooting" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Troubleshooting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Troubleshooting</div>
			</a>
			
				<button aria-controls="toc-Troubleshooting-sublist" class="mw-ui-icon mw-ui-icon-wikimedia-expand mw-ui-icon-small sidebar-toc-toggle">
					Toggle Troubleshooting subsection
				</button>
			
			<ul id="toc-Troubleshooting-sublist" class="sidebar-toc-list">
				<li id="toc-No_access_to_USB_devices" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#No_access_to_USB_devices">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.1</span>No access to USB devices</div>
			</a>
			
			<ul id="toc-No_access_to_USB_devices-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Bluetooth_integration_not_working" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#Bluetooth_integration_not_working">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.2</span>Bluetooth integration not working</div>
			</a>
			
			<ul id="toc-Bluetooth_integration_not_working-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-ModuleNotFoundErrors_in_logs" class="sidebar-toc-list-item sidebar-toc-level-2">
			<a class="sidebar-toc-link" href="#ModuleNotFoundErrors_in_logs">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4.3</span>ModuleNotFoundErrors in logs</div>
			</a>
			
			<ul id="toc-ModuleNotFoundErrors_in_logs-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-See_also" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#See_also">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Home_Assistant.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Home_Assistant&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Home_Assistant.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Home_Assistant&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Home_Assistant&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Home_Assistant.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Home_Assistant&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Home_Assistant&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p class="mw-no-invert">Related articles</p>
<ul>
<li><a href="../en/Home_Assistant_Supervised.html" title="Home Assistant Supervised">Home Assistant Supervised</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://www.home-assistant.io/">Home Assistant</a> is an open source home automation software that puts local control and privacy first. Powered by a worldwide community of tinkerers and DIY enthusiasts.
</p>
<mw:tocplace></mw:tocplace>
<h2><span class="mw-headline" id="Install">Install</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=home-assistant">home-assistant</a></span> package.
</p>
<h3><span class="mw-headline" id="Home_Assistant_Supervised">Home Assistant Supervised</span></h3>
<p>Refer to <a href="../en/Home_Assistant_Supervised.html" title="Home Assistant Supervised">Home Assistant Supervised</a>.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Configuration files are stored at <code>/var/lib/hass/</code>. If no configuration exists, a default configuration will be written at startup.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>To start Home Assistant, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a> <code>home-assistant.service</code>.
</p>
<p>The first start may take up to 20 minutes because the required packages will be downloaded and installed.<a rel="nofollow" class="external autonumber" href="https://www.home-assistant.io/docs/installation/">[1]</a> You can see the progress in the logs.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Follow the first-time update process using <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journalctl">journalctl</a>:</div>
<pre># journalctl -fu home-assistant
</pre>
<p>By default, the web interface is available at <a rel="nofollow" class="external free" href="http://localhost:8123">http://localhost:8123</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The web interface requires the <a rel="nofollow" class="external text" href="https://pypi.org/project/home-assistant-frontend/">home-assistant-frontend</a> Python package.</div>
<h3><span class="mw-headline" id="Using_MariaDB">Using MariaDB</span></h3>
<p>By default, SQLite is used for the recorder/history integration within Home Assistant. A noticeable performance boost is achievable by using MariaDB (especially for larger setups). Home assistant uses SQLAlchemy which means that any backend is supported, like MySQL, MariaDB, PostgreSQL, or MS SQL Server. Here we only discuss MariaDb, for others please refer to the <a rel="nofollow" class="external text" href="https://www.home-assistant.io/integrations/recorder/">recorder integration documentation</a>.
</p>
<p>If not already installed, please refer to <a href="../en/MariaDB.html" title="MariaDB">MariaDB</a> for installation details.
</p>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=python-mysqlclient">python-mysqlclient</a></span> package dependency.
</p>
<p>Create a new database, the example below shows a single username per service, with wildcard access to all databases having the username as a prefix e.g.:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ mysql -u root -p</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">CREATE USER '<b>username'</b>@'localhost' IDENTIFIED BY '<b>some_pass'</b> ;
CREATE DATABASE <b>username</b>;
GRANT ALL PRIVILEGES ON <b>username</b>.* TO '<b>username'</b>@'localhost';
FLUSH PRIVILEGES;
quit;</pre>
<p>Add to your configuration file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/hass/configuration.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">recorder:
  db_url: !secret recorder_mariadb_url
</pre>
<p>Add to your secrets file (if not using a Unix socket, see the <a rel="nofollow" class="external text" href="https://www.home-assistant.io/integrations/recorder/">recorder integration documentation</a> for alternative URLs):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/hass/secrets.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">recorder_mariadb_url: "mysql://USER:PASSWORD@localhost/DATABASE?unix_socket=/var/run/mysqld/mysqld.sock&amp;charset=utf8mb4"</pre>
<p>Finally, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> the <code>home-assistant.service</code>. The database should now start to populate. For more information refer to the <a rel="nofollow" class="external text" href="https://www.home-assistant.io/integrations/recorder/">recorder integration documentation</a>.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="No_access_to_USB_devices">No access to USB devices</span></h3>
<p>In the default installation, the Home Assistant may not have the necessary access to work with some devices, such as a Zigbee USB dongle. This is because such devices are controlled by the <code>uucp</code> system group. 
</p>
<p><a href="../en/Systemd.html#Editing_provided_units" class="mw-redirect" title="Edit">Edit</a> the <code>home-assistant.service</code> and add <code>SupplementaryGroups=uucp</code> to the <code>[Service]</code> section so that the default <code>hass</code> user belongs to the right group. 
</p>
<p>Then, after a <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Daemon-reload">daemon-reload</a> and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> of <code>home-assistant.service</code> it should be up and running.<a rel="nofollow" class="external autonumber" href="https://community.home-assistant.io/t/solved-zha-connection-failed-with-sonoff-zigbee-3-0-dongle/349855/12">[2]</a>
</p>
<h3><span class="mw-headline" id="Bluetooth_integration_not_working">Bluetooth integration not working</span></h3>
<p>If you are experiencing issues with Bluetooth integration and the below error message appears in your log it is because that the Bluetooth integration connects over dbus and there is an <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/9503">old systemd bug</a>.
</p>
<pre>Config entry 'Bluetooth' for bluetooth integration not ready yet: DBus connection broken: [Errno 32] Broken pipe; try restarting `bluetooth` and `dbus`; Retrying in background
</pre>
<p>A <a rel="nofollow" class="external text" href="https://github.com/home-assistant/core/issues/77483#issuecomment-1233350249">solution</a> is to switch to <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dbus-broker">dbus-broker</a></span>.
</p>
<p>Alternatively, add a system user and group <code>hass</code>: 
</p>
<pre># useradd -U -r -s /usr/bin/nologin hass
</pre>
<p>Use a <a href="../en/Systemd.html#Drop-in_files" class="mw-redirect" title="Drop-in file">drop-in file</a> for <code>home-assistant.service</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/home-assistant.service.d/override.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
DynamicUser=false</pre>
<h3><span class="mw-headline" id="ModuleNotFoundErrors_in_logs">ModuleNotFoundErrors in logs</span></h3>
<p>If Home Assistant is broken after a system package upgrade, it could be caused by a bad interaction between the system packages and Home Assistant's managed Python libraries. To reset Home Assistant's Python libraries and reinstall them from scratch, delete the modules directory: 
</p>
<pre># rm -r /var/lib/hass/deps/lib
</pre>
<p>Then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> <code>home-assistant.service</code>.
</p>
<p>If the first restart produces more ModuleNotFoundErrors, it might be necessary to a second restart. Home Assistant will detect that its modules are missing and automatically reinstall them.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.home-assistant.io/">Home Assistant homepage</a></li>
<li><a rel="nofollow" class="external text" href="https://www.home-assistant.io/docs/">Home Assistant documentation</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Servers.html" title="Category:Servers">Servers</a></li>
<li><a href="../en/Category:Web_applications.html" title="Category:Web applications">Web applications</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Home_Assistant&amp;oldid=766488">https://wiki.archlinux.org/index.php?title=Home_Assistant&amp;oldid=766488</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 4 February 2023, at 19:10.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	
</footer>

		</div>
	</div> 
</div> 

</body>
</html>
